(function(xe,Ye){typeof exports=="object"&&typeof module<"u"?Ye(exports):typeof define=="function"&&define.amd?define(["exports"],Ye):(xe=typeof globalThis<"u"?globalThis:xe||self,Ye(xe["ts-fem"]={}))})(this,function(xe){"use strict";var th=Object.defineProperty;var nh=(xe,Ye,Dr)=>Ye in xe?th(xe,Ye,{enumerable:!0,configurable:!0,writable:!0,value:Dr}):xe[Ye]=Dr;var ce=(xe,Ye,Dr)=>(nh(xe,typeof Ye!="symbol"?Ye+"":Ye,Dr),Dr);function Ye(){return Ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ye.apply(this,arguments)}var Dr={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function Le(e){return typeof e=="number"}function Re(e){return!e||typeof e!="object"||typeof e.constructor!="function"?!1:e.isBigNumber===!0&&typeof e.constructor.prototype=="object"&&e.constructor.prototype.isBigNumber===!0||typeof e.constructor.isDecimal=="function"&&e.constructor.isDecimal(e)===!0}function Tt(e){return e&&typeof e=="object"&&Object.getPrototypeOf(e).isComplex===!0||!1}function Ot(e){return e&&typeof e=="object"&&Object.getPrototypeOf(e).isFraction===!0||!1}function on(e){return e&&e.constructor.prototype.isUnit===!0||!1}function nr(e){return typeof e=="string"}var Me=Array.isArray;function Be(e){return e&&e.constructor.prototype.isMatrix===!0||!1}function at(e){return Array.isArray(e)||Be(e)}function sn(e){return e&&e.isDenseMatrix&&e.constructor.prototype.isMatrix===!0||!1}function fn(e){return e&&e.isSparseMatrix&&e.constructor.prototype.isMatrix===!0||!1}function cn(e){return e&&e.constructor.prototype.isRange===!0||!1}function ut(e){return e&&e.constructor.prototype.isIndex===!0||!1}function $a(e){return typeof e=="boolean"}function qa(e){return e&&e.constructor.prototype.isResultSet===!0||!1}function Pa(e){return e&&e.constructor.prototype.isHelp===!0||!1}function Ra(e){return typeof e=="function"}function Ua(e){return e instanceof Date}function Va(e){return e instanceof RegExp}function ln(e){return!!(e&&typeof e=="object"&&e.constructor===Object&&!Tt(e)&&!Ot(e))}function Za(e){return e===null}function Ga(e){return e===void 0}function Ya(e){return e&&e.isAccessorNode===!0&&e.constructor.prototype.isNode===!0||!1}function Ja(e){return e&&e.isArrayNode===!0&&e.constructor.prototype.isNode===!0||!1}function Qa(e){return e&&e.isAssignmentNode===!0&&e.constructor.prototype.isNode===!0||!1}function Xa(e){return e&&e.isBlockNode===!0&&e.constructor.prototype.isNode===!0||!1}function Ha(e){return e&&e.isConditionalNode===!0&&e.constructor.prototype.isNode===!0||!1}function Ka(e){return e&&e.isConstantNode===!0&&e.constructor.prototype.isNode===!0||!1}function Wa(e){return e&&e.isFunctionAssignmentNode===!0&&e.constructor.prototype.isNode===!0||!1}function ka(e){return e&&e.isFunctionNode===!0&&e.constructor.prototype.isNode===!0||!1}function ja(e){return e&&e.isIndexNode===!0&&e.constructor.prototype.isNode===!0||!1}function eu(e){return e&&e.isNode===!0&&e.constructor.prototype.isNode===!0||!1}function ru(e){return e&&e.isObjectNode===!0&&e.constructor.prototype.isNode===!0||!1}function tu(e){return e&&e.isOperatorNode===!0&&e.constructor.prototype.isNode===!0||!1}function nu(e){return e&&e.isParenthesisNode===!0&&e.constructor.prototype.isNode===!0||!1}function iu(e){return e&&e.isRangeNode===!0&&e.constructor.prototype.isNode===!0||!1}function au(e){return e&&e.isRelationalNode===!0&&e.constructor.prototype.isNode===!0||!1}function uu(e){return e&&e.isSymbolNode===!0&&e.constructor.prototype.isNode===!0||!1}function ou(e){return e&&e.constructor.prototype.isChain===!0||!1}function hr(e){var t=typeof e;return t==="object"?e===null?"null":Re(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}function Ce(e){var t=typeof e;if(t==="number"||t==="string"||t==="boolean"||e===null||e===void 0)return e;if(typeof e.clone=="function")return e.clone();if(Array.isArray(e))return e.map(function(n){return Ce(n)});if(e instanceof Date)return new Date(e.valueOf());if(Re(e))return e;if(ln(e))return su(e,Ce);throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function su(e,t){var n={};for(var i in e)Yr(e,i)&&(n[i]=t(e[i]));return n}function fu(e,t){for(var n in t)Yr(t,n)&&(e[n]=t[n]);return e}function zr(e,t){var n,i,r;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(i=0,r=e.length;i<r;i++)if(!zr(e[i],t[i]))return!1;return!0}else{if(typeof e=="function")return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(n in e)if(!(n in t)||!zr(e[n],t[n]))return!1;for(n in t)if(!(n in e))return!1;return!0}else return e===t}}function Yr(e,t){return e&&Object.hasOwnProperty.call(e,t)}function cu(e,t){for(var n={},i=0;i<t.length;i++){var r=t[i],a=e[r];a!==void 0&&(n[r]=a)}return n}var lu=["Matrix","Array"],hu=["number","BigNumber","Fraction"],ke=function(t){if(t)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(Dr)};Ye(ke,Dr,{MATRIX_OPTIONS:lu,NUMBER_OPTIONS:hu});function hn(){return!0}function ir(){return!1}function Tr(){}const vn="Argument is not a typed-function.";function dn(){function e(x){return typeof x=="object"&&x!==null&&x.constructor===Object}const t=[{name:"number",test:function(x){return typeof x=="number"}},{name:"string",test:function(x){return typeof x=="string"}},{name:"boolean",test:function(x){return typeof x=="boolean"}},{name:"Function",test:function(x){return typeof x=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(x){return x instanceof Date}},{name:"RegExp",test:function(x){return x instanceof RegExp}},{name:"Object",test:e},{name:"null",test:function(x){return x===null}},{name:"undefined",test:function(x){return x===void 0}}],n={name:"any",test:hn,isAny:!0};let i,r,a=0,o={createCount:0};function h(x){const _=i.get(x);if(_)return _;let L='Unknown type "'+x+'"';const R=x.toLowerCase();let H;for(H of r)if(H.toLowerCase()===R){L+='. Did you mean "'+H+'" ?';break}throw new TypeError(L)}function c(x){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any";const L=_?h(_).index:r.length,R=[];for(let Y=0;Y<x.length;++Y){if(!x[Y]||typeof x[Y].name!="string"||typeof x[Y].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");const ae=x[Y].name;if(i.has(ae))throw new TypeError('Duplicate type name "'+ae+'"');R.push(ae),i.set(ae,{name:ae,test:x[Y].test,isAny:x[Y].isAny,index:L+Y,conversionsTo:[]})}const H=r.slice(L);r=r.slice(0,L).concat(R).concat(H);for(let Y=L+R.length;Y<r.length;++Y)i.get(r[Y]).index=Y}function l(){i=new Map,r=[],a=0,c([n],!1)}l(),c(t);function s(){let x;for(x of r)i.get(x).conversionsTo=[];a=0}function u(x){const _=r.filter(L=>{const R=i.get(L);return!R.isAny&&R.test(x)});return _.length?_:["any"]}function f(x){return x&&typeof x=="function"&&"_typedFunctionData"in x}function d(x,_,L){if(!f(x))throw new TypeError(vn);const R=L&&L.exact,H=Array.isArray(_)?_.join(","):_,Y=A(H),ae=m(Y);if(!R||ae in x.signatures){const ze=x._typedFunctionData.signatureMap.get(ae);if(ze)return ze}const te=Y.length;let ie;if(R){ie=[];let ze;for(ze in x.signatures)ie.push(x._typedFunctionData.signatureMap.get(ze))}else ie=x._typedFunctionData.signatures;for(let ze=0;ze<te;++ze){const Ie=Y[ze],Ue=[];let rr;for(rr of ie){const We=b(rr.params,ze);if(!(!We||Ie.restParam&&!We.restParam)){if(!We.hasAny){const cr=g(We);if(Ie.types.some(lr=>!cr.has(lr.name)))continue}Ue.push(rr)}}if(ie=Ue,ie.length===0)break}let re;for(re of ie)if(re.params.length<=te)return re;throw new TypeError("Signature not found (signature: "+(x.name||"unnamed")+"("+m(Y,", ")+"))")}function D(x,_,L){return d(x,_,L).implementation}function v(x,_){const L=h(_);if(L.test(x))return x;const R=L.conversionsTo;if(R.length===0)throw new Error("There are no conversions to "+_+" defined.");for(let H=0;H<R.length;H++)if(h(R[H].from).test(x))return R[H].convert(x);throw new Error("Cannot convert "+x+" to "+_)}function m(x){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return x.map(L=>L.name).join(_)}function p(x){const _=x.indexOf("...")===0,R=(_?x.length>3?x.slice(3):"any":x).split("|").map(te=>h(te.trim()));let H=!1,Y=_?"...":"";return{types:R.map(function(te){return H=te.isAny||H,Y+=te.name+"|",{name:te.name,typeIndex:te.index,test:te.test,isAny:te.isAny,conversion:null,conversionIndex:-1}}),name:Y.slice(0,-1),hasAny:H,hasConversion:!1,restParam:_}}function w(x){const _=x.types.map(ae=>ae.name),L=G(_);let R=x.hasAny,H=x.name;const Y=L.map(function(ae){const te=h(ae.from);return R=te.isAny||R,H+="|"+ae.from,{name:ae.from,typeIndex:te.index,test:te.test,isAny:te.isAny,conversion:ae,conversionIndex:ae.index}});return{types:x.types.concat(Y),name:H,hasAny:R,hasConversion:Y.length>0,restParam:x.restParam}}function g(x){return x.typeSet||(x.typeSet=new Set,x.types.forEach(_=>x.typeSet.add(_.name))),x.typeSet}function A(x){const _=[];if(typeof x!="string")throw new TypeError("Signatures must be strings");const L=x.trim();if(L==="")return _;const R=L.split(",");for(let H=0;H<R.length;++H){const Y=p(R[H].trim());if(Y.restParam&&H!==R.length-1)throw new SyntaxError('Unexpected rest parameter "'+R[H]+'": only allowed for the last parameter');if(Y.types.length===0)return null;_.push(Y)}return _}function F(x){const _=X(x);return _?_.restParam:!1}function y(x){if(!x||x.types.length===0)return hn;if(x.types.length===1)return h(x.types[0].name).test;if(x.types.length===2){const _=h(x.types[0].name).test,L=h(x.types[1].name).test;return function(H){return _(H)||L(H)}}else{const _=x.types.map(function(L){return h(L.name).test});return function(R){for(let H=0;H<_.length;H++)if(_[H](R))return!0;return!1}}}function C(x){let _,L,R;if(F(x)){_=Q(x).map(y);const H=_.length,Y=y(X(x)),ae=function(te){for(let ie=H;ie<te.length;ie++)if(!Y(te[ie]))return!1;return!0};return function(ie){for(let re=0;re<_.length;re++)if(!_[re](ie[re]))return!1;return ae(ie)&&ie.length>=H+1}}else return x.length===0?function(Y){return Y.length===0}:x.length===1?(L=y(x[0]),function(Y){return L(Y[0])&&Y.length===1}):x.length===2?(L=y(x[0]),R=y(x[1]),function(Y){return L(Y[0])&&R(Y[1])&&Y.length===2}):(_=x.map(y),function(Y){for(let ae=0;ae<_.length;ae++)if(!_[ae](Y[ae]))return!1;return Y.length===_.length})}function b(x,_){return _<x.length?x[_]:F(x)?X(x):null}function E(x,_){const L=b(x,_);return L?g(L):new Set}function S(x){return x.conversion===null||x.conversion===void 0}function M(x,_){const L=new Set;return x.forEach(R=>{const H=E(R.params,_);let Y;for(Y of H)L.add(Y)}),L.has("any")?["any"]:Array.from(L)}function N(x,_,L){let R,H;const Y=x||"unnamed";let ae=L,te;for(te=0;te<_.length;te++){const Ie=[];if(ae.forEach(Ue=>{const rr=b(Ue.params,te),We=y(rr);(te<Ue.params.length||F(Ue.params))&&We(_[te])&&Ie.push(Ue)}),Ie.length===0){if(H=M(ae,te),H.length>0){const Ue=u(_[te]);return R=new TypeError("Unexpected type of argument in function "+Y+" (expected: "+H.join(" or ")+", actual: "+Ue.join(" | ")+", index: "+te+")"),R.data={category:"wrongType",fn:Y,index:te,actual:Ue,expected:H},R}}else ae=Ie}const ie=ae.map(function(Ie){return F(Ie.params)?1/0:Ie.params.length});if(_.length<Math.min.apply(null,ie))return H=M(ae,te),R=new TypeError("Too few arguments in function "+Y+" (expected: "+H.join(" or ")+", index: "+_.length+")"),R.data={category:"tooFewArgs",fn:Y,index:_.length,expected:H},R;const re=Math.max.apply(null,ie);if(_.length>re)return R=new TypeError("Too many arguments in function "+Y+" (expected: "+re+", actual: "+_.length+")"),R.data={category:"tooManyArgs",fn:Y,index:_.length,expectedLength:re},R;const ze=[];for(let Ie=0;Ie<_.length;++Ie)ze.push(u(_[Ie]).join("|"));return R=new TypeError('Arguments of type "'+ze.join(", ")+'" do not match any of the defined signatures of function '+Y+"."),R.data={category:"mismatch",actual:ze},R}function O(x){let _=r.length+1;for(let L=0;L<x.types.length;L++)S(x.types[L])&&(_=Math.min(_,x.types[L].typeIndex));return _}function T(x){let _=a+1;for(let L=0;L<x.types.length;L++)S(x.types[L])||(_=Math.min(_,x.types[L].conversionIndex));return _}function I(x,_){if(x.hasAny){if(!_.hasAny)return 1}else if(_.hasAny)return-1;if(x.restParam){if(!_.restParam)return 1}else if(_.restParam)return-1;if(x.hasConversion){if(!_.hasConversion)return 1}else if(_.hasConversion)return-1;const L=O(x)-O(_);if(L<0)return-1;if(L>0)return 1;const R=T(x)-T(_);return R<0?-1:R>0?1:0}function B(x,_){const L=x.params,R=_.params,H=X(L),Y=X(R),ae=F(L),te=F(R);if(ae&&H.hasAny){if(!te||!Y.hasAny)return 1}else if(te&&Y.hasAny)return-1;let ie=0,re=0,ze;for(ze of L)ze.hasAny&&++ie,ze.hasConversion&&++re;let Ie=0,Ue=0;for(ze of R)ze.hasAny&&++Ie,ze.hasConversion&&++Ue;if(ie!==Ie)return ie-Ie;if(ae&&H.hasConversion){if(!te||!Y.hasConversion)return 1}else if(te&&Y.hasConversion)return-1;if(re!==Ue)return re-Ue;if(ae){if(!te)return 1}else if(te)return-1;const rr=(L.length-R.length)*(ae?-1:1);if(rr!==0)return rr;const We=[];let cr=0;for(let Gr=0;Gr<L.length;++Gr){const _t=I(L[Gr],R[Gr]);We.push(_t),cr+=_t}if(cr!==0)return cr;let lr;for(lr of We)if(lr!==0)return lr;return 0}function G(x){if(x.length===0)return[];const _=x.map(h);x.length>1&&_.sort((H,Y)=>H.index-Y.index);let L=_[0].conversionsTo;if(x.length===1)return L;L=L.concat([]);const R=new Set(x);for(let H=1;H<_.length;++H){let Y;for(Y of _[H].conversionsTo)R.has(Y.from)||(L.push(Y),R.add(Y.from))}return L}function $(x,_){let L=_;if(x.some(H=>H.hasConversion)){const H=F(x),Y=x.map(z);L=function(){const te=[],ie=H?arguments.length-1:arguments.length;for(let re=0;re<ie;re++)te[re]=Y[re](arguments[re]);return H&&(te[ie]=arguments[ie].map(Y[ie])),_.apply(this,te)}}let R=L;if(F(x)){const H=x.length-1;R=function(){return L.apply(this,J(arguments,0,H).concat([J(arguments,H)]))}}return R}function z(x){let _,L,R,H;const Y=[],ae=[];switch(x.types.forEach(function(te){te.conversion&&(Y.push(h(te.conversion.from).test),ae.push(te.conversion.convert))}),ae.length){case 0:return function(ie){return ie};case 1:return _=Y[0],R=ae[0],function(ie){return _(ie)?R(ie):ie};case 2:return _=Y[0],L=Y[1],R=ae[0],H=ae[1],function(ie){return _(ie)?R(ie):L(ie)?H(ie):ie};default:return function(ie){for(let re=0;re<ae.length;re++)if(Y[re](ie))return ae[re](ie);return ie}}}function V(x){function _(L,R,H){if(R<L.length){const Y=L[R];let ae=[];if(Y.restParam){const te=Y.types.filter(S);te.length<Y.types.length&&ae.push({types:te,name:"..."+te.map(ie=>ie.name).join("|"),hasAny:te.some(ie=>ie.isAny),hasConversion:!1,restParam:!0}),ae.push(Y)}else ae=Y.types.map(function(te){return{types:[te],name:te.name,hasAny:te.isAny,hasConversion:te.conversion,restParam:!1}});return ee(ae,function(te){return _(L,R+1,H.concat([te]))})}else return[H]}return _(x,0,[])}function W(x,_){const L=Math.max(x.length,_.length);for(let te=0;te<L;te++){const ie=E(x,te),re=E(_,te);let ze=!1,Ie;for(Ie of re)if(ie.has(Ie)){ze=!0;break}if(!ze)return!1}const R=x.length,H=_.length,Y=F(x),ae=F(_);return Y?ae?R===H:H>=R:ae?R>=H:R===H}function P(x){return x.map(_=>we(_)?pe(_.referToSelf.callback):ge(_)?le(_.referTo.references,_.referTo.callback):_)}function q(x,_,L){const R=[];let H;for(H of x){let Y=L[H];if(typeof Y!="number")throw new TypeError('No definition for referenced signature "'+H+'"');if(Y=_[Y],typeof Y!="function")return!1;R.push(Y)}return R}function Z(x,_,L){const R=P(x),H=new Array(R.length).fill(!1);let Y=!0;for(;Y;){Y=!1;let ae=!0;for(let te=0;te<R.length;++te){if(H[te])continue;const ie=R[te];if(we(ie))R[te]=ie.referToSelf.callback(L),R[te].referToSelf=ie.referToSelf,H[te]=!0,ae=!1;else if(ge(ie)){const re=q(ie.referTo.references,R,_);re?(R[te]=ie.referTo.callback.apply(this,re),R[te].referTo=ie.referTo,H[te]=!0,ae=!1):Y=!0}}if(ae&&Y)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return R}function ne(x){const _=/\bthis(\(|\.signatures\b)/;Object.keys(x).forEach(L=>{const R=x[L];if(_.test(R.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function k(x,_){if(o.createCount++,Object.keys(_).length===0)throw new SyntaxError("No signatures provided");o.warnAgainstDeprecatedThis&&ne(_);const L=[],R=[],H={},Y=[];let ae;for(ae in _){if(!Object.prototype.hasOwnProperty.call(_,ae))continue;const Ne=A(ae);if(!Ne)continue;L.forEach(function(it){if(W(it,Ne))throw new TypeError('Conflicting signatures "'+m(it)+'" and "'+m(Ne)+'".')}),L.push(Ne);const tr=R.length;R.push(_[ae]);const eh=Ne.map(w);let zt;for(zt of V(eh)){const it=m(zt);Y.push({params:zt,name:it,fn:tr}),zt.every(rh=>!rh.hasConversion)&&(H[it]=tr)}}Y.sort(B);const te=Z(R,H,nt);let ie;for(ie in H)Object.prototype.hasOwnProperty.call(H,ie)&&(H[ie]=te[H[ie]]);const re=[],ze=new Map;for(ie of Y)ze.has(ie.name)||(ie.fn=te[ie.fn],re.push(ie),ze.set(ie.name,ie));const Ie=re[0]&&re[0].params.length<=2&&!F(re[0].params),Ue=re[1]&&re[1].params.length<=2&&!F(re[1].params),rr=re[2]&&re[2].params.length<=2&&!F(re[2].params),We=re[3]&&re[3].params.length<=2&&!F(re[3].params),cr=re[4]&&re[4].params.length<=2&&!F(re[4].params),lr=re[5]&&re[5].params.length<=2&&!F(re[5].params),Gr=Ie&&Ue&&rr&&We&&cr&&lr;for(let Ne=0;Ne<re.length;++Ne)re[Ne].test=C(re[Ne].params);const _t=Ie?y(re[0].params[0]):ir,M0=Ue?y(re[1].params[0]):ir,S0=rr?y(re[2].params[0]):ir,N0=We?y(re[3].params[0]):ir,x0=cr?y(re[4].params[0]):ir,B0=lr?y(re[5].params[0]):ir,_0=Ie?y(re[0].params[1]):ir,z0=Ue?y(re[1].params[1]):ir,T0=rr?y(re[2].params[1]):ir,O0=We?y(re[3].params[1]):ir,I0=cr?y(re[4].params[1]):ir,L0=lr?y(re[5].params[1]):ir;for(let Ne=0;Ne<re.length;++Ne)re[Ne].implementation=$(re[Ne].params,re[Ne].fn);const $0=Ie?re[0].implementation:Tr,q0=Ue?re[1].implementation:Tr,P0=rr?re[2].implementation:Tr,R0=We?re[3].implementation:Tr,U0=cr?re[4].implementation:Tr,V0=lr?re[5].implementation:Tr,Z0=Ie?re[0].params.length:-1,G0=Ue?re[1].params.length:-1,Y0=rr?re[2].params.length:-1,J0=We?re[3].params.length:-1,Q0=cr?re[4].params.length:-1,X0=lr?re[5].params.length:-1,H0=Gr?6:0,K0=re.length,W0=re.map(Ne=>Ne.test),k0=re.map(Ne=>Ne.implementation),j0=function(){for(let tr=H0;tr<K0;tr++)if(W0[tr](arguments))return k0[tr].apply(this,arguments);return o.onMismatch(x,arguments,re)};function nt(Ne,tr){return arguments.length===Z0&&_t(Ne)&&_0(tr)?$0.apply(this,arguments):arguments.length===G0&&M0(Ne)&&z0(tr)?q0.apply(this,arguments):arguments.length===Y0&&S0(Ne)&&T0(tr)?P0.apply(this,arguments):arguments.length===J0&&N0(Ne)&&O0(tr)?R0.apply(this,arguments):arguments.length===Q0&&x0(Ne)&&I0(tr)?U0.apply(this,arguments):arguments.length===X0&&B0(Ne)&&L0(tr)?V0.apply(this,arguments):j0.apply(this,arguments)}try{Object.defineProperty(nt,"name",{value:x})}catch{}return nt.signatures=H,nt._typedFunctionData={signatures:re,signatureMap:ze},nt}function U(x,_,L){throw N(x,_,L)}function Q(x){return J(x,0,x.length-1)}function X(x){return x[x.length-1]}function J(x,_,L){return Array.prototype.slice.call(x,_,L)}function ue(x,_){for(let L=0;L<x.length;L++)if(_(x[L]))return x[L]}function ee(x,_){return Array.prototype.concat.apply([],x.map(_))}function oe(){const x=Q(arguments).map(L=>m(A(L))),_=X(arguments);if(typeof _!="function")throw new TypeError("Callback function expected as last argument");return le(x,_)}function le(x,_){return{referTo:{references:x,callback:_}}}function pe(x){if(typeof x!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:x}}}function ge(x){return x&&typeof x.referTo=="object"&&Array.isArray(x.referTo.references)&&typeof x.referTo.callback=="function"}function we(x){return x&&typeof x.referToSelf=="object"&&typeof x.referToSelf.callback=="function"}function he(x,_){if(!x)return _;if(_&&_!==x){const L=new Error("Function names do not match (expected: "+x+", actual: "+_+")");throw L.data={actual:_,expected:x},L}return x}function be(x){let _;for(const L in x)Object.prototype.hasOwnProperty.call(x,L)&&(f(x[L])||typeof x[L].signature=="string")&&(_=he(_,x[L].name));return _}function Fe(x,_){let L;for(L in _)if(Object.prototype.hasOwnProperty.call(_,L)){if(L in x&&_[L]!==x[L]){const R=new Error('Signature "'+L+'" is defined twice');throw R.data={signature:L,sourceFunction:_[L],destFunction:x[L]},R}x[L]=_[L]}}const Se=o;o=function(x){const _=typeof x=="string",L=_?1:0;let R=_?x:"";const H={};for(let Y=L;Y<arguments.length;++Y){const ae=arguments[Y];let te={},ie;if(typeof ae=="function"?(ie=ae.name,typeof ae.signature=="string"?te[ae.signature]=ae:f(ae)&&(te=ae.signatures)):e(ae)&&(te=ae,_||(ie=be(ae))),Object.keys(te).length===0){const re=new TypeError("Argument to 'typed' at index "+Y+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw re.data={index:Y,argument:ae},re}_||(R=he(R,ie)),Fe(H,te)}return k(R||"",H)},o.create=dn,o.createCount=Se.createCount,o.onMismatch=U,o.throwMismatchError=U,o.createError=N,o.clear=l,o.clearConversions=s,o.addTypes=c,o._findType=h,o.referTo=oe,o.referToSelf=pe,o.convert=v,o.findSignature=d,o.find=D,o.isTypedFunction=f,o.warnAgainstDeprecatedThis=!0,o.addType=function(x,_){let L="any";_!==!1&&i.has("Object")&&(L="Object"),o.addTypes([x],L)};function Ge(x){if(!x||typeof x.from!="string"||typeof x.to!="string"||typeof x.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(x.to===x.from)throw new SyntaxError('Illegal to define conversion from "'+x.from+'" to itself.')}return o.addConversion=function(x){Ge(x);const _=h(x.to);if(_.conversionsTo.every(function(L){return L.from!==x.from}))_.conversionsTo.push({from:x.from,convert:x.convert,index:a++});else throw new Error('There is already a conversion from "'+x.from+'" to "'+_.name+'"')},o.addConversions=function(x){x.forEach(o.addConversion)},o.removeConversion=function(x){Ge(x);const _=h(x.to),L=ue(_.conversionsTo,H=>H.from===x.from);if(!L)throw new Error("Attempt to remove nonexistent conversion from "+x.from+" to "+x.to);if(L.convert!==x.convert)throw new Error("Conversion to remove does not match existing conversion");const R=_.conversionsTo.indexOf(L);_.conversionsTo.splice(R,1)},o.resolve=function(x,_){if(!f(x))throw new TypeError(vn);const L=x._typedFunctionData.signatures;for(let R=0;R<L.length;++R)if(L[R].test(_))return L[R];return null},o}const pn=dn();function Te(e){return typeof e=="boolean"?!0:isFinite(e)?e===Math.round(e):!1}var vu=Math.sign||function(e){return e>0?1:e<0?-1:0};function It(e,t,n){var i={2:"0b",8:"0o",16:"0x"},r=i[t],a="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!Te(n))throw new Error("size must be an integer");if(e>2**(n-1)-1||e<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!Te(e))throw new Error("Value must be an integer");e<0&&(e=e+2**n),a="i".concat(n)}var o="";return e<0&&(e=-e,o="-"),"".concat(o).concat(r).concat(e.toString(t)).concat(a)}function Lt(e,t){if(typeof t=="function")return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var n="auto",i,r;if(t&&(t.notation&&(n=t.notation),Le(t)?i=t:Le(t.precision)&&(i=t.precision),t.wordSize&&(r=t.wordSize,typeof r!="number")))throw new Error('Option "wordSize" must be a number');switch(n){case"fixed":return pu(e,i);case"exponential":return mn(e,i);case"engineering":return du(e,i);case"bin":return It(e,2,r);case"oct":return It(e,8,r);case"hex":return It(e,16,r);case"auto":return mu(e,i,t&&t).replace(/((\.\d*?)(0+))($|e)/,function(){var a=arguments[2],o=arguments[4];return a!=="."?a+o:o});default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function ot(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],i=t[2],r=parseFloat(t[4]||"0"),a=i.indexOf(".");r+=a!==-1?a-1:i.length-1;var o=i.replace(".","").replace(/^0*/,function(h){return r-=h.length,""}).replace(/0*$/,"").split("").map(function(h){return parseInt(h)});return o.length===0&&(o.push(0),r++),{sign:n,coefficients:o,exponent:r}}function du(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=ot(e),i=st(n,t),r=i.exponent,a=i.coefficients,o=r%3===0?r:r<0?r-3-r%3:r-r%3;if(Le(t))for(;t>a.length||r-o+1>a.length;)a.push(0);else for(var h=Math.abs(r-o)-(a.length-1),c=0;c<h;c++)a.push(0);for(var l=Math.abs(r-o),s=1;l>0;)s++,l--;var u=a.slice(s).join(""),f=Le(t)&&u.length||u.match(/[1-9]/)?"."+u:"",d=a.slice(0,s).join("")+f+"e"+(r>=0?"+":"")+o.toString();return i.sign+d}function pu(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=ot(e),i=typeof t=="number"?st(n,n.exponent+1+t):n,r=i.coefficients,a=i.exponent+1,o=a+(t||0);return r.length<o&&(r=r.concat(Or(o-r.length))),a<0&&(r=Or(-a+1).concat(r),a=1),a<r.length&&r.splice(a,0,a===0?"0.":"."),i.sign+r.join("")}function mn(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=ot(e),i=t?st(n,t):n,r=i.coefficients,a=i.exponent;r.length<t&&(r=r.concat(Or(t-r.length)));var o=r.shift();return i.sign+o+(r.length>0?"."+r.join(""):"")+"e"+(a>=0?"+":"")+a}function mu(e,t,n){if(isNaN(e)||!isFinite(e))return String(e);var i=n&&n.lowerExp!==void 0?n.lowerExp:-3,r=n&&n.upperExp!==void 0?n.upperExp:5,a=ot(e),o=t?st(a,t):a;if(o.exponent<i||o.exponent>=r)return mn(e,t);var h=o.coefficients,c=o.exponent;h.length<t&&(h=h.concat(Or(t-h.length))),h=h.concat(Or(c-h.length+1+(h.length<t?t-h.length:0))),h=Or(-c).concat(h);var l=c>0?c:0;return l<h.length-1&&h.splice(l+1,0,"."),o.sign+h.join("")}function st(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},i=n.coefficients;t<=0;)i.unshift(0),n.exponent++,t++;if(i.length>t){var r=i.splice(t,i.length-t);if(r[0]>=5){var a=t-1;for(i[a]++;i[a]===10;)i.pop(),a===0&&(i.unshift(0),n.exponent++,a++),a--,i[a]++}}return n}function Or(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function gu(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var Du=Number.EPSILON||2220446049250313e-31;function yr(e,t,n){if(n==null)return e===t;if(e===t)return!0;if(isNaN(e)||isNaN(t))return!1;if(isFinite(e)&&isFinite(t)){var i=Math.abs(e-t);return i<=Du?!0:i<=Math.max(Math.abs(e),Math.abs(t))*n}return!1}function $t(e,t,n){var i=e.constructor,r=new i(2),a="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!Te(n))throw new Error("size must be an integer");if(e.greaterThan(r.pow(n-1).sub(1))||e.lessThan(r.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(r.pow(n))),a="i".concat(n)}switch(t){case 2:return"".concat(e.toBinary()).concat(a);case 8:return"".concat(e.toOctal()).concat(a);case 16:return"".concat(e.toHexadecimal()).concat(a);default:throw new Error("Base ".concat(t," not supported "))}}function yu(e,t){if(typeof t=="function")return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var n="auto",i,r;if(t!==void 0&&(t.notation&&(n=t.notation),typeof t=="number"?i=t:t.precision!==void 0&&(i=t.precision),t.wordSize&&(r=t.wordSize,typeof r!="number")))throw new Error('Option "wordSize" must be a number');switch(n){case"fixed":return Au(e,i);case"exponential":return gn(e,i);case"engineering":return wu(e,i);case"bin":return $t(e,2,r);case"oct":return $t(e,8,r);case"hex":return $t(e,16,r);case"auto":{var a=t&&t.lowerExp!==void 0?t.lowerExp:-3,o=t&&t.upperExp!==void 0?t.upperExp:5;if(e.isZero())return"0";var h,c=e.toSignificantDigits(i),l=c.e;return l>=a&&l<o?h=c.toFixed():h=gn(e,i),h.replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],u=arguments[4];return s!=="."?s+u:u})}default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function wu(e,t){var n=e.e,i=n%3===0?n:n<0?n-3-n%3:n-n%3,r=e.mul(Math.pow(10,-i)),a=r.toPrecision(t);if(a.indexOf("e")!==-1){var o=e.constructor;a=new o(a).toFixed()}return a+"e"+(n>=0?"+":"")+i.toString()}function gn(e,t){return t!==void 0?e.toExponential(t-1):e.toExponential()}function Au(e,t){return e.toFixed(t)}function $e(e,t){var n=Eu(e,t);return t&&typeof t=="object"&&"truncate"in t&&n.length>t.truncate?n.substring(0,t.truncate-3)+"...":n}function Eu(e,t){if(typeof e=="number")return Lt(e,t);if(Re(e))return yu(e,t);if(Fu(e))return!t||t.fraction!=="decimal"?e.s*e.n+"/"+e.d:e.toString();if(Array.isArray(e))return wn(e,t);if(nr(e))return Dn(e);if(typeof e=="function")return e.syntax?String(e.syntax):"function";if(e&&typeof e=="object"){if(typeof e.format=="function")return e.format(t);if(e&&e.toString(t)!=={}.toString())return e.toString(t);var n=Object.keys(e).map(i=>Dn(i)+": "+$e(e[i],t));return"{"+n.join(", ")+"}"}return String(e)}function Dn(e){for(var t=String(e),n="",i=0;i<t.length;){var r=t.charAt(i);n+=r in yn?yn[r]:r,i++}return'"'+n+'"'}var yn={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function wn(e,t){if(Array.isArray(e)){for(var n="[",i=e.length,r=0;r<i;r++)r!==0&&(n+=", "),n+=wn(e[r],t);return n+="]",n}else return $e(e,t)}function Fu(e){return e&&typeof e=="object"&&typeof e.s=="number"&&typeof e.n=="number"&&typeof e.d=="number"||!1}function Ee(e,t,n){if(!(this instanceof Ee))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}Ee.prototype=new RangeError,Ee.prototype.constructor=RangeError,Ee.prototype.name="DimensionError",Ee.prototype.isDimensionError=!0;function Sr(e,t,n){if(!(this instanceof Sr))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=n),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}Sr.prototype=new RangeError,Sr.prototype.constructor=RangeError,Sr.prototype.name="IndexError",Sr.prototype.isIndexError=!0;function qe(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function An(e,t,n){var i,r=e.length;if(r!==t[n])throw new Ee(r,t[n]);if(n<t.length-1){var a=n+1;for(i=0;i<r;i++){var o=e[i];if(!Array.isArray(o))throw new Ee(t.length-1,t.length,"<");An(e[i],t,a)}}else for(i=0;i<r;i++)if(Array.isArray(e[i]))throw new Ee(t.length+1,t.length,">")}function En(e,t){var n=t.length===0;if(n){if(Array.isArray(e))throw new Ee(e.length,0)}else An(e,t,0)}function ft(e,t){var n=e.isMatrix?e._size:qe(e),i=t._sourceSize;i.forEach((r,a)=>{if(r!==null&&r!==n[a])throw new Ee(r,n[a])})}function _e(e,t){if(e!==void 0){if(!Le(e)||!Te(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||typeof t=="number"&&e>=t)throw new Sr(e,t)}}function Ir(e){for(var t=0;t<e._dimensions.length;++t){var n=e._dimensions[t];if(n._data&&Me(n._data)){if(n._size[0]===0)return!0}else if(n.isRange){if(n.start===n.end)return!0}else if(nr(n)&&n.length===0)return!0}return!1}function ct(e,t,n){if(!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new Error("Resizing to scalar is not supported");t.forEach(function(r){if(!Le(r)||!Te(r)||r<0)throw new TypeError("Invalid size, must contain positive integers (size: "+$e(t)+")")}),(Le(e)||Re(e))&&(e=[e]);var i=n!==void 0?n:0;return qt(e,t,0,i),e}function qt(e,t,n,i){var r,a,o=e.length,h=t[n],c=Math.min(o,h);if(e.length=h,n<t.length-1){var l=n+1;for(r=0;r<c;r++)a=e[r],Array.isArray(a)||(a=[a],e[r]=a),qt(a,t,l,i);for(r=c;r<h;r++)a=[],e[r]=a,qt(a,t,l,i)}else{for(r=0;r<c;r++)for(;Array.isArray(e[r]);)e[r]=e[r][0];for(r=c;r<h;r++)e[r]=i}}function Pt(e,t){var n=Ut(e),i=n.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(t.length===0)throw new Ee(0,i,"!=");t=Rt(t,i);var r=Fn(t);if(i!==r)throw new Ee(r,i,"!=");try{return Cu(n,t)}catch(a){throw a instanceof Ee?new Ee(r,i,"!="):a}}function Rt(e,t){var n=Fn(e),i=e.slice(),r=-1,a=e.indexOf(r),o=e.indexOf(r,a+1)>=0;if(o)throw new Error("More than one wildcard in sizes");var h=a>=0,c=t%n===0;if(h)if(c)i[a]=-t/n;else throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-n);return i}function Fn(e){return e.reduce((t,n)=>t*n,1)}function Cu(e,t){for(var n=e,i,r=t.length-1;r>0;r--){var a=t[r];i=[];for(var o=n.length/a,h=0;h<o;h++)i.push(n.slice(h*a,(h+1)*a));n=i}return n}function Cn(e,t){for(var n=t||qe(e);Array.isArray(e)&&e.length===1;)e=e[0],n.shift();for(var i=n.length;n[i-1]===1;)i--;return i<n.length&&(e=bn(e,i,0),n.length=i),e}function bn(e,t,n){var i,r;if(n<t){var a=n+1;for(i=0,r=e.length;i<r;i++)e[i]=bn(e[i],t,a)}else for(;Array.isArray(e);)e=e[0];return e}function Mn(e,t,n,i){var r=i||qe(e);if(n)for(var a=0;a<n;a++)e=[e],r.unshift(1);for(e=Sn(e,t,0);r.length<t;)r.push(1);return e}function Sn(e,t,n){var i,r;if(Array.isArray(e)){var a=n+1;for(i=0,r=e.length;i<r;i++)e[i]=Sn(e[i],t,a)}else for(var o=n;o<t;o++)e=[e];return e}function Ut(e){if(!Array.isArray(e))return e;var t=[];return e.forEach(function n(i){Array.isArray(i)?i.forEach(n):t.push(i)}),t}function Jr(e,t){for(var n,i=0,r=0;r<e.length;r++){var a=e[r],o=Array.isArray(a);if(r===0&&o&&(i=a.length),o&&a.length!==i)return;var h=o?Jr(a,t):t(a);if(n===void 0)n=h;else if(n!==h)return"mixed"}return n}function Nn(e,t,n,i){if(i<n){if(e.length!==t.length)throw new Ee(e.length,t.length);for(var r=[],a=0;a<e.length;a++)r[a]=Nn(e[a],t[a],n,i+1);return r}else return e.concat(t)}function xn(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(e.length===1)return e[0];if(e.length>1)return e.slice(1).reduce(function(n,i){return Nn(n,i,t,0)},e[0]);throw new Error("Wrong number of arguments in function concat")}function bu(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=t.map(f=>f.length),r=Math.max(...i),a=new Array(r).fill(null),o=0;o<t.length;o++)for(var h=t[o],c=i[o],l=0;l<c;l++){var s=r-c+l;h[l]>a[s]&&(a[s]=h[l])}for(var u=0;u<t.length;u++)lt(t[u],a);return a}function lt(e,t){for(var n=t.length,i=e.length,r=0;r<i;r++){var a=n-i+r;if(e[r]<t[a]&&e[r]>1||e[r]>t[a])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(i," with size ").concat(e[r]," to size ").concat(t[a]))}}function Bn(e,t){var n=qe(e);if(zr(n,t))return e;lt(n,t);var i=bu(n,t),r=i.length,a=[...Array(r-n.length).fill(1),...n],o=Su(e);n.length<r&&(o=Pt(o,a),n=qe(o));for(var h=0;h<r;h++)n[h]<i[h]&&(o=Mu(o,i[h],h),n=qe(o));return o}function Mu(e,t,n){return xn(...Array(t).fill(e),n)}function Su(e){return Ye([],e)}function j(e,t,n,i){function r(a){var o=cu(a,t.map(Bu));return Nu(e,t,a),n(o)}return r.isFactory=!0,r.fn=e,r.dependencies=t.slice().sort(),i&&(r.meta=i),r}function Nu(e,t,n){var i=t.filter(a=>!xu(a)).every(a=>n[a]!==void 0);if(!i){var r=t.filter(a=>n[a]===void 0);throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(r.map(a=>'"'.concat(a,'"')).join(", "),"."))}}function xu(e){return e&&e[0]==="?"}function Bu(e){return e&&e[0]==="?"?e.slice(1):e}function _n(e,t){if(On(e)&&Tn(e,t))return e[t];throw typeof e[t]=="function"&&zu(e,t)?new Error('Cannot access method "'+t+'" as a property'):new Error('No access to property "'+t+'"')}function zn(e,t,n){if(On(e)&&Tn(e,t))return e[t]=n,n;throw new Error('No access to property "'+t+'"')}function _u(e,t){return t in e}function Tn(e,t){return!e||typeof e!="object"?!1:Yr(Tu,t)?!0:!(t in Object.prototype||t in Function.prototype)}function zu(e,t){return e==null||typeof e[t]!="function"||Yr(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e)?!1:Yr(Ou,t)?!0:!(t in Object.prototype||t in Function.prototype)}function On(e){return typeof e=="object"&&e&&e.constructor===Object}var Tu={length:!0,name:!0},Ou={toString:!0,valueOf:!0,toLocaleString:!0};class Iu{constructor(t){this.wrappedObject=t}keys(){return Object.keys(this.wrappedObject)}get(t){return _n(this.wrappedObject,t)}set(t,n){return zn(this.wrappedObject,t,n),this}has(t){return _u(this.wrappedObject,t)}}function Lu(e){return e?e instanceof Map||e instanceof Iu||typeof e.set=="function"&&typeof e.get=="function"&&typeof e.keys=="function"&&typeof e.has=="function":!1}var In=function(){return In=pn.create,pn},$u=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],qu=j("typed",$u,function(t){var{BigNumber:n,Complex:i,DenseMatrix:r,Fraction:a}=t,o=In();return o.clear(),o.addTypes([{name:"number",test:Le},{name:"Complex",test:Tt},{name:"BigNumber",test:Re},{name:"Fraction",test:Ot},{name:"Unit",test:on},{name:"identifier",test:h=>nr&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(h)},{name:"string",test:nr},{name:"Chain",test:ou},{name:"Array",test:Me},{name:"Matrix",test:Be},{name:"DenseMatrix",test:sn},{name:"SparseMatrix",test:fn},{name:"Range",test:cn},{name:"Index",test:ut},{name:"boolean",test:$a},{name:"ResultSet",test:qa},{name:"Help",test:Pa},{name:"function",test:Ra},{name:"Date",test:Ua},{name:"RegExp",test:Va},{name:"null",test:Za},{name:"undefined",test:Ga},{name:"AccessorNode",test:Ya},{name:"ArrayNode",test:Ja},{name:"AssignmentNode",test:Qa},{name:"BlockNode",test:Xa},{name:"ConditionalNode",test:Ha},{name:"ConstantNode",test:Ka},{name:"FunctionNode",test:ka},{name:"FunctionAssignmentNode",test:Wa},{name:"IndexNode",test:ja},{name:"Node",test:eu},{name:"ObjectNode",test:ru},{name:"OperatorNode",test:tu},{name:"ParenthesisNode",test:nu},{name:"RangeNode",test:iu},{name:"RelationalNode",test:au},{name:"SymbolNode",test:uu},{name:"Map",test:Lu},{name:"Object",test:ln}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(c){if(n||Vt(c),gu(c)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+c+"). Use function bignumber(x) to convert to BigNumber.");return new n(c)}},{from:"number",to:"Complex",convert:function(c){return i||ht(c),new i(c,0)}},{from:"BigNumber",to:"Complex",convert:function(c){return i||ht(c),new i(c.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(c){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(c){return i||ht(c),new i(c.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(c){a||Zt(c);var l=new a(c);if(l.valueOf()!==c)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+c+"). Use function fraction(x) to convert to Fraction.");return l}},{from:"string",to:"number",convert:function(c){var l=Number(c);if(isNaN(l))throw new Error('Cannot convert "'+c+'" to a number');return l}},{from:"string",to:"BigNumber",convert:function(c){n||Vt(c);try{return new n(c)}catch{throw new Error('Cannot convert "'+c+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(c){a||Zt(c);try{return new a(c)}catch{throw new Error('Cannot convert "'+c+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(c){i||ht(c);try{return new i(c)}catch{throw new Error('Cannot convert "'+c+'" to Complex')}}},{from:"boolean",to:"number",convert:function(c){return+c}},{from:"boolean",to:"BigNumber",convert:function(c){return n||Vt(c),new n(+c)}},{from:"boolean",to:"Fraction",convert:function(c){return a||Zt(c),new a(+c)}},{from:"boolean",to:"string",convert:function(c){return String(c)}},{from:"Array",to:"Matrix",convert:function(c){return r||Pu(),new r(c)}},{from:"Matrix",to:"Array",convert:function(c){return c.valueOf()}}]),o.onMismatch=(h,c,l)=>{var s=o.createError(h,c,l);if(["wrongType","mismatch"].includes(s.data.category)&&c.length===1&&at(c[0])&&l.some(f=>!f.params.includes(","))){var u=new TypeError("Function '".concat(h,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(h,")'."));throw u.data=s.data,u}throw s},o.onMismatch=(h,c,l)=>{var s=o.createError(h,c,l);if(["wrongType","mismatch"].includes(s.data.category)&&c.length===1&&at(c[0])&&l.some(f=>!f.params.includes(","))){var u=new TypeError("Function '".concat(h,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(h,")'."));throw u.data=s.data,u}throw s},o});function Vt(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function ht(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function Pu(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function Zt(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var Lr=9e15,wr=1e9,Gt="0123456789abcdef",vt="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",dt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Yt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Lr,maxE:Lr,crypto:!1},Ln,pr,me=!0,pt="[DecimalError] ",Ar=pt+"Invalid argument: ",$n=pt+"Precision limit exceeded",qn=pt+"crypto unavailable",Pn="[object Decimal]",He=Math.floor,Ve=Math.pow,Ru=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Uu=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Vu=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Rn=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ar=1e7,de=7,Zu=9007199254740991,Gu=vt.length-1,Jt=dt.length-1,K={toStringTag:Pn};K.absoluteValue=K.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),ve(e)},K.ceil=function(){return ve(new this.constructor(this),this.e+1,2)},K.clampedTo=K.clamp=function(e,t){var n,i=this,r=i.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(Ar+t);return n=i.cmp(e),n<0?e:i.cmp(t)>0?t:new r(i)},K.comparedTo=K.cmp=function(e){var t,n,i,r,a=this,o=a.d,h=(e=new a.constructor(e)).d,c=a.s,l=e.s;if(!o||!h)return!c||!l?NaN:c!==l?c:o===h?0:!o^c<0?1:-1;if(!o[0]||!h[0])return o[0]?c:h[0]?-l:0;if(c!==l)return c;if(a.e!==e.e)return a.e>e.e^c<0?1:-1;for(i=o.length,r=h.length,t=0,n=i<r?i:r;t<n;++t)if(o[t]!==h[t])return o[t]>h[t]^c<0?1:-1;return i===r?0:i>r^c<0?1:-1},K.cosine=K.cos=function(){var e,t,n=this,i=n.constructor;return n.d?n.d[0]?(e=i.precision,t=i.rounding,i.precision=e+Math.max(n.e,n.sd())+de,i.rounding=1,n=Yu(i,Jn(i,n)),i.precision=e,i.rounding=t,ve(pr==2||pr==3?n.neg():n,e,t,!0)):new i(1):new i(NaN)},K.cubeRoot=K.cbrt=function(){var e,t,n,i,r,a,o,h,c,l,s=this,u=s.constructor;if(!s.isFinite()||s.isZero())return new u(s);for(me=!1,a=s.s*Ve(s.s*s,1/3),!a||Math.abs(a)==1/0?(n=Je(s.d),e=s.e,(a=(e-n.length+1)%3)&&(n+=a==1||a==-2?"0":"00"),a=Ve(n,1/3),e=He((e+1)/3)-(e%3==(e<0?-1:2)),a==1/0?n="5e"+e:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),i=new u(n),i.s=s.s):i=new u(a.toString()),o=(e=u.precision)+3;;)if(h=i,c=h.times(h).times(h),l=c.plus(s),i=Oe(l.plus(s).times(h),l.plus(c),o+2,1),Je(h.d).slice(0,o)===(n=Je(i.d)).slice(0,o))if(n=n.slice(o-3,o+1),n=="9999"||!r&&n=="4999"){if(!r&&(ve(h,e+1,0),h.times(h).times(h).eq(s))){i=h;break}o+=4,r=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(ve(i,e+1,1),t=!i.times(i).times(i).eq(s));break}return me=!0,ve(i,e,u.rounding,t)},K.decimalPlaces=K.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-He(this.e/de))*de,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},K.dividedBy=K.div=function(e){return Oe(this,new this.constructor(e))},K.dividedToIntegerBy=K.divToInt=function(e){var t=this,n=t.constructor;return ve(Oe(t,new n(e),0,1,1),n.precision,n.rounding)},K.equals=K.eq=function(e){return this.cmp(e)===0},K.floor=function(){return ve(new this.constructor(this),this.e+1,3)},K.greaterThan=K.gt=function(e){return this.cmp(e)>0},K.greaterThanOrEqualTo=K.gte=function(e){var t=this.cmp(e);return t==1||t===0},K.hyperbolicCosine=K.cosh=function(){var e,t,n,i,r,a=this,o=a.constructor,h=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return h;n=o.precision,i=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,r=a.d.length,r<32?(e=Math.ceil(r/3),t=(1/yt(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),a=$r(o,1,a.times(t),new o(1),!0);for(var c,l=e,s=new o(8);l--;)c=a.times(a),a=h.minus(c.times(s.minus(c.times(s))));return ve(a,o.precision=n,o.rounding=i,!0)},K.hyperbolicSine=K.sinh=function(){var e,t,n,i,r=this,a=r.constructor;if(!r.isFinite()||r.isZero())return new a(r);if(t=a.precision,n=a.rounding,a.precision=t+Math.max(r.e,r.sd())+4,a.rounding=1,i=r.d.length,i<3)r=$r(a,2,r,r,!0);else{e=1.4*Math.sqrt(i),e=e>16?16:e|0,r=r.times(1/yt(5,e)),r=$r(a,2,r,r,!0);for(var o,h=new a(5),c=new a(16),l=new a(20);e--;)o=r.times(r),r=r.times(h.plus(o.times(c.times(o).plus(l))))}return a.precision=t,a.rounding=n,ve(r,t,n,!0)},K.hyperbolicTangent=K.tanh=function(){var e,t,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(e=i.precision,t=i.rounding,i.precision=e+7,i.rounding=1,Oe(n.sinh(),n.cosh(),i.precision=e,i.rounding=t)):new i(n.s)},K.inverseCosine=K.acos=function(){var e,t=this,n=t.constructor,i=t.abs().cmp(1),r=n.precision,a=n.rounding;return i!==-1?i===0?t.isNeg()?ur(n,r,a):new n(0):new n(NaN):t.isZero()?ur(n,r+4,a).times(.5):(n.precision=r+6,n.rounding=1,t=t.asin(),e=ur(n,r+4,a).times(.5),n.precision=r,n.rounding=a,e.minus(t))},K.inverseHyperbolicCosine=K.acosh=function(){var e,t,n=this,i=n.constructor;return n.lte(1)?new i(n.eq(1)?0:NaN):n.isFinite()?(e=i.precision,t=i.rounding,i.precision=e+Math.max(Math.abs(n.e),n.sd())+4,i.rounding=1,me=!1,n=n.times(n).minus(1).sqrt().plus(n),me=!0,i.precision=e,i.rounding=t,n.ln()):new i(n)},K.inverseHyperbolicSine=K.asinh=function(){var e,t,n=this,i=n.constructor;return!n.isFinite()||n.isZero()?new i(n):(e=i.precision,t=i.rounding,i.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,i.rounding=1,me=!1,n=n.times(n).plus(1).sqrt().plus(n),me=!0,i.precision=e,i.rounding=t,n.ln())},K.inverseHyperbolicTangent=K.atanh=function(){var e,t,n,i,r=this,a=r.constructor;return r.isFinite()?r.e>=0?new a(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(e=a.precision,t=a.rounding,i=r.sd(),Math.max(i,e)<2*-r.e-1?ve(new a(r),e,t,!0):(a.precision=n=i-r.e,r=Oe(r.plus(1),new a(1).minus(r),n+e,1),a.precision=e+4,a.rounding=1,r=r.ln(),a.precision=e,a.rounding=t,r.times(.5))):new a(NaN)},K.inverseSine=K.asin=function(){var e,t,n,i,r=this,a=r.constructor;return r.isZero()?new a(r):(t=r.abs().cmp(1),n=a.precision,i=a.rounding,t!==-1?t===0?(e=ur(a,n+4,i).times(.5),e.s=r.s,e):new a(NaN):(a.precision=n+6,a.rounding=1,r=r.div(new a(1).minus(r.times(r)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=i,r.times(2)))},K.inverseTangent=K.atan=function(){var e,t,n,i,r,a,o,h,c,l=this,s=l.constructor,u=s.precision,f=s.rounding;if(l.isFinite()){if(l.isZero())return new s(l);if(l.abs().eq(1)&&u+4<=Jt)return o=ur(s,u+4,f).times(.25),o.s=l.s,o}else{if(!l.s)return new s(NaN);if(u+4<=Jt)return o=ur(s,u+4,f).times(.5),o.s=l.s,o}for(s.precision=h=u+10,s.rounding=1,n=Math.min(28,h/de+2|0),e=n;e;--e)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(me=!1,t=Math.ceil(h/de),i=1,c=l.times(l),o=new s(l),r=l;e!==-1;)if(r=r.times(c),a=o.minus(r.div(i+=2)),r=r.times(c),o=a.plus(r.div(i+=2)),o.d[t]!==void 0)for(e=t;o.d[e]===a.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),me=!0,ve(o,s.precision=u,s.rounding=f,!0)},K.isFinite=function(){return!!this.d},K.isInteger=K.isInt=function(){return!!this.d&&He(this.e/de)>this.d.length-2},K.isNaN=function(){return!this.s},K.isNegative=K.isNeg=function(){return this.s<0},K.isPositive=K.isPos=function(){return this.s>0},K.isZero=function(){return!!this.d&&this.d[0]===0},K.lessThan=K.lt=function(e){return this.cmp(e)<0},K.lessThanOrEqualTo=K.lte=function(e){return this.cmp(e)<1},K.logarithm=K.log=function(e){var t,n,i,r,a,o,h,c,l=this,s=l.constructor,u=s.precision,f=s.rounding,d=5;if(e==null)e=new s(10),t=!0;else{if(e=new s(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new s(NaN);t=e.eq(10)}if(n=l.d,l.s<0||!n||!n[0]||l.eq(1))return new s(n&&!n[0]?-1/0:l.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)a=!0;else{for(r=n[0];r%10===0;)r/=10;a=r!==1}if(me=!1,h=u+d,o=Fr(l,h),i=t?Dt(s,h+10):Fr(e,h),c=Oe(o,i,h,1),Qr(c.d,r=u,f))do if(h+=10,o=Fr(l,h),i=t?Dt(s,h+10):Fr(e,h),c=Oe(o,i,h,1),!a){+Je(c.d).slice(r+1,r+15)+1==1e14&&(c=ve(c,u+1,0));break}while(Qr(c.d,r+=10,f));return me=!0,ve(c,u,f)},K.minus=K.sub=function(e){var t,n,i,r,a,o,h,c,l,s,u,f,d=this,D=d.constructor;if(e=new D(e),!d.d||!e.d)return!d.s||!e.s?e=new D(NaN):d.d?e.s=-e.s:e=new D(e.d||d.s!==e.s?d:NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(l=d.d,f=e.d,h=D.precision,c=D.rounding,!l[0]||!f[0]){if(f[0])e.s=-e.s;else if(l[0])e=new D(d);else return new D(c===3?-0:0);return me?ve(e,h,c):e}if(n=He(e.e/de),s=He(d.e/de),l=l.slice(),a=s-n,a){for(u=a<0,u?(t=l,a=-a,o=f.length):(t=f,n=s,o=l.length),i=Math.max(Math.ceil(h/de),o)+2,a>i&&(a=i,t.length=1),t.reverse(),i=a;i--;)t.push(0);t.reverse()}else{for(i=l.length,o=f.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=f[i]){u=l[i]<f[i];break}a=0}for(u&&(t=l,l=f,f=t,e.s=-e.s),o=l.length,i=f.length-o;i>0;--i)l[o++]=0;for(i=f.length;i>a;){if(l[--i]<f[i]){for(r=i;r&&l[--r]===0;)l[r]=ar-1;--l[r],l[i]+=ar}l[i]-=f[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=gt(l,n),me?ve(e,h,c):e):new D(c===3?-0:0)},K.modulo=K.mod=function(e){var t,n=this,i=n.constructor;return e=new i(e),!n.d||!e.s||e.d&&!e.d[0]?new i(NaN):!e.d||n.d&&!n.d[0]?ve(new i(n),i.precision,i.rounding):(me=!1,i.modulo==9?(t=Oe(n,e.abs(),0,3,1),t.s*=e.s):t=Oe(n,e,0,i.modulo,1),t=t.times(e),me=!0,n.minus(t))},K.naturalExponential=K.exp=function(){return Qt(this)},K.naturalLogarithm=K.ln=function(){return Fr(this)},K.negated=K.neg=function(){var e=new this.constructor(this);return e.s=-e.s,ve(e)},K.plus=K.add=function(e){var t,n,i,r,a,o,h,c,l,s,u=this,f=u.constructor;if(e=new f(e),!u.d||!e.d)return!u.s||!e.s?e=new f(NaN):u.d||(e=new f(e.d||u.s===e.s?u:NaN)),e;if(u.s!=e.s)return e.s=-e.s,u.minus(e);if(l=u.d,s=e.d,h=f.precision,c=f.rounding,!l[0]||!s[0])return s[0]||(e=new f(u)),me?ve(e,h,c):e;if(a=He(u.e/de),i=He(e.e/de),l=l.slice(),r=a-i,r){for(r<0?(n=l,r=-r,o=s.length):(n=s,i=a,o=l.length),a=Math.ceil(h/de),o=a>o?a+1:o+1,r>o&&(r=o,n.length=1),n.reverse();r--;)n.push(0);n.reverse()}for(o=l.length,r=s.length,o-r<0&&(r=o,n=s,s=l,l=n),t=0;r;)t=(l[--r]=l[r]+s[r]+t)/ar|0,l[r]%=ar;for(t&&(l.unshift(t),++i),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=gt(l,i),me?ve(e,h,c):e},K.precision=K.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ar+e);return n.d?(t=Un(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},K.round=function(){var e=this,t=e.constructor;return ve(new t(e),e.e+1,t.rounding)},K.sine=K.sin=function(){var e,t,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(e=i.precision,t=i.rounding,i.precision=e+Math.max(n.e,n.sd())+de,i.rounding=1,n=Qu(i,Jn(i,n)),i.precision=e,i.rounding=t,ve(pr>2?n.neg():n,e,t,!0)):new i(NaN)},K.squareRoot=K.sqrt=function(){var e,t,n,i,r,a,o=this,h=o.d,c=o.e,l=o.s,s=o.constructor;if(l!==1||!h||!h[0])return new s(!l||l<0&&(!h||h[0])?NaN:h?o:1/0);for(me=!1,l=Math.sqrt(+o),l==0||l==1/0?(t=Je(h),(t.length+c)%2==0&&(t+="0"),l=Math.sqrt(t),c=He((c+1)/2)-(c<0||c%2),l==1/0?t="5e"+c:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),i=new s(t)):i=new s(l.toString()),n=(c=s.precision)+3;;)if(a=i,i=a.plus(Oe(o,a,n+2,1)).times(.5),Je(a.d).slice(0,n)===(t=Je(i.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!r&&t=="4999"){if(!r&&(ve(a,c+1,0),a.times(a).eq(o))){i=a;break}n+=4,r=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(ve(i,c+1,1),e=!i.times(i).eq(o));break}return me=!0,ve(i,c,s.rounding,e)},K.tangent=K.tan=function(){var e,t,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(e=i.precision,t=i.rounding,i.precision=e+10,i.rounding=1,n=n.sin(),n.s=1,n=Oe(n,new i(1).minus(n.times(n)).sqrt(),e+10,0),i.precision=e,i.rounding=t,ve(pr==2||pr==4?n.neg():n,e,t,!0)):new i(NaN)},K.times=K.mul=function(e){var t,n,i,r,a,o,h,c,l,s=this,u=s.constructor,f=s.d,d=(e=new u(e)).d;if(e.s*=s.s,!f||!f[0]||!d||!d[0])return new u(!e.s||f&&!f[0]&&!d||d&&!d[0]&&!f?NaN:!f||!d?e.s/0:e.s*0);for(n=He(s.e/de)+He(e.e/de),c=f.length,l=d.length,c<l&&(a=f,f=d,d=a,o=c,c=l,l=o),a=[],o=c+l,i=o;i--;)a.push(0);for(i=l;--i>=0;){for(t=0,r=c+i;r>i;)h=a[r]+d[i]*f[r-i-1]+t,a[r--]=h%ar|0,t=h/ar|0;a[r]=(a[r]+t)%ar|0}for(;!a[--o];)a.pop();return t?++n:a.shift(),e.d=a,e.e=gt(a,n),me?ve(e,u.precision,u.rounding):e},K.toBinary=function(e,t){return Ht(this,2,e,t)},K.toDecimalPlaces=K.toDP=function(e,t){var n=this,i=n.constructor;return n=new i(n),e===void 0?n:(je(e,0,wr),t===void 0?t=i.rounding:je(t,0,8),ve(n,e+n.e+1,t))},K.toExponential=function(e,t){var n,i=this,r=i.constructor;return e===void 0?n=vr(i,!0):(je(e,0,wr),t===void 0?t=r.rounding:je(t,0,8),i=ve(new r(i),e+1,t),n=vr(i,!0,e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},K.toFixed=function(e,t){var n,i,r=this,a=r.constructor;return e===void 0?n=vr(r):(je(e,0,wr),t===void 0?t=a.rounding:je(t,0,8),i=ve(new a(r),e+r.e+1,t),n=vr(i,!1,e+i.e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},K.toFraction=function(e){var t,n,i,r,a,o,h,c,l,s,u,f,d=this,D=d.d,v=d.constructor;if(!D)return new v(d);if(l=n=new v(1),i=c=new v(0),t=new v(i),a=t.e=Un(D)-d.e-1,o=a%de,t.d[0]=Ve(10,o<0?de+o:o),e==null)e=a>0?t:l;else{if(h=new v(e),!h.isInt()||h.lt(l))throw Error(Ar+h);e=h.gt(t)?a>0?t:l:h}for(me=!1,h=new v(Je(D)),s=v.precision,v.precision=a=D.length*de*2;u=Oe(h,t,0,1,1),r=n.plus(u.times(i)),r.cmp(e)!=1;)n=i,i=r,r=l,l=c.plus(u.times(r)),c=r,r=t,t=h.minus(u.times(r)),h=r;return r=Oe(e.minus(n),i,0,1,1),c=c.plus(r.times(l)),n=n.plus(r.times(i)),c.s=l.s=d.s,f=Oe(l,i,a,1).minus(d).abs().cmp(Oe(c,n,a,1).minus(d).abs())<1?[l,i]:[c,n],v.precision=s,me=!0,f},K.toHexadecimal=K.toHex=function(e,t){return Ht(this,16,e,t)},K.toNearest=function(e,t){var n=this,i=n.constructor;if(n=new i(n),e==null){if(!n.d)return n;e=new i(1),t=i.rounding}else{if(e=new i(e),t===void 0?t=i.rounding:je(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(me=!1,n=Oe(n,e,0,t,1).times(e),me=!0,ve(n)):(e.s=n.s,n=e),n},K.toNumber=function(){return+this},K.toOctal=function(e,t){return Ht(this,8,e,t)},K.toPower=K.pow=function(e){var t,n,i,r,a,o,h=this,c=h.constructor,l=+(e=new c(e));if(!h.d||!e.d||!h.d[0]||!e.d[0])return new c(Ve(+h,l));if(h=new c(h),h.eq(1))return h;if(i=c.precision,a=c.rounding,e.eq(1))return ve(h,i,a);if(t=He(e.e/de),t>=e.d.length-1&&(n=l<0?-l:l)<=Zu)return r=Vn(c,h,n,i),e.s<0?new c(1).div(r):ve(r,i,a);if(o=h.s,o<0){if(t<e.d.length-1)return new c(NaN);if(e.d[t]&1||(o=1),h.e==0&&h.d[0]==1&&h.d.length==1)return h.s=o,h}return n=Ve(+h,l),t=n==0||!isFinite(n)?He(l*(Math.log("0."+Je(h.d))/Math.LN10+h.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?o/0:0):(me=!1,c.rounding=h.s=1,n=Math.min(12,(t+"").length),r=Qt(e.times(Fr(h,i+n)),i),r.d&&(r=ve(r,i+5,1),Qr(r.d,i,a)&&(t=i+10,r=ve(Qt(e.times(Fr(h,t+n)),t),t+5,1),+Je(r.d).slice(i+1,i+15)+1==1e14&&(r=ve(r,i+1,0)))),r.s=o,me=!0,c.rounding=a,ve(r,i,a))},K.toPrecision=function(e,t){var n,i=this,r=i.constructor;return e===void 0?n=vr(i,i.e<=r.toExpNeg||i.e>=r.toExpPos):(je(e,1,wr),t===void 0?t=r.rounding:je(t,0,8),i=ve(new r(i),e,t),n=vr(i,e<=i.e||i.e<=r.toExpNeg,e)),i.isNeg()&&!i.isZero()?"-"+n:n},K.toSignificantDigits=K.toSD=function(e,t){var n=this,i=n.constructor;return e===void 0?(e=i.precision,t=i.rounding):(je(e,1,wr),t===void 0?t=i.rounding:je(t,0,8)),ve(new i(n),e,t)},K.toString=function(){var e=this,t=e.constructor,n=vr(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},K.truncated=K.trunc=function(){return ve(new this.constructor(this),this.e+1,1)},K.valueOf=K.toJSON=function(){var e=this,t=e.constructor,n=vr(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function Je(e){var t,n,i,r=e.length-1,a="",o=e[0];if(r>0){for(a+=o,t=1;t<r;t++)i=e[t]+"",n=de-i.length,n&&(a+=Er(n)),a+=i;o=e[t],i=o+"",n=de-i.length,n&&(a+=Er(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function je(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ar+e)}function Qr(e,t,n,i){var r,a,o,h;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=de,r=0):(r=Math.ceil((t+1)/de),t%=de),a=Ve(10,de-t),h=e[r]%a|0,i==null?t<3?(t==0?h=h/100|0:t==1&&(h=h/10|0),o=n<4&&h==99999||n>3&&h==49999||h==5e4||h==0):o=(n<4&&h+1==a||n>3&&h+1==a/2)&&(e[r+1]/a/100|0)==Ve(10,t-2)-1||(h==a/2||h==0)&&(e[r+1]/a/100|0)==0:t<4?(t==0?h=h/1e3|0:t==1?h=h/100|0:t==2&&(h=h/10|0),o=(i||n<4)&&h==9999||!i&&n>3&&h==4999):o=((i||n<4)&&h+1==a||!i&&n>3&&h+1==a/2)&&(e[r+1]/a/1e3|0)==Ve(10,t-3)-1,o}function mt(e,t,n){for(var i,r=[0],a,o=0,h=e.length;o<h;){for(a=r.length;a--;)r[a]*=t;for(r[0]+=Gt.indexOf(e.charAt(o++)),i=0;i<r.length;i++)r[i]>n-1&&(r[i+1]===void 0&&(r[i+1]=0),r[i+1]+=r[i]/n|0,r[i]%=n)}return r.reverse()}function Yu(e,t){var n,i,r;if(t.isZero())return t;i=t.d.length,i<32?(n=Math.ceil(i/3),r=(1/yt(4,n)).toString()):(n=16,r="2.3283064365386962890625e-10"),e.precision+=n,t=$r(e,1,t.times(r),new e(1));for(var a=n;a--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}var Oe=function(){function e(i,r,a){var o,h=0,c=i.length;for(i=i.slice();c--;)o=i[c]*r+h,i[c]=o%a|0,h=o/a|0;return h&&i.unshift(h),i}function t(i,r,a,o){var h,c;if(a!=o)c=a>o?1:-1;else for(h=c=0;h<a;h++)if(i[h]!=r[h]){c=i[h]>r[h]?1:-1;break}return c}function n(i,r,a,o){for(var h=0;a--;)i[a]-=h,h=i[a]<r[a]?1:0,i[a]=h*o+i[a]-r[a];for(;!i[0]&&i.length>1;)i.shift()}return function(i,r,a,o,h,c){var l,s,u,f,d,D,v,m,p,w,g,A,F,y,C,b,E,S,M,N,O=i.constructor,T=i.s==r.s?1:-1,I=i.d,B=r.d;if(!I||!I[0]||!B||!B[0])return new O(!i.s||!r.s||(I?B&&I[0]==B[0]:!B)?NaN:I&&I[0]==0||!B?T*0:T/0);for(c?(d=1,s=i.e-r.e):(c=ar,d=de,s=He(i.e/d)-He(r.e/d)),M=B.length,E=I.length,p=new O(T),w=p.d=[],u=0;B[u]==(I[u]||0);u++);if(B[u]>(I[u]||0)&&s--,a==null?(y=a=O.precision,o=O.rounding):h?y=a+(i.e-r.e)+1:y=a,y<0)w.push(1),D=!0;else{if(y=y/d+2|0,u=0,M==1){for(f=0,B=B[0],y++;(u<E||f)&&y--;u++)C=f*c+(I[u]||0),w[u]=C/B|0,f=C%B|0;D=f||u<E}else{for(f=c/(B[0]+1)|0,f>1&&(B=e(B,f,c),I=e(I,f,c),M=B.length,E=I.length),b=M,g=I.slice(0,M),A=g.length;A<M;)g[A++]=0;N=B.slice(),N.unshift(0),S=B[0],B[1]>=c/2&&++S;do f=0,l=t(B,g,M,A),l<0?(F=g[0],M!=A&&(F=F*c+(g[1]||0)),f=F/S|0,f>1?(f>=c&&(f=c-1),v=e(B,f,c),m=v.length,A=g.length,l=t(v,g,m,A),l==1&&(f--,n(v,M<m?N:B,m,c))):(f==0&&(l=f=1),v=B.slice()),m=v.length,m<A&&v.unshift(0),n(g,v,A,c),l==-1&&(A=g.length,l=t(B,g,M,A),l<1&&(f++,n(g,M<A?N:B,A,c))),A=g.length):l===0&&(f++,g=[0]),w[u++]=f,l&&g[0]?g[A++]=I[b]||0:(g=[I[b]],A=1);while((b++<E||g[0]!==void 0)&&y--);D=g[0]!==void 0}w[0]||w.shift()}if(d==1)p.e=s,Ln=D;else{for(u=1,f=w[0];f>=10;f/=10)u++;p.e=u+s*d-1,ve(p,h?a+p.e+1:a,o,D)}return p}}();function ve(e,t,n,i){var r,a,o,h,c,l,s,u,f,d=e.constructor;e:if(t!=null){if(u=e.d,!u)return e;for(r=1,h=u[0];h>=10;h/=10)r++;if(a=t-r,a<0)a+=de,o=t,s=u[f=0],c=s/Ve(10,r-o-1)%10|0;else if(f=Math.ceil((a+1)/de),h=u.length,f>=h)if(i){for(;h++<=f;)u.push(0);s=c=0,r=1,a%=de,o=a-de+1}else break e;else{for(s=h=u[f],r=1;h>=10;h/=10)r++;a%=de,o=a-de+r,c=o<0?0:s/Ve(10,r-o-1)%10|0}if(i=i||t<0||u[f+1]!==void 0||(o<0?s:s%Ve(10,r-o-1)),l=n<4?(c||i)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||i||n==6&&(a>0?o>0?s/Ve(10,r-o):0:u[f-1])%10&1||n==(e.s<0?8:7)),t<1||!u[0])return u.length=0,l?(t-=e.e+1,u[0]=Ve(10,(de-t%de)%de),e.e=-t||0):u[0]=e.e=0,e;if(a==0?(u.length=f,h=1,f--):(u.length=f+1,h=Ve(10,de-a),u[f]=o>0?(s/Ve(10,r-o)%Ve(10,o)|0)*h:0),l)for(;;)if(f==0){for(a=1,o=u[0];o>=10;o/=10)a++;for(o=u[0]+=h,h=1;o>=10;o/=10)h++;a!=h&&(e.e++,u[0]==ar&&(u[0]=1));break}else{if(u[f]+=h,u[f]!=ar)break;u[f--]=0,h=1}for(a=u.length;u[--a]===0;)u.pop()}return me&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function vr(e,t,n){if(!e.isFinite())return Yn(e);var i,r=e.e,a=Je(e.d),o=a.length;return t?(n&&(i=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+Er(i):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):r<0?(a="0."+Er(-r-1)+a,n&&(i=n-o)>0&&(a+=Er(i))):r>=o?(a+=Er(r+1-o),n&&(i=n-r-1)>0&&(a=a+"."+Er(i))):((i=r+1)<o&&(a=a.slice(0,i)+"."+a.slice(i)),n&&(i=n-o)>0&&(r+1===o&&(a+="."),a+=Er(i))),a}function gt(e,t){var n=e[0];for(t*=de;n>=10;n/=10)t++;return t}function Dt(e,t,n){if(t>Gu)throw me=!0,n&&(e.precision=n),Error($n);return ve(new e(vt),t,1,!0)}function ur(e,t,n){if(t>Jt)throw Error($n);return ve(new e(dt),t,n,!0)}function Un(e){var t=e.length-1,n=t*de+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function Er(e){for(var t="";e--;)t+="0";return t}function Vn(e,t,n,i){var r,a=new e(1),o=Math.ceil(i/de+4);for(me=!1;;){if(n%2&&(a=a.times(t),Qn(a.d,o)&&(r=!0)),n=He(n/2),n===0){n=a.d.length-1,r&&a.d[n]===0&&++a.d[n];break}t=t.times(t),Qn(t.d,o)}return me=!0,a}function Zn(e){return e.d[e.d.length-1]&1}function Gn(e,t,n){for(var i,r=new e(t[0]),a=0;++a<t.length;)if(i=new e(t[a]),i.s)r[n](i)&&(r=i);else{r=i;break}return r}function Qt(e,t){var n,i,r,a,o,h,c,l=0,s=0,u=0,f=e.constructor,d=f.rounding,D=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(t==null?(me=!1,c=D):c=t,h=new f(.03125);e.e>-2;)e=e.times(h),u+=5;for(i=Math.log(Ve(2,u))/Math.LN10*2+5|0,c+=i,n=a=o=new f(1),f.precision=c;;){if(a=ve(a.times(e),c,1),n=n.times(++s),h=o.plus(Oe(a,n,c,1)),Je(h.d).slice(0,c)===Je(o.d).slice(0,c)){for(r=u;r--;)o=ve(o.times(o),c,1);if(t==null)if(l<3&&Qr(o.d,c-i,d,l))f.precision=c+=10,n=a=h=new f(1),s=0,l++;else return ve(o,f.precision=D,d,me=!0);else return f.precision=D,o}o=h}}function Fr(e,t){var n,i,r,a,o,h,c,l,s,u,f,d=1,D=10,v=e,m=v.d,p=v.constructor,w=p.rounding,g=p.precision;if(v.s<0||!m||!m[0]||!v.e&&m[0]==1&&m.length==1)return new p(m&&!m[0]?-1/0:v.s!=1?NaN:m?0:v);if(t==null?(me=!1,s=g):s=t,p.precision=s+=D,n=Je(m),i=n.charAt(0),Math.abs(a=v.e)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)v=v.times(e),n=Je(v.d),i=n.charAt(0),d++;a=v.e,i>1?(v=new p("0."+n),a++):v=new p(i+"."+n.slice(1))}else return l=Dt(p,s+2,g).times(a+""),v=Fr(new p(i+"."+n.slice(1)),s-D).plus(l),p.precision=g,t==null?ve(v,g,w,me=!0):v;for(u=v,c=o=v=Oe(v.minus(1),v.plus(1),s,1),f=ve(v.times(v),s,1),r=3;;){if(o=ve(o.times(f),s,1),l=c.plus(Oe(o,new p(r),s,1)),Je(l.d).slice(0,s)===Je(c.d).slice(0,s))if(c=c.times(2),a!==0&&(c=c.plus(Dt(p,s+2,g).times(a+""))),c=Oe(c,new p(d),s,1),t==null)if(Qr(c.d,s-D,w,h))p.precision=s+=D,l=o=v=Oe(u.minus(1),u.plus(1),s,1),f=ve(v.times(v),s,1),r=h=1;else return ve(c,p.precision=g,w,me=!0);else return p.precision=g,c;c=l,r+=2}}function Yn(e){return String(e.s*e.s/0)}function Xt(e,t){var n,i,r;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length),i=0;t.charCodeAt(i)===48;i++);for(r=t.length;t.charCodeAt(r-1)===48;--r);if(t=t.slice(i,r),t){if(r-=i,e.e=n=n-i-1,e.d=[],i=(n+1)%de,n<0&&(i+=de),i<r){for(i&&e.d.push(+t.slice(0,i)),r-=de;i<r;)e.d.push(+t.slice(i,i+=de));t=t.slice(i),i=de-t.length}else i-=r;for(;i--;)t+="0";e.d.push(+t),me&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Ju(e,t){var n,i,r,a,o,h,c,l,s;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Rn.test(t))return Xt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Uu.test(t))n=16,t=t.toLowerCase();else if(Ru.test(t))n=2;else if(Vu.test(t))n=8;else throw Error(Ar+t);for(a=t.search(/p/i),a>0?(c=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),a=t.indexOf("."),o=a>=0,i=e.constructor,o&&(t=t.replace(".",""),h=t.length,a=h-a,r=Vn(i,new i(n),a,a*2)),l=mt(t,n,ar),s=l.length-1,a=s;l[a]===0;--a)l.pop();return a<0?new i(e.s*0):(e.e=gt(l,s),e.d=l,me=!1,o&&(e=Oe(e,r,h*4)),c&&(e=e.times(Math.abs(c)<54?Ve(2,c):qr.pow(2,c))),me=!0,e)}function Qu(e,t){var n,i=t.d.length;if(i<3)return t.isZero()?t:$r(e,2,t,t);n=1.4*Math.sqrt(i),n=n>16?16:n|0,t=t.times(1/yt(5,n)),t=$r(e,2,t,t);for(var r,a=new e(5),o=new e(16),h=new e(20);n--;)r=t.times(t),t=t.times(a.plus(r.times(o.times(r).minus(h))));return t}function $r(e,t,n,i,r){var a,o,h,c,l=e.precision,s=Math.ceil(l/de);for(me=!1,c=n.times(n),h=new e(i);;){if(o=Oe(h.times(c),new e(t++*t++),l,1),h=r?i.plus(o):i.minus(o),i=Oe(o.times(c),new e(t++*t++),l,1),o=h.plus(i),o.d[s]!==void 0){for(a=s;o.d[a]===h.d[a]&&a--;);if(a==-1)break}a=h,h=i,i=o,o=a}return me=!0,o.d.length=s+1,o}function yt(e,t){for(var n=e;--t;)n*=e;return n}function Jn(e,t){var n,i=t.s<0,r=ur(e,e.precision,1),a=r.times(.5);if(t=t.abs(),t.lte(a))return pr=i?4:1,t;if(n=t.divToInt(r),n.isZero())pr=i?3:2;else{if(t=t.minus(n.times(r)),t.lte(a))return pr=Zn(n)?i?2:3:i?4:1,t;pr=Zn(n)?i?1:4:i?3:2}return t.minus(r).abs()}function Ht(e,t,n,i){var r,a,o,h,c,l,s,u,f,d=e.constructor,D=n!==void 0;if(D?(je(n,1,wr),i===void 0?i=d.rounding:je(i,0,8)):(n=d.precision,i=d.rounding),!e.isFinite())s=Yn(e);else{for(s=vr(e),o=s.indexOf("."),D?(r=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):r=t,o>=0&&(s=s.replace(".",""),f=new d(1),f.e=s.length-o,f.d=mt(vr(f),10,r),f.e=f.d.length),u=mt(s,10,r),a=c=u.length;u[--c]==0;)u.pop();if(!u[0])s=D?"0p+0":"0";else{if(o<0?a--:(e=new d(e),e.d=u,e.e=a,e=Oe(e,f,n,i,0,r),u=e.d,a=e.e,l=Ln),o=u[n],h=r/2,l=l||u[n+1]!==void 0,l=i<4?(o!==void 0||l)&&(i===0||i===(e.s<0?3:2)):o>h||o===h&&(i===4||l||i===6&&u[n-1]&1||i===(e.s<0?8:7)),u.length=n,l)for(;++u[--n]>r-1;)u[n]=0,n||(++a,u.unshift(1));for(c=u.length;!u[c-1];--c);for(o=0,s="";o<c;o++)s+=Gt.charAt(u[o]);if(D){if(c>1)if(t==16||t==8){for(o=t==16?4:3,--c;c%o;c++)s+="0";for(u=mt(s,r,t),c=u.length;!u[c-1];--c);for(o=1,s="1.";o<c;o++)s+=Gt.charAt(u[o])}else s=s.charAt(0)+"."+s.slice(1);s=s+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)s="0"+s;s="0."+s}else if(++a>c)for(a-=c;a--;)s+="0";else a<c&&(s=s.slice(0,a)+"."+s.slice(a))}s=(t==16?"0x":t==2?"0b":t==8?"0o":"")+s}return e.s<0?"-"+s:s}function Qn(e,t){if(e.length>t)return e.length=t,!0}function Xu(e){return new this(e).abs()}function Hu(e){return new this(e).acos()}function Ku(e){return new this(e).acosh()}function Wu(e,t){return new this(e).plus(t)}function ku(e){return new this(e).asin()}function ju(e){return new this(e).asinh()}function eo(e){return new this(e).atan()}function ro(e){return new this(e).atanh()}function to(e,t){e=new this(e),t=new this(t);var n,i=this.precision,r=this.rounding,a=i+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=ur(this,a,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?ur(this,i,r):new this(0),n.s=e.s):!e.d||t.isZero()?(n=ur(this,a,1).times(.5),n.s=e.s):t.s<0?(this.precision=a,this.rounding=1,n=this.atan(Oe(e,t,a,1)),t=ur(this,a,1),this.precision=i,this.rounding=r,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(Oe(e,t,a,1)),n}function no(e){return new this(e).cbrt()}function io(e){return ve(e=new this(e),e.e+1,2)}function ao(e,t,n){return new this(e).clamp(t,n)}function uo(e){if(!e||typeof e!="object")throw Error(pt+"Object expected");var t,n,i,r=e.defaults===!0,a=["precision",1,wr,"rounding",0,8,"toExpNeg",-Lr,0,"toExpPos",0,Lr,"maxE",0,Lr,"minE",-Lr,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(n=a[t],r&&(this[n]=Yt[n]),(i=e[n])!==void 0)if(He(i)===i&&i>=a[t+1]&&i<=a[t+2])this[n]=i;else throw Error(Ar+n+": "+i);if(n="crypto",r&&(this[n]=Yt[n]),(i=e[n])!==void 0)if(i===!0||i===!1||i===0||i===1)if(i)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(qn);else this[n]=!1;else throw Error(Ar+n+": "+i);return this}function oo(e){return new this(e).cos()}function so(e){return new this(e).cosh()}function Xn(e){var t,n,i;function r(a){var o,h,c,l=this;if(!(l instanceof r))return new r(a);if(l.constructor=r,Hn(a)){l.s=a.s,me?!a.d||a.e>r.maxE?(l.e=NaN,l.d=null):a.e<r.minE?(l.e=0,l.d=[0]):(l.e=a.e,l.d=a.d.slice()):(l.e=a.e,l.d=a.d?a.d.slice():a.d);return}if(c=typeof a,c==="number"){if(a===0){l.s=1/a<0?-1:1,l.e=0,l.d=[0];return}if(a<0?(a=-a,l.s=-1):l.s=1,a===~~a&&a<1e7){for(o=0,h=a;h>=10;h/=10)o++;me?o>r.maxE?(l.e=NaN,l.d=null):o<r.minE?(l.e=0,l.d=[0]):(l.e=o,l.d=[a]):(l.e=o,l.d=[a]);return}else if(a*0!==0){a||(l.s=NaN),l.e=NaN,l.d=null;return}return Xt(l,a.toString())}else if(c!=="string")throw Error(Ar+a);return(h=a.charCodeAt(0))===45?(a=a.slice(1),l.s=-1):(h===43&&(a=a.slice(1)),l.s=1),Rn.test(a)?Xt(l,a):Ju(l,a)}if(r.prototype=K,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=uo,r.clone=Xn,r.isDecimal=Hn,r.abs=Xu,r.acos=Hu,r.acosh=Ku,r.add=Wu,r.asin=ku,r.asinh=ju,r.atan=eo,r.atanh=ro,r.atan2=to,r.cbrt=no,r.ceil=io,r.clamp=ao,r.cos=oo,r.cosh=so,r.div=fo,r.exp=co,r.floor=lo,r.hypot=ho,r.ln=vo,r.log=po,r.log10=go,r.log2=mo,r.max=Do,r.min=yo,r.mod=wo,r.mul=Ao,r.pow=Eo,r.random=Fo,r.round=Co,r.sign=bo,r.sin=Mo,r.sinh=So,r.sqrt=No,r.sub=xo,r.sum=Bo,r.tan=_o,r.tanh=zo,r.trunc=To,e===void 0&&(e={}),e&&e.defaults!==!0)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return r.config(e),r}function fo(e,t){return new this(e).div(t)}function co(e){return new this(e).exp()}function lo(e){return ve(e=new this(e),e.e+1,3)}function ho(){var e,t,n=new this(0);for(me=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return me=!0,new this(1/0);n=t}return me=!0,n.sqrt()}function Hn(e){return e instanceof qr||e&&e.toStringTag===Pn||!1}function vo(e){return new this(e).ln()}function po(e,t){return new this(e).log(t)}function mo(e){return new this(e).log(2)}function go(e){return new this(e).log(10)}function Do(){return Gn(this,arguments,"lt")}function yo(){return Gn(this,arguments,"gt")}function wo(e,t){return new this(e).mod(t)}function Ao(e,t){return new this(e).mul(t)}function Eo(e,t){return new this(e).pow(t)}function Fo(e){var t,n,i,r,a=0,o=new this(1),h=[];if(e===void 0?e=this.precision:je(e,1,wr),i=Math.ceil(e/de),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(i));a<i;)r=t[a],r>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:h[a++]=r%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(i*=4);a<i;)r=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((t[a+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(t,a):(h.push(r%1e7),a+=4);a=i/4}else throw Error(qn);else for(;a<i;)h[a++]=Math.random()*1e7|0;for(i=h[--a],e%=de,i&&e&&(r=Ve(10,de-e),h[a]=(i/r|0)*r);h[a]===0;a--)h.pop();if(a<0)n=0,h=[0];else{for(n=-1;h[0]===0;n-=de)h.shift();for(i=1,r=h[0];r>=10;r/=10)i++;i<de&&(n-=de-i)}return o.e=n,o.d=h,o}function Co(e){return ve(e=new this(e),e.e+1,this.rounding)}function bo(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Mo(e){return new this(e).sin()}function So(e){return new this(e).sinh()}function No(e){return new this(e).sqrt()}function xo(e,t){return new this(e).sub(t)}function Bo(){var e=0,t=arguments,n=new this(t[e]);for(me=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return me=!0,ve(n,this.precision,this.rounding)}function _o(e){return new this(e).tan()}function zo(e){return new this(e).tanh()}function To(e){return ve(e=new this(e),e.e+1,1)}K[Symbol.for("nodejs.util.inspect.custom")]=K.toString,K[Symbol.toStringTag]="Decimal";var qr=K.constructor=Xn(Yt);vt=new qr(vt),dt=new qr(dt);var Oo="BigNumber",Io=["?on","config"],Lo=j(Oo,Io,e=>{var{on:t,config:n}=e,i=qr.clone({precision:n.precision,modulo:qr.EUCLID});return i.prototype=Object.create(i.prototype),i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(r){return new i(r.value)},t&&t("config",function(r,a){r.precision!==a.precision&&i.config({precision:r.precision})}),i},{isClass:!0});function Kn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wn={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(e,t){(function(n){var i=Math.cosh||function(u){return Math.abs(u)<1e-9?1-u:(Math.exp(u)+Math.exp(-u))*.5},r=Math.sinh||function(u){return Math.abs(u)<1e-9?u:(Math.exp(u)-Math.exp(-u))*.5},a=function(u){var f=Math.PI/4;if(-f>u||u>f)return Math.cos(u)-1;var d=u*u;return d*(d*(d*(d*(d*(d*(d*(d/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},o=function(u,f){var d=Math.abs(u),D=Math.abs(f);return d<3e3&&D<3e3?Math.sqrt(d*d+D*D):(d<D?(d=D,D=u/f):D=f/u,d*Math.sqrt(1+D*D))},h=function(){throw SyntaxError("Invalid Param")};function c(u,f){var d=Math.abs(u),D=Math.abs(f);return u===0?Math.log(D):f===0?Math.log(d):d<3e3&&D<3e3?Math.log(u*u+f*f)*.5:(u=u/2,f=f/2,.5*Math.log(u*u+f*f)+Math.LN2)}var l=function(u,f){var d={re:0,im:0};if(u==null)d.re=d.im=0;else if(f!==void 0)d.re=u,d.im=f;else switch(typeof u){case"object":if("im"in u&&"re"in u)d.re=u.re,d.im=u.im;else if("abs"in u&&"arg"in u){if(!Number.isFinite(u.abs)&&Number.isFinite(u.arg))return s.INFINITY;d.re=u.abs*Math.cos(u.arg),d.im=u.abs*Math.sin(u.arg)}else if("r"in u&&"phi"in u){if(!Number.isFinite(u.r)&&Number.isFinite(u.phi))return s.INFINITY;d.re=u.r*Math.cos(u.phi),d.im=u.r*Math.sin(u.phi)}else u.length===2?(d.re=u[0],d.im=u[1]):h();break;case"string":d.im=d.re=0;var D=u.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),v=1,m=0;D===null&&h();for(var p=0;p<D.length;p++){var w=D[p];w===" "||w==="	"||w===`
`||(w==="+"?v++:w==="-"?m++:w==="i"||w==="I"?(v+m===0&&h(),D[p+1]!==" "&&!isNaN(D[p+1])?(d.im+=parseFloat((m%2?"-":"")+D[p+1]),p++):d.im+=parseFloat((m%2?"-":"")+"1"),v=m=0):((v+m===0||isNaN(w))&&h(),D[p+1]==="i"||D[p+1]==="I"?(d.im+=parseFloat((m%2?"-":"")+w),p++):d.re+=parseFloat((m%2?"-":"")+w),v=m=0))}v+m>0&&h();break;case"number":d.im=0,d.re=u;break;default:h()}return isNaN(d.re)||isNaN(d.im),d};function s(u,f){if(!(this instanceof s))return new s(u,f);var d=l(u,f);this.re=d.re,this.im=d.im}s.prototype={re:0,im:0,sign:function(){var u=this.abs();return new s(this.re/u,this.im/u)},add:function(u,f){var d=new s(u,f);return this.isInfinite()&&d.isInfinite()?s.NAN:this.isInfinite()||d.isInfinite()?s.INFINITY:new s(this.re+d.re,this.im+d.im)},sub:function(u,f){var d=new s(u,f);return this.isInfinite()&&d.isInfinite()?s.NAN:this.isInfinite()||d.isInfinite()?s.INFINITY:new s(this.re-d.re,this.im-d.im)},mul:function(u,f){var d=new s(u,f);return this.isInfinite()&&d.isZero()||this.isZero()&&d.isInfinite()?s.NAN:this.isInfinite()||d.isInfinite()?s.INFINITY:d.im===0&&this.im===0?new s(this.re*d.re,0):new s(this.re*d.re-this.im*d.im,this.re*d.im+this.im*d.re)},div:function(u,f){var d=new s(u,f);if(this.isZero()&&d.isZero()||this.isInfinite()&&d.isInfinite())return s.NAN;if(this.isInfinite()||d.isZero())return s.INFINITY;if(this.isZero()||d.isInfinite())return s.ZERO;u=this.re,f=this.im;var D=d.re,v=d.im,m,p;return v===0?new s(u/D,f/D):Math.abs(D)<Math.abs(v)?(p=D/v,m=D*p+v,new s((u*p+f)/m,(f*p-u)/m)):(p=v/D,m=v*p+D,new s((u+f*p)/m,(f-u*p)/m))},pow:function(u,f){var d=new s(u,f);if(u=this.re,f=this.im,d.isZero())return s.ONE;if(d.im===0){if(f===0&&u>0)return new s(Math.pow(u,d.re),0);if(u===0)switch((d.re%4+4)%4){case 0:return new s(Math.pow(f,d.re),0);case 1:return new s(0,Math.pow(f,d.re));case 2:return new s(-Math.pow(f,d.re),0);case 3:return new s(0,-Math.pow(f,d.re))}}if(u===0&&f===0&&d.re>0&&d.im>=0)return s.ZERO;var D=Math.atan2(f,u),v=c(u,f);return u=Math.exp(d.re*v-d.im*D),f=d.im*v+d.re*D,new s(u*Math.cos(f),u*Math.sin(f))},sqrt:function(){var u=this.re,f=this.im,d=this.abs(),D,v;if(u>=0){if(f===0)return new s(Math.sqrt(u),0);D=.5*Math.sqrt(2*(d+u))}else D=Math.abs(f)/Math.sqrt(2*(d-u));return u<=0?v=.5*Math.sqrt(2*(d-u)):v=Math.abs(f)/Math.sqrt(2*(d+u)),new s(D,f<0?-v:v)},exp:function(){var u=Math.exp(this.re);return this.im,new s(u*Math.cos(this.im),u*Math.sin(this.im))},expm1:function(){var u=this.re,f=this.im;return new s(Math.expm1(u)*Math.cos(f)+a(f),Math.exp(u)*Math.sin(f))},log:function(){var u=this.re,f=this.im;return new s(c(u,f),Math.atan2(f,u))},abs:function(){return o(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var u=this.re,f=this.im;return new s(Math.sin(u)*i(f),Math.cos(u)*r(f))},cos:function(){var u=this.re,f=this.im;return new s(Math.cos(u)*i(f),-Math.sin(u)*r(f))},tan:function(){var u=2*this.re,f=2*this.im,d=Math.cos(u)+i(f);return new s(Math.sin(u)/d,r(f)/d)},cot:function(){var u=2*this.re,f=2*this.im,d=Math.cos(u)-i(f);return new s(-Math.sin(u)/d,r(f)/d)},sec:function(){var u=this.re,f=this.im,d=.5*i(2*f)+.5*Math.cos(2*u);return new s(Math.cos(u)*i(f)/d,Math.sin(u)*r(f)/d)},csc:function(){var u=this.re,f=this.im,d=.5*i(2*f)-.5*Math.cos(2*u);return new s(Math.sin(u)*i(f)/d,-Math.cos(u)*r(f)/d)},asin:function(){var u=this.re,f=this.im,d=new s(f*f-u*u+1,-2*u*f).sqrt(),D=new s(d.re-f,d.im+u).log();return new s(D.im,-D.re)},acos:function(){var u=this.re,f=this.im,d=new s(f*f-u*u+1,-2*u*f).sqrt(),D=new s(d.re-f,d.im+u).log();return new s(Math.PI/2-D.im,D.re)},atan:function(){var u=this.re,f=this.im;if(u===0){if(f===1)return new s(0,1/0);if(f===-1)return new s(0,-1/0)}var d=u*u+(1-f)*(1-f),D=new s((1-f*f-u*u)/d,-2*u/d).log();return new s(-.5*D.im,.5*D.re)},acot:function(){var u=this.re,f=this.im;if(f===0)return new s(Math.atan2(1,u),0);var d=u*u+f*f;return d!==0?new s(u/d,-f/d).atan():new s(u!==0?u/0:0,f!==0?-f/0:0).atan()},asec:function(){var u=this.re,f=this.im;if(u===0&&f===0)return new s(0,1/0);var d=u*u+f*f;return d!==0?new s(u/d,-f/d).acos():new s(u!==0?u/0:0,f!==0?-f/0:0).acos()},acsc:function(){var u=this.re,f=this.im;if(u===0&&f===0)return new s(Math.PI/2,1/0);var d=u*u+f*f;return d!==0?new s(u/d,-f/d).asin():new s(u!==0?u/0:0,f!==0?-f/0:0).asin()},sinh:function(){var u=this.re,f=this.im;return new s(r(u)*Math.cos(f),i(u)*Math.sin(f))},cosh:function(){var u=this.re,f=this.im;return new s(i(u)*Math.cos(f),r(u)*Math.sin(f))},tanh:function(){var u=2*this.re,f=2*this.im,d=i(u)+Math.cos(f);return new s(r(u)/d,Math.sin(f)/d)},coth:function(){var u=2*this.re,f=2*this.im,d=i(u)-Math.cos(f);return new s(r(u)/d,-Math.sin(f)/d)},csch:function(){var u=this.re,f=this.im,d=Math.cos(2*f)-i(2*u);return new s(-2*r(u)*Math.cos(f)/d,2*i(u)*Math.sin(f)/d)},sech:function(){var u=this.re,f=this.im,d=Math.cos(2*f)+i(2*u);return new s(2*i(u)*Math.cos(f)/d,-2*r(u)*Math.sin(f)/d)},asinh:function(){var u=this.im;this.im=-this.re,this.re=u;var f=this.asin();return this.re=-this.im,this.im=u,u=f.re,f.re=-f.im,f.im=u,f},acosh:function(){var u=this.acos();if(u.im<=0){var f=u.re;u.re=-u.im,u.im=f}else{var f=u.im;u.im=-u.re,u.re=f}return u},atanh:function(){var u=this.re,f=this.im,d=u>1&&f===0,D=1-u,v=1+u,m=D*D+f*f,p=m!==0?new s((v*D-f*f)/m,(f*D+v*f)/m):new s(u!==-1?u/0:0,f!==0?f/0:0),w=p.re;return p.re=c(p.re,p.im)/2,p.im=Math.atan2(p.im,w)/2,d&&(p.im=-p.im),p},acoth:function(){var u=this.re,f=this.im;if(u===0&&f===0)return new s(0,Math.PI/2);var d=u*u+f*f;return d!==0?new s(u/d,-f/d).atanh():new s(u!==0?u/0:0,f!==0?-f/0:0).atanh()},acsch:function(){var u=this.re,f=this.im;if(f===0)return new s(u!==0?Math.log(u+Math.sqrt(u*u+1)):1/0,0);var d=u*u+f*f;return d!==0?new s(u/d,-f/d).asinh():new s(u!==0?u/0:0,f!==0?-f/0:0).asinh()},asech:function(){var u=this.re,f=this.im;if(this.isZero())return s.INFINITY;var d=u*u+f*f;return d!==0?new s(u/d,-f/d).acosh():new s(u!==0?u/0:0,f!==0?-f/0:0).acosh()},inverse:function(){if(this.isZero())return s.INFINITY;if(this.isInfinite())return s.ZERO;var u=this.re,f=this.im,d=u*u+f*f;return new s(u/d,-f/d)},conjugate:function(){return new s(this.re,-this.im)},neg:function(){return new s(-this.re,-this.im)},ceil:function(u){return u=Math.pow(10,u||0),new s(Math.ceil(this.re*u)/u,Math.ceil(this.im*u)/u)},floor:function(u){return u=Math.pow(10,u||0),new s(Math.floor(this.re*u)/u,Math.floor(this.im*u)/u)},round:function(u){return u=Math.pow(10,u||0),new s(Math.round(this.re*u)/u,Math.round(this.im*u)/u)},equals:function(u,f){var d=new s(u,f);return Math.abs(d.re-this.re)<=s.EPSILON&&Math.abs(d.im-this.im)<=s.EPSILON},clone:function(){return new s(this.re,this.im)},toString:function(){var u=this.re,f=this.im,d="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(u)<s.EPSILON&&(u=0),Math.abs(f)<s.EPSILON&&(f=0),f===0?d+u:(u!==0?(d+=u,d+=" ",f<0?(f=-f,d+="-"):d+="+",d+=" "):f<0&&(f=-f,d+="-"),f!==1&&(d+=f),d+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s.PI=new s(Math.PI,0),s.E=new s(Math.E,0),s.INFINITY=new s(1/0,1/0),s.NAN=new s(NaN,NaN),s.EPSILON=1e-15,Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Complex=s,e.exports=s})()})(Wn);var $o=Wn.exports;const Qe=Kn($o);var qo="Complex",Po=[],Ro=j(qo,Po,()=>(Object.defineProperty(Qe,"name",{value:"Complex"}),Qe.prototype.constructor=Qe,Qe.prototype.type="Complex",Qe.prototype.isComplex=!0,Qe.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Qe.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Qe.prototype.format=function(e){var t="",n=this.im,i=this.re,r=Lt(this.re,e),a=Lt(this.im,e),o=Le(e)?e:e?e.precision:null;if(o!==null){var h=Math.pow(10,-o);Math.abs(i/n)<h&&(i=0),Math.abs(n/i)<h&&(n=0)}return n===0?t=r:i===0?n===1?t="i":n===-1?t="-i":t=a+"i":n<0?n===-1?t=r+" - i":t=r+" - "+a.substring(1)+"i":n===1?t=r+" + i":t=r+" + "+a+"i",t},Qe.fromPolar=function(e){switch(arguments.length){case 1:{var t=arguments[0];if(typeof t=="object")return Qe(t);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var n=arguments[0],i=arguments[1];if(Le(n)){if(on(i)&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),Le(i))return new Qe({r:n,phi:i});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Qe.prototype.valueOf=Qe.prototype.toString,Qe.fromJSON=function(e){return new Qe(e)},Qe.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},Qe),{isClass:!0}),kn={exports:{}};/**
 * @license Fraction.js v4.3.0 20/08/2023
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2023, Robert Eisele (robert@raw.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(e,t){(function(n){var i=2e3,r={s:1,n:0,d:1};function a(p,w){if(isNaN(p=parseInt(p,10)))throw v();return p*w}function o(p,w){if(w===0)throw D();var g=Object.create(d.prototype);g.s=p<0?-1:1,p=p<0?-p:p;var A=f(p,w);return g.n=p/A,g.d=w/A,g}function h(p){for(var w={},g=p,A=2,F=4;F<=g;){for(;g%A===0;)g/=A,w[A]=(w[A]||0)+1;F+=1+2*A++}return g!==p?g>1&&(w[g]=(w[g]||0)+1):w[p]=(w[p]||0)+1,w}var c=function(p,w){var g=0,A=1,F=1,y=0,C=0,b=0,E=1,S=1,M=0,N=1,O=1,T=1,I=1e7,B;if(p!=null)if(w!==void 0){if(g=p,A=w,F=g*A,g%1!==0||A%1!==0)throw m()}else switch(typeof p){case"object":{if("d"in p&&"n"in p)g=p.n,A=p.d,"s"in p&&(g*=p.s);else if(0 in p)g=p[0],1 in p&&(A=p[1]);else throw v();F=g*A;break}case"number":{if(p<0&&(F=p,p=-p),p%1===0)g=p;else if(p>0){for(p>=1&&(S=Math.pow(10,Math.floor(1+Math.log(p)/Math.LN10)),p/=S);N<=I&&T<=I;)if(B=(M+O)/(N+T),p===B){N+T<=I?(g=M+O,A=N+T):T>N?(g=O,A=T):(g=M,A=N);break}else p>B?(M+=O,N+=T):(O+=M,T+=N),N>I?(g=O,A=T):(g=M,A=N);g*=S}else(isNaN(p)||isNaN(w))&&(A=g=NaN);break}case"string":{if(N=p.match(/\d+|./g),N===null)throw v();if(N[M]==="-"?(F=-1,M++):N[M]==="+"&&M++,N.length===M+1?C=a(N[M++],F):N[M+1]==="."||N[M]==="."?(N[M]!=="."&&(y=a(N[M++],F)),M++,(M+1===N.length||N[M+1]==="("&&N[M+3]===")"||N[M+1]==="'"&&N[M+3]==="'")&&(C=a(N[M],F),E=Math.pow(10,N[M].length),M++),(N[M]==="("&&N[M+2]===")"||N[M]==="'"&&N[M+2]==="'")&&(b=a(N[M+1],F),S=Math.pow(10,N[M+1].length)-1,M+=3)):N[M+1]==="/"||N[M+1]===":"?(C=a(N[M],F),E=a(N[M+2],1),M+=3):N[M+3]==="/"&&N[M+1]===" "&&(y=a(N[M],F),C=a(N[M+2],F),E=a(N[M+4],1),M+=5),N.length<=M){A=E*S,F=g=b+A*y+S*C;break}}default:throw v()}if(A===0)throw D();r.s=F<0?-1:1,r.n=Math.abs(g),r.d=Math.abs(A)};function l(p,w,g){for(var A=1;w>0;p=p*p%g,w>>=1)w&1&&(A=A*p%g);return A}function s(p,w){for(;w%2===0;w/=2);for(;w%5===0;w/=5);if(w===1)return 0;for(var g=10%w,A=1;g!==1;A++)if(g=g*10%w,A>i)return 0;return A}function u(p,w,g){for(var A=1,F=l(10,g,w),y=0;y<300;y++){if(A===F)return y;A=A*10%w,F=F*10%w}return 0}function f(p,w){if(!p)return w;if(!w)return p;for(;;){if(p%=w,!p)return w;if(w%=p,!w)return p}}function d(p,w){if(c(p,w),this instanceof d)p=f(r.d,r.n),this.s=r.s,this.n=r.n/p,this.d=r.d/p;else return o(r.s*r.n,r.d)}var D=function(){return new Error("Division by Zero")},v=function(){return new Error("Invalid argument")},m=function(){return new Error("Parameters must be integer")};d.prototype={s:1,n:0,d:1,abs:function(){return o(this.n,this.d)},neg:function(){return o(-this.s*this.n,this.d)},add:function(p,w){return c(p,w),o(this.s*this.n*r.d+r.s*this.d*r.n,this.d*r.d)},sub:function(p,w){return c(p,w),o(this.s*this.n*r.d-r.s*this.d*r.n,this.d*r.d)},mul:function(p,w){return c(p,w),o(this.s*r.s*this.n*r.n,this.d*r.d)},div:function(p,w){return c(p,w),o(this.s*r.s*this.n*r.d,this.d*r.n)},clone:function(){return o(this.s*this.n,this.d)},mod:function(p,w){if(isNaN(this.n)||isNaN(this.d))return new d(NaN);if(p===void 0)return o(this.s*this.n%this.d,1);if(c(p,w),r.n===0&&this.d===0)throw D();return o(this.s*(r.d*this.n)%(r.n*this.d),r.d*this.d)},gcd:function(p,w){return c(p,w),o(f(r.n,this.n)*f(r.d,this.d),r.d*this.d)},lcm:function(p,w){return c(p,w),r.n===0&&this.n===0?o(0,1):o(r.n*this.n,f(r.n,this.n)*f(r.d,this.d))},ceil:function(p){return p=Math.pow(10,p||0),isNaN(this.n)||isNaN(this.d)?new d(NaN):o(Math.ceil(p*this.s*this.n/this.d),p)},floor:function(p){return p=Math.pow(10,p||0),isNaN(this.n)||isNaN(this.d)?new d(NaN):o(Math.floor(p*this.s*this.n/this.d),p)},round:function(p){return p=Math.pow(10,p||0),isNaN(this.n)||isNaN(this.d)?new d(NaN):o(Math.round(p*this.s*this.n/this.d),p)},inverse:function(){return o(this.s*this.d,this.n)},pow:function(p,w){if(c(p,w),r.d===1)return r.s<0?o(Math.pow(this.s*this.d,r.n),Math.pow(this.n,r.n)):o(Math.pow(this.s*this.n,r.n),Math.pow(this.d,r.n));if(this.s<0)return null;var g=h(this.n),A=h(this.d),F=1,y=1;for(var C in g)if(C!=="1"){if(C==="0"){F=0;break}if(g[C]*=r.n,g[C]%r.d===0)g[C]/=r.d;else return null;F*=Math.pow(C,g[C])}for(var C in A)if(C!=="1"){if(A[C]*=r.n,A[C]%r.d===0)A[C]/=r.d;else return null;y*=Math.pow(C,A[C])}return r.s<0?o(y,F):o(F,y)},equals:function(p,w){return c(p,w),this.s*this.n*r.d===r.s*r.n*this.d},compare:function(p,w){c(p,w);var g=this.s*this.n*r.d-r.s*r.n*this.d;return(0<g)-(g<0)},simplify:function(p){if(isNaN(this.n)||isNaN(this.d))return this;p=p||.001;for(var w=this.abs(),g=w.toContinued(),A=1;A<g.length;A++){for(var F=o(g[A-1],1),y=A-2;y>=0;y--)F=F.inverse().add(g[y]);if(Math.abs(F.sub(w).valueOf())<p)return F.mul(this.s)}return this},divisible:function(p,w){return c(p,w),!(!(r.n*this.d)||this.n*r.d%(r.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(p){var w,g="",A=this.n,F=this.d;return this.s<0&&(g+="-"),F===1?g+=A:(p&&(w=Math.floor(A/F))>0&&(g+=w,g+=" ",A%=F),g+=A,g+="/",g+=F),g},toLatex:function(p){var w,g="",A=this.n,F=this.d;return this.s<0&&(g+="-"),F===1?g+=A:(p&&(w=Math.floor(A/F))>0&&(g+=w,A%=F),g+="\\frac{",g+=A,g+="}{",g+=F,g+="}"),g},toContinued:function(){var p,w=this.n,g=this.d,A=[];if(isNaN(w)||isNaN(g))return A;do A.push(Math.floor(w/g)),p=w%g,w=g,g=p;while(w!==1);return A},toString:function(p){var w=this.n,g=this.d;if(isNaN(w)||isNaN(g))return"NaN";p=p||15;var A=s(w,g),F=u(w,g,A),y=this.s<0?"-":"";if(y+=w/g|0,w%=g,w*=10,w&&(y+="."),A){for(var C=F;C--;)y+=w/g|0,w%=g,w*=10;y+="(";for(var C=A;C--;)y+=w/g|0,w%=g,w*=10;y+=")"}else for(var C=p;w&&C--;)y+=w/g|0,w%=g,w*=10;return y}},Object.defineProperty(d,"__esModule",{value:!0}),d.default=d,d.Fraction=d,e.exports=d})()})(kn);var Uo=kn.exports;const mr=Kn(Uo);var Vo="Fraction",Zo=[],Go=j(Vo,Zo,()=>(Object.defineProperty(mr,"name",{value:"Fraction"}),mr.prototype.constructor=mr,mr.prototype.type="Fraction",mr.prototype.isFraction=!0,mr.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},mr.fromJSON=function(e){return new mr(e)},mr),{isClass:!0}),Yo="Matrix",Jo=[],Qo=j(Yo,Jo,()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(t,n){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(t,n,i){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(t,n,i){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(t,n){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(t,n){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(t,n){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e},{isClass:!0});function jn(e){return Object.keys(e.signatures||{}).reduce(function(t,n){var i=(n.match(/,/g)||[]).length+1;return Math.max(t,i)},-1)}var Xo="DenseMatrix",Ho=["Matrix"],Ko=j(Xo,Ho,e=>{var{Matrix:t}=e;function n(s,u){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(u&&!nr(u))throw new Error("Invalid datatype: "+u);if(Be(s))s.type==="DenseMatrix"?(this._data=Ce(s._data),this._size=Ce(s._size),this._datatype=u||s._datatype):(this._data=s.toArray(),this._size=s.size(),this._datatype=u||s._datatype);else if(s&&Me(s.data)&&Me(s.size))this._data=s.data,this._size=s.size,En(this._data,this._size),this._datatype=u||s.datatype;else if(Me(s))this._data=l(s),this._size=qe(this._data),En(this._data,this._size),this._datatype=u;else{if(s)throw new TypeError("Unsupported type of data ("+hr(s)+")");this._data=[],this._size=[0],this._datatype=u}}n.prototype=new t,n.prototype.createDenseMatrix=function(s,u){return new n(s,u)},Object.defineProperty(n,"name",{value:"DenseMatrix"}),n.prototype.constructor=n,n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return Jr(this._data,hr)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(s,u){return new n(s,u)},n.prototype.subset=function(s,u,f){switch(arguments.length){case 1:return i(this,s);case 2:case 3:return a(this,s,u,f);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(s){if(!Me(s))throw new TypeError("Array expected");if(s.length!==this._size.length)throw new Ee(s.length,this._size.length);for(var u=0;u<s.length;u++)_e(s[u],this._size[u]);for(var f=this._data,d=0,D=s.length;d<D;d++){var v=s[d];_e(v,f.length),f=f[v]}return f},n.prototype.set=function(s,u,f){if(!Me(s))throw new TypeError("Array expected");if(s.length<this._size.length)throw new Ee(s.length,this._size.length,"<");var d,D,v,m=s.map(function(w){return w+1});c(this,m,f);var p=this._data;for(d=0,D=s.length-1;d<D;d++)v=s[d],_e(v,p.length),p=p[v];return v=s[s.length-1],_e(v,p.length),p[v]=u,this};function i(s,u){if(!ut(u))throw new TypeError("Invalid index");var f=u.isScalar();if(f)return s.get(u.min());var d=u.size();if(d.length!==s._size.length)throw new Ee(d.length,s._size.length);for(var D=u.min(),v=u.max(),m=0,p=s._size.length;m<p;m++)_e(D[m],s._size[m]),_e(v[m],s._size[m]);return new n(r(s._data,u,d.length,0),s._datatype)}function r(s,u,f,d){var D=d===f-1,v=u.dimension(d);return D?v.map(function(m){return _e(m,s.length),s[m]}).valueOf():v.map(function(m){_e(m,s.length);var p=s[m];return r(p,u,f,d+1)}).valueOf()}function a(s,u,f,d){if(!u||u.isIndex!==!0)throw new TypeError("Invalid index");var D=u.size(),v=u.isScalar(),m;if(Be(f)?(m=f.size(),f=f.valueOf()):m=qe(f),v){if(m.length!==0)throw new TypeError("Scalar expected");s.set(u.min(),f,d)}else{if(!zr(m,D))try{m.length===0?f=Bn([f],D):f=Bn(f,D),m=qe(f)}catch{}if(D.length<s._size.length)throw new Ee(D.length,s._size.length,"<");if(m.length<D.length){for(var p=0,w=0;D[p]===1&&m[p]===1;)p++;for(;D[p]===1;)w++,p++;f=Mn(f,D.length,w,m)}if(!zr(D,m))throw new Ee(D,m,">");var g=u.max().map(function(y){return y+1});c(s,g,d);var A=D.length,F=0;o(s._data,u,f,A,F)}return s}function o(s,u,f,d,D){var v=D===d-1,m=u.dimension(D);v?m.forEach(function(p,w){_e(p),s[p]=f[w[0]]}):m.forEach(function(p,w){_e(p),o(s[p],u,f[w[0]],d,D+1)})}n.prototype.resize=function(s,u,f){if(!at(s))throw new TypeError("Array or Matrix expected");var d=s.valueOf().map(v=>Array.isArray(v)&&v.length===1?v[0]:v),D=f?this.clone():this;return h(D,d,u)};function h(s,u,f){if(u.length===0){for(var d=s._data;Me(d);)d=d[0];return d}return s._size=u.slice(0),s._data=ct(s._data,s._size,f),s}n.prototype.reshape=function(s,u){var f=u?this.clone():this;f._data=Pt(f._data,s);var d=f._size.reduce((D,v)=>D*v);return f._size=Rt(s,d),f};function c(s,u,f){for(var d=s._size.slice(0),D=!1;d.length<u.length;)d.push(0),D=!0;for(var v=0,m=u.length;v<m;v++)u[v]>d[v]&&(d[v]=u[v],D=!0);D&&h(s,d,f)}n.prototype.clone=function(){var s=new n({data:Ce(this._data),size:Ce(this._size),datatype:this._datatype});return s},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(s){var u=this,f=jn(s),d=function m(p,w){return Me(p)?p.map(function(g,A){return m(g,w.concat(A))}):f===1?s(p):f===2?s(p,w):s(p,w,u)},D=d(this._data,[]),v=this._datatype!==void 0?Jr(D,hr):void 0;return new n(D,v)},n.prototype.forEach=function(s){var u=this,f=function d(D,v){Me(D)?D.forEach(function(m,p){d(m,v.concat(p))}):s(D,v,u)};f(this._data,[])},n.prototype[Symbol.iterator]=function*(){var s=function*u(f,d){if(Me(f))for(var D=0;D<f.length;D++)yield*u(f[D],d.concat(D));else yield{value:f,index:d}};yield*s(this._data,[])},n.prototype.rows=function(){var s=[],u=this.size();if(u.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var f=this._data;for(var d of f)s.push(new n([d],this._datatype));return s},n.prototype.columns=function(){var s=this,u=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var d=this._data,D=function(p){var w=d.map(g=>[g[p]]);u.push(new n(w,s._datatype))},v=0;v<f[1];v++)D(v);return u},n.prototype.toArray=function(){return Ce(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(s){return $e(this._data,s)},n.prototype.toString=function(){return $e(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(s){if(s){if(Re(s)&&(s=s.toNumber()),!Le(s)||!Te(s))throw new TypeError("The parameter k must be an integer number")}else s=0;for(var u=s>0?s:0,f=s<0?-s:0,d=this._size[0],D=this._size[1],v=Math.min(d-f,D-u),m=[],p=0;p<v;p++)m[p]=this._data[p+f][p+u];return new n({data:m,size:[v],datatype:this._datatype})},n.diagonal=function(s,u,f,d){if(!Me(s))throw new TypeError("Array expected, size parameter");if(s.length!==2)throw new Error("Only two dimensions matrix are supported");if(s=s.map(function(C){if(Re(C)&&(C=C.toNumber()),!Le(C)||!Te(C)||C<1)throw new Error("Size values must be positive integers");return C}),f){if(Re(f)&&(f=f.toNumber()),!Le(f)||!Te(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var D=f>0?f:0,v=f<0?-f:0,m=s[0],p=s[1],w=Math.min(m-v,p-D),g;if(Me(u)){if(u.length!==w)throw new Error("Invalid value array length");g=function(b){return u[b]}}else if(Be(u)){var A=u.size();if(A.length!==1||A[0]!==w)throw new Error("Invalid matrix length");g=function(b){return u.get([b])}}else g=function(){return u};d||(d=Re(g(0))?g(0).mul(0):0);var F=[];if(s.length>0){F=ct(F,s,d);for(var y=0;y<w;y++)F[y+v][y+D]=g(y)}return new n({data:F,size:[m,p]})},n.fromJSON=function(s){return new n(s)},n.prototype.swapRows=function(s,u){if(!Le(s)||!Te(s)||!Le(u)||!Te(u))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return _e(s,this._size[0]),_e(u,this._size[0]),n._swapRows(s,u,this._data),this},n._swapRows=function(s,u,f){var d=f[s];f[s]=f[u],f[u]=d};function l(s){return Be(s)?l(s.valueOf()):Me(s)?s.map(l):s}return n},{isClass:!0});function er(e,t,n){return e&&typeof e.map=="function"?e.map(function(i){return er(i,t)}):t(e)}var ei="isInteger",Wo=["typed"],ko=j(ei,Wo,e=>{var{typed:t}=e;return t(ei,{number:Te,BigNumber:function(i){return i.isInt()},Fraction:function(i){return i.d===1&&isFinite(i.n)},"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),Kt="number",wt="number, number";function ri(e){return Math.abs(e)}ri.signature=Kt;function ti(e,t){return e+t}ti.signature=wt;function ni(e,t){return e-t}ni.signature=wt;function ii(e,t){return e*t}ii.signature=wt;function ai(e){return-e}ai.signature=Kt;function Wt(e){return vu(e)}Wt.signature=Kt;function ui(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}ui.signature=wt;var oi="number";function si(e){return e>0}si.signature=oi;function fi(e){return e===0}fi.signature=oi;var ci="isPositive",jo=["typed"],es=j(ci,jo,e=>{var{typed:t}=e;return t(ci,{number:si,BigNumber:function(i){return!i.isNeg()&&!i.isZero()&&!i.isNaN()},Fraction:function(i){return i.s>0&&i.n>0},Unit:t.referToSelf(n=>i=>t.find(n,i.valueType())(i.value)),"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),li="isZero",rs=["typed"],ts=j(li,rs,e=>{var{typed:t}=e;return t(li,{number:fi,BigNumber:function(i){return i.isZero()},Complex:function(i){return i.re===0&&i.im===0},Fraction:function(i){return i.d===1&&i.n===0},Unit:t.referToSelf(n=>i=>t.find(n,i.valueType())(i.value)),"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),hi="typeOf",ns=["typed"],is=j(hi,ns,e=>{var{typed:t}=e;return t(hi,{any:hr})});function Xr(e,t,n){if(n==null)return e.eq(t);if(e.eq(t))return!0;if(e.isNaN()||t.isNaN())return!1;if(e.isFinite()&&t.isFinite()){var i=e.minus(t).abs();if(i.isZero())return!0;var r=e.constructor.max(e.abs(),t.abs());return i.lte(r.times(n))}return!1}function as(e,t,n){return yr(e.re,t.re,n)&&yr(e.im,t.im,n)}var Hr=j("compareUnits",["typed"],e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf(n=>(i,r)=>{if(!i.equalBase(r))throw new Error("Cannot compare units with different base");return t.find(n,[i.valueType(),r.valueType()])(i.value,r.value)})}}),At="equalScalar",us=["typed","config"],os=j(At,us,e=>{var{typed:t,config:n}=e,i=Hr({typed:t});return t(At,{"boolean, boolean":function(a,o){return a===o},"number, number":function(a,o){return yr(a,o,n.epsilon)},"BigNumber, BigNumber":function(a,o){return a.eq(o)||Xr(a,o,n.epsilon)},"Fraction, Fraction":function(a,o){return a.equals(o)},"Complex, Complex":function(a,o){return as(a,o,n.epsilon)}},i)});j(At,["typed","config"],e=>{var{typed:t,config:n}=e;return t(At,{"number, number":function(r,a){return yr(r,a,n.epsilon)}})});var ss="SparseMatrix",fs=["typed","equalScalar","Matrix"],cs=j(ss,fs,e=>{var{typed:t,equalScalar:n,Matrix:i}=e;function r(v,m){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(m&&!nr(m))throw new Error("Invalid datatype: "+m);if(Be(v))a(this,v,m);else if(v&&Me(v.index)&&Me(v.ptr)&&Me(v.size))this._values=v.values,this._index=v.index,this._ptr=v.ptr,this._size=v.size,this._datatype=m||v.datatype;else if(Me(v))o(this,v,m);else{if(v)throw new TypeError("Unsupported type of data ("+hr(v)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=m}}function a(v,m,p){m.type==="SparseMatrix"?(v._values=m._values?Ce(m._values):void 0,v._index=Ce(m._index),v._ptr=Ce(m._ptr),v._size=Ce(m._size),v._datatype=p||m._datatype):o(v,m.valueOf(),p||m._datatype)}function o(v,m,p){v._values=[],v._index=[],v._ptr=[],v._datatype=p;var w=m.length,g=0,A=n,F=0;if(nr(p)&&(A=t.find(n,[p,p])||n,F=t.convert(0,p)),w>0){var y=0;do{v._ptr.push(v._index.length);for(var C=0;C<w;C++){var b=m[C];if(Me(b)){if(y===0&&g<b.length&&(g=b.length),y<b.length){var E=b[y];A(E,F)||(v._values.push(E),v._index.push(C))}}else y===0&&g<1&&(g=1),A(b,F)||(v._values.push(b),v._index.push(C))}y++}while(y<g)}v._ptr.push(v._index.length),v._size=[w,g]}r.prototype=new i,r.prototype.createSparseMatrix=function(v,m){return new r(v,m)},Object.defineProperty(r,"name",{value:"SparseMatrix"}),r.prototype.constructor=r,r.prototype.type="SparseMatrix",r.prototype.isSparseMatrix=!0,r.prototype.getDataType=function(){return Jr(this._values,hr)},r.prototype.storage=function(){return"sparse"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(v,m){return new r(v,m)},r.prototype.density=function(){var v=this._size[0],m=this._size[1];return v!==0&&m!==0?this._index.length/(v*m):0},r.prototype.subset=function(v,m,p){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return h(this,v);case 2:case 3:return c(this,v,m,p);default:throw new SyntaxError("Wrong number of arguments")}};function h(v,m){if(!ut(m))throw new TypeError("Invalid index");var p=m.isScalar();if(p)return v.get(m.min());var w=m.size();if(w.length!==v._size.length)throw new Ee(w.length,v._size.length);var g,A,F,y,C=m.min(),b=m.max();for(g=0,A=v._size.length;g<A;g++)_e(C[g],v._size[g]),_e(b[g],v._size[g]);var E=v._values,S=v._index,M=v._ptr,N=m.dimension(0),O=m.dimension(1),T=[],I=[];N.forEach(function(z,V){I[z]=V[0],T[z]=!0});var B=E?[]:void 0,G=[],$=[];return O.forEach(function(z){for($.push(G.length),F=M[z],y=M[z+1];F<y;F++)g=S[F],T[g]===!0&&(G.push(I[g]),B&&B.push(E[F]))}),$.push(G.length),new r({values:B,index:G,ptr:$,size:w,datatype:v._datatype})}function c(v,m,p,w){if(!m||m.isIndex!==!0)throw new TypeError("Invalid index");var g=m.size(),A=m.isScalar(),F;if(Be(p)?(F=p.size(),p=p.toArray()):F=qe(p),A){if(F.length!==0)throw new TypeError("Scalar expected");v.set(m.min(),p,w)}else{if(g.length!==1&&g.length!==2)throw new Ee(g.length,v._size.length,"<");if(F.length<g.length){for(var y=0,C=0;g[y]===1&&F[y]===1;)y++;for(;g[y]===1;)C++,y++;p=Mn(p,g.length,C,F)}if(!zr(g,F))throw new Ee(g,F,">");if(g.length===1){var b=m.dimension(0);b.forEach(function(M,N){_e(M),v.set([M,0],p[N[0]],w)})}else{var E=m.dimension(0),S=m.dimension(1);E.forEach(function(M,N){_e(M),S.forEach(function(O,T){_e(O),v.set([M,O],p[N[0]][T[0]],w)})})}}return v}r.prototype.get=function(v){if(!Me(v))throw new TypeError("Array expected");if(v.length!==this._size.length)throw new Ee(v.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var m=v[0],p=v[1];_e(m,this._size[0]),_e(p,this._size[1]);var w=l(m,this._ptr[p],this._ptr[p+1],this._index);return w<this._ptr[p+1]&&this._index[w]===m?this._values[w]:0},r.prototype.set=function(v,m,p){if(!Me(v))throw new TypeError("Array expected");if(v.length!==this._size.length)throw new Ee(v.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var w=v[0],g=v[1],A=this._size[0],F=this._size[1],y=n,C=0;nr(this._datatype)&&(y=t.find(n,[this._datatype,this._datatype])||n,C=t.convert(0,this._datatype)),(w>A-1||g>F-1)&&(f(this,Math.max(w+1,A),Math.max(g+1,F),p),A=this._size[0],F=this._size[1]),_e(w,A),_e(g,F);var b=l(w,this._ptr[g],this._ptr[g+1],this._index);return b<this._ptr[g+1]&&this._index[b]===w?y(m,C)?s(b,g,this._values,this._index,this._ptr):this._values[b]=m:y(m,C)||u(b,w,g,m,this._values,this._index,this._ptr),this};function l(v,m,p,w){if(p-m===0)return p;for(var g=m;g<p;g++)if(w[g]===v)return g;return m}function s(v,m,p,w,g){p.splice(v,1),w.splice(v,1);for(var A=m+1;A<g.length;A++)g[A]--}function u(v,m,p,w,g,A,F){g.splice(v,0,w),A.splice(v,0,m);for(var y=p+1;y<F.length;y++)F[y]++}r.prototype.resize=function(v,m,p){if(!at(v))throw new TypeError("Array or Matrix expected");var w=v.valueOf().map(A=>Array.isArray(A)&&A.length===1?A[0]:A);if(w.length!==2)throw new Error("Only two dimensions matrix are supported");w.forEach(function(A){if(!Le(A)||!Te(A)||A<0)throw new TypeError("Invalid size, must contain positive integers (size: "+$e(w)+")")});var g=p?this.clone():this;return f(g,w[0],w[1],m)};function f(v,m,p,w){var g=w||0,A=n,F=0;nr(v._datatype)&&(A=t.find(n,[v._datatype,v._datatype])||n,F=t.convert(0,v._datatype),g=t.convert(g,v._datatype));var y=!A(g,F),C=v._size[0],b=v._size[1],E,S,M;if(p>b){for(S=b;S<p;S++)if(v._ptr[S]=v._values.length,y)for(E=0;E<C;E++)v._values.push(g),v._index.push(E);v._ptr[p]=v._values.length}else p<b&&(v._ptr.splice(p+1,b-p),v._values.splice(v._ptr[p],v._values.length),v._index.splice(v._ptr[p],v._index.length));if(b=p,m>C){if(y){var N=0;for(S=0;S<b;S++){v._ptr[S]=v._ptr[S]+N,M=v._ptr[S+1]+N;var O=0;for(E=C;E<m;E++,O++)v._values.splice(M+O,0,g),v._index.splice(M+O,0,E),N++}v._ptr[b]=v._values.length}}else if(m<C){var T=0;for(S=0;S<b;S++){v._ptr[S]=v._ptr[S]-T;var I=v._ptr[S],B=v._ptr[S+1]-T;for(M=I;M<B;M++)E=v._index[M],E>m-1&&(v._values.splice(M,1),v._index.splice(M,1),T++)}v._ptr[S]=v._values.length}return v._size[0]=m,v._size[1]=p,v}r.prototype.reshape=function(v,m){if(!Me(v))throw new TypeError("Array expected");if(v.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");v.forEach(function(z){if(!Le(z)||!Te(z)||z<=-2||z===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+$e(v)+")")});var p=this._size[0]*this._size[1];v=Rt(v,p);var w=v[0]*v[1];if(p!==w)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var g=m?this.clone():this;if(this._size[0]===v[0]&&this._size[1]===v[1])return g;for(var A=[],F=0;F<g._ptr.length;F++)for(var y=0;y<g._ptr[F+1]-g._ptr[F];y++)A.push(F);for(var C=g._values.slice(),b=g._index.slice(),E=0;E<g._index.length;E++){var S=b[E],M=A[E],N=S*g._size[1]+M;A[E]=N%v[1],b[E]=Math.floor(N/v[1])}g._values.length=0,g._index.length=0,g._ptr.length=v[1]+1,g._size=v.slice();for(var O=0;O<g._ptr.length;O++)g._ptr[O]=0;for(var T=0;T<C.length;T++){var I=b[T],B=A[T],G=C[T],$=l(I,g._ptr[B],g._ptr[B+1],g._index);u($,I,B,G,g._values,g._index,g._ptr)}return g},r.prototype.clone=function(){var v=new r({values:this._values?Ce(this._values):void 0,index:Ce(this._index),ptr:Ce(this._ptr),size:Ce(this._size),datatype:this._datatype});return v},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(v,m){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var p=this,w=this._size[0],g=this._size[1],A=jn(v),F=function(C,b,E){return A===1?v(C):A===2?v(C,[b,E]):v(C,[b,E],p)};return d(this,0,w-1,0,g-1,F,m)};function d(v,m,p,w,g,A,F){var y=[],C=[],b=[],E=n,S=0;nr(v._datatype)&&(E=t.find(n,[v._datatype,v._datatype])||n,S=t.convert(0,v._datatype));for(var M=function(q,Z,ne){q=A(q,Z,ne),E(q,S)||(y.push(q),C.push(Z))},N=w;N<=g;N++){b.push(y.length);var O=v._ptr[N],T=v._ptr[N+1];if(F)for(var I=O;I<T;I++){var B=v._index[I];B>=m&&B<=p&&M(v._values[I],B-m,N-w)}else{for(var G={},$=O;$<T;$++){var z=v._index[$];G[z]=v._values[$]}for(var V=m;V<=p;V++){var W=V in G?G[V]:0;M(W,V-m,N-w)}}}return b.push(y.length),new r({values:y,index:C,ptr:b,size:[p-m+1,g-w+1]})}r.prototype.forEach=function(v,m){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var p=this,w=this._size[0],g=this._size[1],A=0;A<g;A++){var F=this._ptr[A],y=this._ptr[A+1];if(m)for(var C=F;C<y;C++){var b=this._index[C];v(this._values[C],[b,A],p)}else{for(var E={},S=F;S<y;S++){var M=this._index[S];E[M]=this._values[S]}for(var N=0;N<w;N++){var O=N in E?E[N]:0;v(O,[N,A],p)}}}},r.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var v=this._size[1],m=0;m<v;m++)for(var p=this._ptr[m],w=this._ptr[m+1],g=p;g<w;g++){var A=this._index[g];yield{value:this._values[g],index:[A,m]}}},r.prototype.toArray=function(){return D(this._values,this._index,this._ptr,this._size,!0)},r.prototype.valueOf=function(){return D(this._values,this._index,this._ptr,this._size,!1)};function D(v,m,p,w,g){var A=w[0],F=w[1],y=[],C,b;for(C=0;C<A;C++)for(y[C]=[],b=0;b<F;b++)y[C][b]=0;for(b=0;b<F;b++)for(var E=p[b],S=p[b+1],M=E;M<S;M++)C=m[M],y[C][b]=v?g?Ce(v[M]):v[M]:1;return y}return r.prototype.format=function(v){for(var m=this._size[0],p=this._size[1],w=this.density(),g="Sparse Matrix ["+$e(m,v)+" x "+$e(p,v)+"] density: "+$e(w,v)+`
`,A=0;A<p;A++)for(var F=this._ptr[A],y=this._ptr[A+1],C=F;C<y;C++){var b=this._index[C];g+=`
    (`+$e(b,v)+", "+$e(A,v)+") ==> "+(this._values?$e(this._values[C],v):"X")}return g},r.prototype.toString=function(){return $e(this.toArray())},r.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(v){if(v){if(Re(v)&&(v=v.toNumber()),!Le(v)||!Te(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var m=v>0?v:0,p=v<0?-v:0,w=this._size[0],g=this._size[1],A=Math.min(w-p,g-m),F=[],y=[],C=[];C[0]=0;for(var b=m;b<g&&F.length<A;b++)for(var E=this._ptr[b],S=this._ptr[b+1],M=E;M<S;M++){var N=this._index[M];if(N===b-m+p){F.push(this._values[M]),y[F.length-1]=N-p;break}}return C.push(F.length),new r({values:F,index:y,ptr:C,size:[A,1]})},r.fromJSON=function(v){return new r(v)},r.diagonal=function(v,m,p,w,g){if(!Me(v))throw new TypeError("Array expected, size parameter");if(v.length!==2)throw new Error("Only two dimensions matrix are supported");if(v=v.map(function(z){if(Re(z)&&(z=z.toNumber()),!Le(z)||!Te(z)||z<1)throw new Error("Size values must be positive integers");return z}),p){if(Re(p)&&(p=p.toNumber()),!Le(p)||!Te(p))throw new TypeError("The parameter k must be an integer number")}else p=0;var A=n,F=0;nr(g)&&(A=t.find(n,[g,g])||n,F=t.convert(0,g));var y=p>0?p:0,C=p<0?-p:0,b=v[0],E=v[1],S=Math.min(b-C,E-y),M;if(Me(m)){if(m.length!==S)throw new Error("Invalid value array length");M=function(V){return m[V]}}else if(Be(m)){var N=m.size();if(N.length!==1||N[0]!==S)throw new Error("Invalid matrix length");M=function(V){return m.get([V])}}else M=function(){return m};for(var O=[],T=[],I=[],B=0;B<E;B++){I.push(O.length);var G=B-y;if(G>=0&&G<S){var $=M(G);A($,F)||(T.push(G+C),O.push($))}}return I.push(O.length),new r({values:O,index:T,ptr:I,size:[b,E]})},r.prototype.swapRows=function(v,m){if(!Le(v)||!Te(v)||!Le(m)||!Te(m))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return _e(v,this._size[0]),_e(m,this._size[0]),r._swapRows(v,m,this._size[1],this._values,this._index,this._ptr),this},r._forEachRow=function(v,m,p,w,g){for(var A=w[v],F=w[v+1],y=A;y<F;y++)g(p[y],m[y])},r._swapRows=function(v,m,p,w,g,A){for(var F=0;F<p;F++){var y=A[F],C=A[F+1],b=l(v,y,C,g),E=l(m,y,C,g);if(b<C&&E<C&&g[b]===v&&g[E]===m){if(w){var S=w[b];w[b]=w[E],w[E]=S}continue}if(b<C&&g[b]===v&&(E>=C||g[E]!==m)){var M=w?w[b]:void 0;g.splice(E,0,m),w&&w.splice(E,0,M),g.splice(E<=b?b+1:b,1),w&&w.splice(E<=b?b+1:b,1);continue}if(E<C&&g[E]===m&&(b>=C||g[b]!==v)){var N=w?w[E]:void 0;g.splice(b,0,v),w&&w.splice(b,0,N),g.splice(b<=E?E+1:E,1),w&&w.splice(b<=E?E+1:E,1)}}},r},{isClass:!0}),ls="number",hs=["typed"];function vs(e){var t=e.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(t){var n={"0b":2,"0o":8,"0x":16}[t[1]],i=t[2],r=t[3];return{input:e,radix:n,integerPart:i,fractionalPart:r}}else return null}function ds(e){for(var t=parseInt(e.integerPart,e.radix),n=0,i=0;i<e.fractionalPart.length;i++){var r=parseInt(e.fractionalPart[i],e.radix);n+=r/Math.pow(e.radix,i+1)}var a=t+n;if(isNaN(a))throw new SyntaxError('String "'+e.input+'" is not a valid number');return a}var ps=j(ls,hs,e=>{var{typed:t}=e,n=t("number",{"":function(){return 0},number:function(r){return r},string:function(r){if(r==="NaN")return NaN;var a=vs(r);if(a)return ds(a);var o=0,h=r.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);h&&(o=Number(h[2]),r=h[1]);var c=Number(r);if(isNaN(c))throw new SyntaxError('String "'+r+'" is not a valid number');if(h){if(c>2**o-1)throw new SyntaxError('String "'.concat(r,'" is out of range'));c>=2**(o-1)&&(c=c-2**o)}return c},BigNumber:function(r){return r.toNumber()},Fraction:function(r){return r.valueOf()},Unit:t.referToSelf(i=>r=>{var a=r.clone();return a.value=i(r.value),a}),null:function(r){return 0},"Unit, string | Unit":function(r,a){return r.toNumber(a)},"Array | Matrix":t.referToSelf(i=>r=>er(r,i))});return n.fromJSON=function(i){return parseFloat(i.value)},n}),ms="bignumber",gs=["typed","BigNumber"],Ds=j(ms,gs,e=>{var{typed:t,BigNumber:n}=e;return t("bignumber",{"":function(){return new n(0)},number:function(r){return new n(r+"")},string:function(r){var a=r.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(a){var o=a[2],h=n(a[1]),c=new n(2).pow(Number(o));if(h.gt(c.sub(1)))throw new SyntaxError('String "'.concat(r,'" is out of range'));var l=new n(2).pow(Number(o)-1);return h.gte(l)?h.sub(c):h}return new n(r)},BigNumber:function(r){return r},Unit:t.referToSelf(i=>r=>{var a=r.clone();return a.value=i(r.value),a}),Fraction:function(r){return new n(r.n).div(r.d).times(r.s)},null:function(r){return new n(0)},"Array | Matrix":t.referToSelf(i=>r=>er(r,i))})}),ys="complex",ws=["typed","Complex"],As=j(ys,ws,e=>{var{typed:t,Complex:n}=e;return t("complex",{"":function(){return n.ZERO},number:function(r){return new n(r,0)},"number, number":function(r,a){return new n(r,a)},"BigNumber, BigNumber":function(r,a){return new n(r.toNumber(),a.toNumber())},Fraction:function(r){return new n(r.valueOf(),0)},Complex:function(r){return r.clone()},string:function(r){return n(r)},null:function(r){return n(0)},Object:function(r){if("re"in r&&"im"in r)return new n(r.re,r.im);if("r"in r&&"phi"in r||"abs"in r&&"arg"in r)return new n(r);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf(i=>r=>er(r,i))})}),Es="fraction",Fs=["typed","Fraction"],Cs=j(Es,Fs,e=>{var{typed:t,Fraction:n}=e;return t("fraction",{number:function(r){if(!isFinite(r)||isNaN(r))throw new Error(r+" cannot be represented as a fraction");return new n(r)},string:function(r){return new n(r)},"number, number":function(r,a){return new n(r,a)},null:function(r){return new n(0)},BigNumber:function(r){return new n(r.toString())},Fraction:function(r){return r},Unit:t.referToSelf(i=>r=>{var a=r.clone();return a.value=i(r.value),a}),Object:function(r){return new n(r)},"Array | Matrix":t.referToSelf(i=>r=>er(r,i))})}),vi="matrix",bs=["typed","Matrix","DenseMatrix","SparseMatrix"],Ms=j(vi,bs,e=>{var{typed:t,Matrix:n,DenseMatrix:i,SparseMatrix:r}=e;return t(vi,{"":function(){return a([])},string:function(h){return a([],h)},"string, string":function(h,c){return a([],h,c)},Array:function(h){return a(h)},Matrix:function(h){return a(h,h.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(o,h,c){if(h==="dense"||h==="default"||h===void 0)return new i(o,c);if(h==="sparse")return new r(o,c);throw new TypeError("Unknown matrix type "+JSON.stringify(h)+".")}}),di="matrixFromColumns",Ss=["typed","matrix","flatten","size"],Ns=j(di,Ss,e=>{var{typed:t,matrix:n,flatten:i,size:r}=e;return t(di,{"...Array":function(c){return a(c)},"...Matrix":function(c){return n(a(c.map(l=>l.toArray())))}});function a(h){if(h.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var c=o(h[0]),l=[],s=0;s<c;s++)l[s]=[];for(var u of h){var f=o(u);if(f!==c)throw new TypeError("The vectors had different length: "+(c|0)+" ≠ "+(f|0));for(var d=i(u),D=0;D<c;D++)l[D].push(d[D])}return l}function o(h){var c=r(h);if(c.length===1)return c[0];if(c.length===2){if(c[0]===1)return c[1];if(c[1]===1)return c[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),pi="unaryMinus",xs=["typed"],Bs=j(pi,xs,e=>{var{typed:t}=e;return t(pi,{number:ai,"Complex | BigNumber | Fraction":n=>n.neg(),Unit:t.referToSelf(n=>i=>{var r=i.clone();return r.value=t.find(n,r.valueType())(i.value),r}),"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),mi="abs",_s=["typed"],zs=j(mi,_s,e=>{var{typed:t}=e;return t(mi,{number:ri,"Complex | BigNumber | Fraction | Unit":n=>n.abs(),"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),gi="addScalar",Ts=["typed"],Os=j(gi,Ts,e=>{var{typed:t}=e;return t(gi,{"number, number":ti,"Complex, Complex":function(i,r){return i.add(r)},"BigNumber, BigNumber":function(i,r){return i.plus(r)},"Fraction, Fraction":function(i,r){return i.add(r)},"Unit, Unit":t.referToSelf(n=>(i,r)=>{if(i.value===null||i.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(r.value===null||r.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!i.equalBase(r))throw new Error("Units do not match");var a=i.clone();return a.value=t.find(n,[a.valueType(),r.valueType()])(a.value,r.value),a.fixPrefix=!1,a})})}),Di="subtractScalar",Is=["typed"],Ls=j(Di,Is,e=>{var{typed:t}=e;return t(Di,{"number, number":ni,"Complex, Complex":function(i,r){return i.sub(r)},"BigNumber, BigNumber":function(i,r){return i.minus(r)},"Fraction, Fraction":function(i,r){return i.sub(r)},"Unit, Unit":t.referToSelf(n=>(i,r)=>{if(i.value===null||i.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(r.value===null||r.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!i.equalBase(r))throw new Error("Units do not match");var a=i.clone();return a.value=t.find(n,[a.valueType(),r.valueType()])(a.value,r.value),a.fixPrefix=!1,a})})}),$s="matAlgo11xS0s",qs=["typed","equalScalar"],Ps=j($s,qs,e=>{var{typed:t,equalScalar:n}=e;return function(r,a,o,h){var c=r._values,l=r._index,s=r._ptr,u=r._size,f=r._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d=u[0],D=u[1],v,m=n,p=0,w=o;typeof f=="string"&&(v=f,m=t.find(n,[v,v]),p=t.convert(0,v),a=t.convert(a,v),w=t.find(o,[v,v]));for(var g=[],A=[],F=[],y=0;y<D;y++){F[y]=A.length;for(var C=s[y],b=s[y+1],E=C;E<b;E++){var S=l[E],M=h?w(a,c[E]):w(c[E],a);m(M,p)||(A.push(S),g.push(M))}}return F[D]=A.length,r.createSparseMatrix({values:g,index:A,ptr:F,size:[d,D],datatype:v})}}),Rs="matAlgo12xSfs",Us=["typed","DenseMatrix"],Pr=j(Rs,Us,e=>{var{typed:t,DenseMatrix:n}=e;return function(r,a,o,h){var c=r._values,l=r._index,s=r._ptr,u=r._size,f=r._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d=u[0],D=u[1],v,m=o;typeof f=="string"&&(v=f,a=t.convert(a,v),m=t.find(o,[v,v]));for(var p=[],w=[],g=[],A=0;A<D;A++){for(var F=A+1,y=s[A],C=s[A+1],b=y;b<C;b++){var E=l[b];w[E]=c[b],g[E]=F}for(var S=0;S<d;S++)A===0&&(p[S]=[]),g[S]===F?p[S][A]=h?m(a,w[S]):m(w[S],a):p[S][A]=h?m(a,0):m(0,a)}return new n({data:p,size:[d,D],datatype:v})}}),Vs="matAlgo14xDs",Zs=["typed"],yi=j(Vs,Zs,e=>{var{typed:t}=e;return function(r,a,o,h){var c=r._data,l=r._size,s=r._datatype,u,f=o;typeof s=="string"&&(u=s,a=t.convert(a,u),f=t.find(o,[u,u]));var d=l.length>0?n(f,0,l,l[0],c,a,h):[];return r.createDenseMatrix({data:d,size:Ce(l),datatype:u})};function n(i,r,a,o,h,c,l){var s=[];if(r===a.length-1)for(var u=0;u<o;u++)s[u]=l?i(c,h[u]):i(h[u],c);else for(var f=0;f<o;f++)s[f]=n(i,r+1,a,a[r+1],h[f],c,l);return s}}),Gs="matAlgo03xDSf",Ys=["typed"],Rr=j(Gs,Ys,e=>{var{typed:t}=e;return function(i,r,a,o){var h=i._data,c=i._size,l=i._datatype,s=r._values,u=r._index,f=r._ptr,d=r._size,D=r._datatype;if(c.length!==d.length)throw new Ee(c.length,d.length);if(c[0]!==d[0]||c[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+d+")");if(!s)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var v=c[0],m=c[1],p,w=0,g=a;typeof l=="string"&&l===D&&(p=l,w=t.convert(0,p),g=t.find(a,[p,p]));for(var A=[],F=0;F<v;F++)A[F]=[];for(var y=[],C=[],b=0;b<m;b++){for(var E=b+1,S=f[b],M=f[b+1],N=S;N<M;N++){var O=u[N];y[O]=o?g(s[N],h[O][b]):g(h[O][b],s[N]),C[O]=E}for(var T=0;T<v;T++)C[T]===E?A[T][b]=y[T]:A[T][b]=o?g(w,h[T][b]):g(h[T][b],w)}return i.createDenseMatrix({data:A,size:[v,m],datatype:p})}}),Js="matAlgo05xSfSf",Qs=["typed","equalScalar"],Xs=j(Js,Qs,e=>{var{typed:t,equalScalar:n}=e;return function(r,a,o){var h=r._values,c=r._index,l=r._ptr,s=r._size,u=r._datatype,f=a._values,d=a._index,D=a._ptr,v=a._size,m=a._datatype;if(s.length!==v.length)throw new Ee(s.length,v.length);if(s[0]!==v[0]||s[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+v+")");var p=s[0],w=s[1],g,A=n,F=0,y=o;typeof u=="string"&&u===m&&(g=u,A=t.find(n,[g,g]),F=t.convert(0,g),y=t.find(o,[g,g]));var C=h&&f?[]:void 0,b=[],E=[],S=C?[]:void 0,M=C?[]:void 0,N=[],O=[],T,I,B,G;for(I=0;I<w;I++){E[I]=b.length;var $=I+1;for(B=l[I],G=l[I+1];B<G;B++)T=c[B],b.push(T),N[T]=$,S&&(S[T]=h[B]);for(B=D[I],G=D[I+1];B<G;B++)T=d[B],N[T]!==$&&b.push(T),O[T]=$,M&&(M[T]=f[B]);if(C)for(B=E[I];B<b.length;){T=b[B];var z=N[T],V=O[T];if(z===$||V===$){var W=z===$?S[T]:F,P=V===$?M[T]:F,q=y(W,P);A(q,F)?b.splice(B,1):(C.push(q),B++)}}}return E[w]=b.length,r.createSparseMatrix({values:C,index:b,ptr:E,size:[p,w],datatype:g})}}),Hs="matAlgo13xDD",Ks=["typed"],Ws=j(Hs,Ks,e=>{var{typed:t}=e;return function(r,a,o){var h=r._data,c=r._size,l=r._datatype,s=a._data,u=a._size,f=a._datatype,d=[];if(c.length!==u.length)throw new Ee(c.length,u.length);for(var D=0;D<c.length;D++){if(c[D]!==u[D])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+u+")");d[D]=c[D]}var v,m=o;typeof l=="string"&&l===f&&(v=l,m=t.find(o,[v,v]));var p=d.length>0?n(m,0,d,d[0],h,s):[];return r.createDenseMatrix({data:p,size:d,datatype:v})};function n(i,r,a,o,h,c){var l=[];if(r===a.length-1)for(var s=0;s<o;s++)l[s]=i(h[s],c[s]);else for(var u=0;u<o;u++)l[u]=n(i,r+1,a,a[r+1],h[u],c[u]);return l}}),ks="broadcast",js=["concat"],ef=j(ks,js,e=>{var{concat:t}=e;return function(r,a){var o=Math.max(r._size.length,a._size.length);if(r._size.length===a._size.length&&r._size.every((D,v)=>D===a._size[v]))return[r,a];for(var h=n(r._size,o,0),c=n(a._size,o,0),l=[],s=0;s<o;s++)l[s]=Math.max(h[s],c[s]);lt(h,l),lt(c,l);var u=r.clone(),f=a.clone();u._size.length<o?u.reshape(n(u._size,o,1)):f._size.length<o&&f.reshape(n(f._size,o,1));for(var d=0;d<o;d++)u._size[d]<l[d]&&(u=i(u,l[d],d)),f._size[d]<l[d]&&(f=i(f,l[d],d));return[u,f]};function n(r,a,o){return[...Array(a-r.length).fill(o),...r]}function i(r,a,o){return t(...Array(a).fill(r),o)}}),rf="matrixAlgorithmSuite",tf=["typed","matrix","concat"],Nr=j(rf,tf,e=>{var{typed:t,matrix:n,concat:i}=e,r=Ws({typed:t}),a=yi({typed:t}),o=ef({concat:i});return function(c){var l=c.elop,s=c.SD||c.DS,u;l?(u={"DenseMatrix, DenseMatrix":(v,m)=>r(...o(v,m),l),"Array, Array":(v,m)=>r(...o(n(v),n(m)),l).valueOf(),"Array, DenseMatrix":(v,m)=>r(...o(n(v),m),l),"DenseMatrix, Array":(v,m)=>r(...o(v,n(m)),l)},c.SS&&(u["SparseMatrix, SparseMatrix"]=(v,m)=>c.SS(...o(v,m),l,!1)),c.DS&&(u["DenseMatrix, SparseMatrix"]=(v,m)=>c.DS(...o(v,m),l,!1),u["Array, SparseMatrix"]=(v,m)=>c.DS(...o(n(v),m),l,!1)),s&&(u["SparseMatrix, DenseMatrix"]=(v,m)=>s(...o(m,v),l,!0),u["SparseMatrix, Array"]=(v,m)=>s(...o(n(m),v),l,!0))):(u={"DenseMatrix, DenseMatrix":t.referToSelf(v=>(m,p)=>r(...o(m,p),v)),"Array, Array":t.referToSelf(v=>(m,p)=>r(...o(n(m),n(p)),v).valueOf()),"Array, DenseMatrix":t.referToSelf(v=>(m,p)=>r(...o(n(m),p),v)),"DenseMatrix, Array":t.referToSelf(v=>(m,p)=>r(...o(m,n(p)),v))},c.SS&&(u["SparseMatrix, SparseMatrix"]=t.referToSelf(v=>(m,p)=>c.SS(...o(m,p),v,!1))),c.DS&&(u["DenseMatrix, SparseMatrix"]=t.referToSelf(v=>(m,p)=>c.DS(...o(m,p),v,!1)),u["Array, SparseMatrix"]=t.referToSelf(v=>(m,p)=>c.DS(...o(n(m),p),v,!1))),s&&(u["SparseMatrix, DenseMatrix"]=t.referToSelf(v=>(m,p)=>s(...o(p,m),v,!0)),u["SparseMatrix, Array"]=t.referToSelf(v=>(m,p)=>s(...o(n(p),m),v,!0))));var f=c.scalar||"any",d=c.Ds||c.Ss;d&&(l?(u["DenseMatrix,"+f]=(v,m)=>a(v,m,l,!1),u[f+", DenseMatrix"]=(v,m)=>a(m,v,l,!0),u["Array,"+f]=(v,m)=>a(n(v),m,l,!1).valueOf(),u[f+", Array"]=(v,m)=>a(n(m),v,l,!0).valueOf()):(u["DenseMatrix,"+f]=t.referToSelf(v=>(m,p)=>a(m,p,v,!1)),u[f+", DenseMatrix"]=t.referToSelf(v=>(m,p)=>a(p,m,v,!0)),u["Array,"+f]=t.referToSelf(v=>(m,p)=>a(n(m),p,v,!1).valueOf()),u[f+", Array"]=t.referToSelf(v=>(m,p)=>a(n(p),m,v,!0).valueOf())));var D=c.sS!==void 0?c.sS:c.Ss;return l?(c.Ss&&(u["SparseMatrix,"+f]=(v,m)=>c.Ss(v,m,l,!1)),D&&(u[f+", SparseMatrix"]=(v,m)=>D(m,v,l,!0))):(c.Ss&&(u["SparseMatrix,"+f]=t.referToSelf(v=>(m,p)=>c.Ss(m,p,v,!1))),D&&(u[f+", SparseMatrix"]=t.referToSelf(v=>(m,p)=>D(p,m,v,!0)))),l&&l.signatures&&fu(u,l.signatures),u}}),nf="matAlgo01xDSid",af=["typed"],wi=j(nf,af,e=>{var{typed:t}=e;return function(i,r,a,o){var h=i._data,c=i._size,l=i._datatype,s=r._values,u=r._index,f=r._ptr,d=r._size,D=r._datatype;if(c.length!==d.length)throw new Ee(c.length,d.length);if(c[0]!==d[0]||c[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+d+")");if(!s)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var v=c[0],m=c[1],p=typeof l=="string"&&l===D?l:void 0,w=p?t.find(a,[p,p]):a,g,A,F=[];for(g=0;g<v;g++)F[g]=[];var y=[],C=[];for(A=0;A<m;A++){for(var b=A+1,E=f[A],S=f[A+1],M=E;M<S;M++)g=u[M],y[g]=o?w(s[M],h[g][A]):w(h[g][A],s[M]),C[g]=b;for(g=0;g<v;g++)C[g]===b?F[g][A]=y[g]:F[g][A]=h[g][A]}return i.createDenseMatrix({data:F,size:[v,m],datatype:p})}}),uf="matAlgo04xSidSid",of=["typed","equalScalar"],sf=j(uf,of,e=>{var{typed:t,equalScalar:n}=e;return function(r,a,o){var h=r._values,c=r._index,l=r._ptr,s=r._size,u=r._datatype,f=a._values,d=a._index,D=a._ptr,v=a._size,m=a._datatype;if(s.length!==v.length)throw new Ee(s.length,v.length);if(s[0]!==v[0]||s[1]!==v[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+v+")");var p=s[0],w=s[1],g,A=n,F=0,y=o;typeof u=="string"&&u===m&&(g=u,A=t.find(n,[g,g]),F=t.convert(0,g),y=t.find(o,[g,g]));var C=h&&f?[]:void 0,b=[],E=[],S=h&&f?[]:void 0,M=h&&f?[]:void 0,N=[],O=[],T,I,B,G,$;for(I=0;I<w;I++){E[I]=b.length;var z=I+1;for(G=l[I],$=l[I+1],B=G;B<$;B++)T=c[B],b.push(T),N[T]=z,S&&(S[T]=h[B]);for(G=D[I],$=D[I+1],B=G;B<$;B++)if(T=d[B],N[T]===z){if(S){var V=y(S[T],f[B]);A(V,F)?N[T]=null:S[T]=V}}else b.push(T),O[T]=z,M&&(M[T]=f[B]);if(S&&M)for(B=E[I];B<b.length;)T=b[B],N[T]===z?(C[B]=S[T],B++):O[T]===z?(C[B]=M[T],B++):b.splice(B,1)}return E[w]=b.length,r.createSparseMatrix({values:C,index:b,ptr:E,size:[p,w],datatype:g})}}),ff="matAlgo10xSids",cf=["typed","DenseMatrix"],Ai=j(ff,cf,e=>{var{typed:t,DenseMatrix:n}=e;return function(r,a,o,h){var c=r._values,l=r._index,s=r._ptr,u=r._size,f=r._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d=u[0],D=u[1],v,m=o;typeof f=="string"&&(v=f,a=t.convert(a,v),m=t.find(o,[v,v]));for(var p=[],w=[],g=[],A=0;A<D;A++){for(var F=A+1,y=s[A],C=s[A+1],b=y;b<C;b++){var E=l[b];w[E]=c[b],g[E]=F}for(var S=0;S<d;S++)A===0&&(p[S]=[]),g[S]===F?p[S][A]=h?m(a,w[S]):m(w[S],a):p[S][A]=a}return new n({data:p,size:[d,D],datatype:v})}}),lf="multiplyScalar",hf=["typed"],vf=j(lf,hf,e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":ii,"Complex, Complex":function(i,r){return i.mul(r)},"BigNumber, BigNumber":function(i,r){return i.times(r)},"Fraction, Fraction":function(i,r){return i.mul(r)},"number | Fraction | BigNumber | Complex, Unit":(n,i)=>i.multiply(n),"Unit, number | Fraction | BigNumber | Complex | Unit":(n,i)=>n.multiply(i)})}),Ei="multiply",df=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],pf=j(Ei,df,e=>{var{typed:t,matrix:n,addScalar:i,multiplyScalar:r,equalScalar:a,dot:o}=e,h=Ps({typed:t,equalScalar:a}),c=yi({typed:t});function l(F,y){switch(F.length){case 1:switch(y.length){case 1:if(F[0]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(F[0]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+F[0]+") must match Matrix rows ("+y[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+y.length+" dimensions)")}break;case 2:switch(y.length){case 1:if(F[1]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+F[1]+") must match Vector length ("+y[0]+")");break;case 2:if(F[1]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+F[1]+") must match Matrix B rows ("+y[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+y.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+F.length+" dimensions)")}}function s(F,y,C){if(C===0)throw new Error("Cannot multiply two empty vectors");return o(F,y)}function u(F,y){if(y.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return f(F,y)}function f(F,y){var C=F._data,b=F._size,E=F._datatype,S=y._data,M=y._size,N=y._datatype,O=b[0],T=M[1],I,B=i,G=r;E&&N&&E===N&&typeof E=="string"&&(I=E,B=t.find(i,[I,I]),G=t.find(r,[I,I]));for(var $=[],z=0;z<T;z++){for(var V=G(C[0],S[0][z]),W=1;W<O;W++)V=B(V,G(C[W],S[W][z]));$[z]=V}return F.createDenseMatrix({data:$,size:[T],datatype:I})}var d=t("_multiplyMatrixVector",{"DenseMatrix, any":v,"SparseMatrix, any":w}),D=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":m,"DenseMatrix, SparseMatrix":p,"SparseMatrix, DenseMatrix":g,"SparseMatrix, SparseMatrix":A});function v(F,y){var C=F._data,b=F._size,E=F._datatype,S=y._data,M=y._datatype,N=b[0],O=b[1],T,I=i,B=r;E&&M&&E===M&&typeof E=="string"&&(T=E,I=t.find(i,[T,T]),B=t.find(r,[T,T]));for(var G=[],$=0;$<N;$++){for(var z=C[$],V=B(z[0],S[0]),W=1;W<O;W++)V=I(V,B(z[W],S[W]));G[$]=V}return F.createDenseMatrix({data:G,size:[N],datatype:T})}function m(F,y){var C=F._data,b=F._size,E=F._datatype,S=y._data,M=y._size,N=y._datatype,O=b[0],T=b[1],I=M[1],B,G=i,$=r;E&&N&&E===N&&typeof E=="string"&&(B=E,G=t.find(i,[B,B]),$=t.find(r,[B,B]));for(var z=[],V=0;V<O;V++){var W=C[V];z[V]=[];for(var P=0;P<I;P++){for(var q=$(W[0],S[0][P]),Z=1;Z<T;Z++)q=G(q,$(W[Z],S[Z][P]));z[V][P]=q}}return F.createDenseMatrix({data:z,size:[O,I],datatype:B})}function p(F,y){var C=F._data,b=F._size,E=F._datatype,S=y._values,M=y._index,N=y._ptr,O=y._size,T=y._datatype;if(!S)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var I=b[0],B=O[1],G,$=i,z=r,V=a,W=0;E&&T&&E===T&&typeof E=="string"&&(G=E,$=t.find(i,[G,G]),z=t.find(r,[G,G]),V=t.find(a,[G,G]),W=t.convert(0,G));for(var P=[],q=[],Z=[],ne=y.createSparseMatrix({values:P,index:q,ptr:Z,size:[I,B],datatype:G}),k=0;k<B;k++){Z[k]=q.length;var U=N[k],Q=N[k+1];if(Q>U)for(var X=0,J=0;J<I;J++){for(var ue=J+1,ee=void 0,oe=U;oe<Q;oe++){var le=M[oe];X!==ue?(ee=z(C[J][le],S[oe]),X=ue):ee=$(ee,z(C[J][le],S[oe]))}X===ue&&!V(ee,W)&&(q.push(J),P.push(ee))}}return Z[B]=q.length,ne}function w(F,y){var C=F._values,b=F._index,E=F._ptr,S=F._datatype;if(!C)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var M=y._data,N=y._datatype,O=F._size[0],T=y._size[0],I=[],B=[],G=[],$,z=i,V=r,W=a,P=0;S&&N&&S===N&&typeof S=="string"&&($=S,z=t.find(i,[$,$]),V=t.find(r,[$,$]),W=t.find(a,[$,$]),P=t.convert(0,$));var q=[],Z=[];G[0]=0;for(var ne=0;ne<T;ne++){var k=M[ne];if(!W(k,P))for(var U=E[ne],Q=E[ne+1],X=U;X<Q;X++){var J=b[X];Z[J]?q[J]=z(q[J],V(k,C[X])):(Z[J]=!0,B.push(J),q[J]=V(k,C[X]))}}for(var ue=B.length,ee=0;ee<ue;ee++){var oe=B[ee];I[ee]=q[oe]}return G[1]=B.length,F.createSparseMatrix({values:I,index:B,ptr:G,size:[O,1],datatype:$})}function g(F,y){var C=F._values,b=F._index,E=F._ptr,S=F._datatype;if(!C)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var M=y._data,N=y._datatype,O=F._size[0],T=y._size[0],I=y._size[1],B,G=i,$=r,z=a,V=0;S&&N&&S===N&&typeof S=="string"&&(B=S,G=t.find(i,[B,B]),$=t.find(r,[B,B]),z=t.find(a,[B,B]),V=t.convert(0,B));for(var W=[],P=[],q=[],Z=F.createSparseMatrix({values:W,index:P,ptr:q,size:[O,I],datatype:B}),ne=[],k=[],U=0;U<I;U++){q[U]=P.length;for(var Q=U+1,X=0;X<T;X++){var J=M[X][U];if(!z(J,V))for(var ue=E[X],ee=E[X+1],oe=ue;oe<ee;oe++){var le=b[oe];k[le]!==Q?(k[le]=Q,P.push(le),ne[le]=$(J,C[oe])):ne[le]=G(ne[le],$(J,C[oe]))}}for(var pe=q[U],ge=P.length,we=pe;we<ge;we++){var he=P[we];W[we]=ne[he]}}return q[I]=P.length,Z}function A(F,y){var C=F._values,b=F._index,E=F._ptr,S=F._datatype,M=y._values,N=y._index,O=y._ptr,T=y._datatype,I=F._size[0],B=y._size[1],G=C&&M,$,z=i,V=r;S&&T&&S===T&&typeof S=="string"&&($=S,z=t.find(i,[$,$]),V=t.find(r,[$,$]));for(var W=G?[]:void 0,P=[],q=[],Z=F.createSparseMatrix({values:W,index:P,ptr:q,size:[I,B],datatype:$}),ne=G?[]:void 0,k=[],U,Q,X,J,ue,ee,oe,le,pe=0;pe<B;pe++){q[pe]=P.length;var ge=pe+1;for(ue=O[pe],ee=O[pe+1],J=ue;J<ee;J++)if(le=N[J],G)for(Q=E[le],X=E[le+1],U=Q;U<X;U++)oe=b[U],k[oe]!==ge?(k[oe]=ge,P.push(oe),ne[oe]=V(M[J],C[U])):ne[oe]=z(ne[oe],V(M[J],C[U]));else for(Q=E[le],X=E[le+1],U=Q;U<X;U++)oe=b[U],k[oe]!==ge&&(k[oe]=ge,P.push(oe));if(G)for(var we=q[pe],he=P.length,be=we;be<he;be++){var Fe=P[be];W[be]=ne[Fe]}}return q[B]=P.length,Z}return t(Ei,r,{"Array, Array":t.referTo("Matrix, Matrix",F=>(y,C)=>{l(qe(y),qe(C));var b=F(n(y),n(C));return Be(b)?b.valueOf():b}),"Matrix, Matrix":function(y,C){var b=y.size(),E=C.size();return l(b,E),b.length===1?E.length===1?s(y,C,b[0]):u(y,C):E.length===1?d(y,C):D(y,C)},"Matrix, Array":t.referTo("Matrix,Matrix",F=>(y,C)=>F(y,n(C))),"Array, Matrix":t.referToSelf(F=>(y,C)=>F(n(y,C.storage()),C)),"SparseMatrix, any":function(y,C){return h(y,C,r,!1)},"DenseMatrix, any":function(y,C){return c(y,C,r,!1)},"any, SparseMatrix":function(y,C){return h(C,y,r,!0)},"any, DenseMatrix":function(y,C){return c(C,y,r,!0)},"Array, any":function(y,C){return c(n(y),C,r,!1).valueOf()},"any, Array":function(y,C){return c(n(C),y,r,!0).valueOf()},"any, any":r,"any, any, ...any":t.referToSelf(F=>(y,C,b)=>{for(var E=F(y,C),S=0;S<b.length;S++)E=F(E,b[S]);return E})})}),Fi="sign",mf=["typed","BigNumber","Fraction","complex"],gf=j(Fi,mf,e=>{var{typed:t,BigNumber:n,complex:i,Fraction:r}=e;return t(Fi,{number:Wt,Complex:function(o){return o.im===0?i(Wt(o.re)):o.sign()},BigNumber:function(o){return new n(o.cmp(0))},Fraction:function(o){return new r(o.s,1)},"Array | Matrix":t.referToSelf(a=>o=>er(o,a)),Unit:t.referToSelf(a=>o=>{if(!o._isDerived()&&o.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return t.find(a,o.valueType())(o.value)})})}),Df="sqrt",yf=["config","typed","Complex"],wf=j(Df,yf,e=>{var{config:t,typed:n,Complex:i}=e;return n("sqrt",{number:r,Complex:function(o){return o.sqrt()},BigNumber:function(o){return!o.isNegative()||t.predictable?o.sqrt():r(o.toNumber())},Unit:function(o){return o.pow(.5)}});function r(a){return isNaN(a)?NaN:a>=0||t.predictable?Math.sqrt(a):new i(a,0).sqrt()}}),Ci="subtract",Af=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],Ef=j(Ci,Af,e=>{var{typed:t,matrix:n,equalScalar:i,subtractScalar:r,unaryMinus:a,DenseMatrix:o,concat:h}=e,c=wi({typed:t}),l=Rr({typed:t}),s=Xs({typed:t,equalScalar:i}),u=Ai({typed:t,DenseMatrix:o}),f=Pr({typed:t,DenseMatrix:o}),d=Nr({typed:t,matrix:n,concat:h});return t(Ci,{"any, any":r},d({elop:r,SS:s,DS:c,SD:l,Ss:f,sS:u}))}),Ff="matAlgo07xSSf",Cf=["typed","DenseMatrix"],Kr=j(Ff,Cf,e=>{var{typed:t,DenseMatrix:n}=e;return function(a,o,h){var c=a._size,l=a._datatype,s=o._size,u=o._datatype;if(c.length!==s.length)throw new Ee(c.length,s.length);if(c[0]!==s[0]||c[1]!==s[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+s+")");var f=c[0],d=c[1],D,v=0,m=h;typeof l=="string"&&l===u&&(D=l,v=t.convert(0,D),m=t.find(h,[D,D]));var p,w,g=[];for(p=0;p<f;p++)g[p]=[];var A=[],F=[],y=[],C=[];for(w=0;w<d;w++){var b=w+1;for(i(a,w,y,A,b),i(o,w,C,F,b),p=0;p<f;p++){var E=y[p]===b?A[p]:v,S=C[p]===b?F[p]:v;g[p][w]=m(E,S)}}return new n({data:g,size:[f,d],datatype:D})};function i(r,a,o,h,c){for(var l=r._values,s=r._index,u=r._ptr,f=u[a],d=u[a+1];f<d;f++){var D=s[f];o[D]=c,h[D]=l[f]}}}),bi="conj",bf=["typed"],Mf=j(bi,bf,e=>{var{typed:t}=e;return t(bi,{"number | BigNumber | Fraction":n=>n,Complex:n=>n.conjugate(),"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),Mi="im",Sf=["typed"],Nf=j(Mi,Sf,e=>{var{typed:t}=e;return t(Mi,{number:()=>0,"BigNumber | Fraction":n=>n.mul(0),Complex:n=>n.im,"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),Si="re",xf=["typed"],Bf=j(Si,xf,e=>{var{typed:t}=e;return t(Si,{"number | BigNumber | Fraction":n=>n,Complex:n=>n.re,"Array | Matrix":t.referToSelf(n=>i=>er(i,n))})}),Ni="concat",_f=["typed","matrix","isInteger"],zf=j(Ni,_f,e=>{var{typed:t,matrix:n,isInteger:i}=e;return t(Ni,{"...Array | Matrix | number | BigNumber":function(a){var o,h=a.length,c=-1,l,s=!1,u=[];for(o=0;o<h;o++){var f=a[o];if(Be(f)&&(s=!0),Le(f)||Re(f)){if(o!==h-1)throw new Error("Dimension must be specified as last argument");if(l=c,c=f.valueOf(),!i(c))throw new TypeError("Integer number expected for dimension");if(c<0||o>0&&c>l)throw new Sr(c,l+1)}else{var d=Ce(f).valueOf(),D=qe(d);if(u[o]=d,l=c,c=D.length-1,o>0&&c!==l)throw new Ee(l+1,c+1)}}if(u.length===0)throw new SyntaxError("At least one matrix expected");for(var v=u.shift();u.length;)v=xn(v,u.shift(),c);return s?n(v):v},"...string":function(a){return a.join("")}})}),xi="column",Tf=["typed","Index","matrix","range"],Of=j(xi,Tf,e=>{var{typed:t,Index:n,matrix:i,range:r}=e;return t(xi,{"Matrix, number":a,"Array, number":function(h,c){return a(i(Ce(h)),c).valueOf()}});function a(o,h){if(o.size().length!==2)throw new Error("Only two dimensional matrix is supported");_e(h,o.size()[1]);var c=r(0,o.size()[0]),l=new n(c,h),s=o.subset(l);return Be(s)?s:i([[s]])}}),Bi="diag",If=["typed","matrix","DenseMatrix","SparseMatrix"],Lf=j(Bi,If,e=>{var{typed:t,matrix:n,DenseMatrix:i,SparseMatrix:r}=e;return t(Bi,{Array:function(l){return a(l,0,qe(l),null)},"Array, number":function(l,s){return a(l,s,qe(l),null)},"Array, BigNumber":function(l,s){return a(l,s.toNumber(),qe(l),null)},"Array, string":function(l,s){return a(l,0,qe(l),s)},"Array, number, string":function(l,s,u){return a(l,s,qe(l),u)},"Array, BigNumber, string":function(l,s,u){return a(l,s.toNumber(),qe(l),u)},Matrix:function(l){return a(l,0,l.size(),l.storage())},"Matrix, number":function(l,s){return a(l,s,l.size(),l.storage())},"Matrix, BigNumber":function(l,s){return a(l,s.toNumber(),l.size(),l.storage())},"Matrix, string":function(l,s){return a(l,0,l.size(),s)},"Matrix, number, string":function(l,s,u){return a(l,s,l.size(),u)},"Matrix, BigNumber, string":function(l,s,u){return a(l,s.toNumber(),l.size(),u)}});function a(c,l,s,u){if(!Te(l))throw new TypeError("Second parameter in function diag must be an integer");var f=l>0?l:0,d=l<0?-l:0;switch(s.length){case 1:return o(c,l,u,s[0],d,f);case 2:return h(c,l,u,s,d,f)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function o(c,l,s,u,f,d){var D=[u+f,u+d];if(s&&s!=="sparse"&&s!=="dense")throw new TypeError("Unknown matrix type ".concat(s,'"'));var v=s==="sparse"?r.diagonal(D,c,l):i.diagonal(D,c,l);return s!==null?v:v.valueOf()}function h(c,l,s,u,f,d){if(Be(c)){var D=c.diagonal(l);return s!==null?s!==D.storage()?n(D,s):D:D.valueOf()}for(var v=Math.min(u[0]-f,u[1]-d),m=[],p=0;p<v;p++)m[p]=c[p+f][p+d];return s!==null?n(m):m}}),_i="flatten",$f=["typed","matrix"],qf=j(_i,$f,e=>{var{typed:t,matrix:n}=e;return t(_i,{Array:function(r){return Ut(r)},Matrix:function(r){var a=Ut(r.toArray());return n(a)}})}),zi="getMatrixDataType",Pf=["typed"],Rf=j(zi,Pf,e=>{var{typed:t}=e;return t(zi,{Array:function(i){return Jr(i,hr)},Matrix:function(i){return i.getDataType()}})}),Ti="identity",Uf=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],Vf=j(Ti,Uf,e=>{var{typed:t,config:n,matrix:i,BigNumber:r,DenseMatrix:a,SparseMatrix:o}=e;return t(Ti,{"":function(){return n.matrix==="Matrix"?i([]):[]},string:function(s){return i(s)},"number | BigNumber":function(s){return c(s,s,n.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(s,u){return c(s,s,u)},"number | BigNumber, number | BigNumber":function(s,u){return c(s,u,n.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(s,u,f){return c(s,u,f)},Array:function(s){return h(s)},"Array, string":function(s,u){return h(s,u)},Matrix:function(s){return h(s.valueOf(),s.storage())},"Matrix, string":function(s,u){return h(s.valueOf(),u)}});function h(l,s){switch(l.length){case 0:return s?i(s):[];case 1:return c(l[0],l[0],s);case 2:return c(l[0],l[1],s);default:throw new Error("Vector containing two values expected")}}function c(l,s,u){var f=Re(l)||Re(s)?r:null;if(Re(l)&&(l=l.toNumber()),Re(s)&&(s=s.toNumber()),!Te(l)||l<1)throw new Error("Parameters in function identity must be positive integers");if(!Te(s)||s<1)throw new Error("Parameters in function identity must be positive integers");var d=f?new r(1):1,D=f?new f(0):0,v=[l,s];if(u){if(u==="sparse")return o.diagonal(v,d,0,D);if(u==="dense")return a.diagonal(v,d,0,D);throw new TypeError('Unknown matrix type "'.concat(u,'"'))}for(var m=ct([],v,D),p=l<s?l:s,w=0;w<p;w++)m[w][w]=d;return m}});function Oi(){throw new Error('No "bignumber" implementation available')}function Zf(){throw new Error('No "fraction" implementation available')}function Ii(){throw new Error('No "matrix" implementation available')}var Li="range",Gf=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],Yf=j(Li,Gf,e=>{var{typed:t,config:n,matrix:i,bignumber:r,smaller:a,smallerEq:o,larger:h,largerEq:c,add:l,isPositive:s}=e;return t(Li,{string:f,"string, boolean":f,"number, number":function(m,p){return u(d(m,p,1,!1))},"number, number, number":function(m,p,w){return u(d(m,p,w,!1))},"number, number, boolean":function(m,p,w){return u(d(m,p,1,w))},"number, number, number, boolean":function(m,p,w,g){return u(d(m,p,w,g))},"BigNumber, BigNumber":function(m,p){var w=m.constructor;return u(d(m,p,new w(1),!1))},"BigNumber, BigNumber, BigNumber":function(m,p,w){return u(d(m,p,w,!1))},"BigNumber, BigNumber, boolean":function(m,p,w){var g=m.constructor;return u(d(m,p,new g(1),w))},"BigNumber, BigNumber, BigNumber, boolean":function(m,p,w,g){return u(d(m,p,w,g))},"Unit, Unit, Unit":function(m,p,w){return u(d(m,p,w,!1))},"Unit, Unit, Unit, boolean":function(m,p,w,g){return u(d(m,p,w,g))}});function u(v){return n.matrix==="Matrix"?i?i(v):Ii():v}function f(v,m){var p=D(v);if(!p)throw new SyntaxError('String "'+v+'" is no valid range');return n.number==="BigNumber"?(r===void 0&&Oi(),u(d(r(p.start),r(p.end),r(p.step)))):u(d(p.start,p.end,p.step,m))}function d(v,m,p,w){for(var g=[],A=s(p)?w?o:a:w?c:h,F=v;A(F,m);)g.push(F),F=l(F,p);return g}function D(v){var m=v.split(":"),p=m.map(function(g){return Number(g)}),w=p.some(function(g){return isNaN(g)});if(w)return null;switch(p.length){case 2:return{start:p[0],end:p[1],step:1};case 3:return{start:p[0],end:p[2],step:p[1]};default:return null}}}),$i="reshape",Jf=["typed","isInteger","matrix"],Qf=j($i,Jf,e=>{var{typed:t,isInteger:n}=e;return t($i,{"Matrix, Array":function(r,a){return r.reshape(a,!0)},"Array, Array":function(r,a){return a.forEach(function(o){if(!n(o))throw new TypeError("Invalid size for dimension: "+o)}),Pt(r,a)}})}),qi="size",Xf=["typed","config","?matrix"],Hf=j(qi,Xf,e=>{var{typed:t,config:n,matrix:i}=e;return t(qi,{Matrix:function(a){return a.create(a.size())},Array:qe,string:function(a){return n.matrix==="Array"?[a.length]:i([a.length])},"number | Complex | BigNumber | Unit | boolean | null":function(a){return n.matrix==="Array"?[]:i?i([]):Ii()}})}),Pi="squeeze",Kf=["typed","matrix"],Wf=j(Pi,Kf,e=>{var{typed:t,matrix:n}=e;return t(Pi,{Array:function(r){return Cn(Ce(r))},Matrix:function(r){var a=Cn(r.toArray());return Array.isArray(a)?n(a):a},any:function(r){return Ce(r)}})}),Ri="subset",kf=["typed","matrix","zeros","add"],jf=j(Ri,kf,e=>{var{typed:t,matrix:n,zeros:i,add:r}=e;return t(Ri,{"Matrix, Index":function(h,c){return Ir(c)?n():(ft(h,c),h.subset(c))},"Array, Index":t.referTo("Matrix, Index",function(o){return function(h,c){var l=o(n(h),c);return c.isScalar()?l:l.valueOf()}}),"Object, Index":rc,"string, Index":ec,"Matrix, Index, any, any":function(h,c,l,s){return Ir(c)?h:(ft(h,c),h.clone().subset(c,a(l,c),s))},"Array, Index, any, any":t.referTo("Matrix, Index, any, any",function(o){return function(h,c,l,s){var u=o(n(h),c,l,s);return u.isMatrix?u.valueOf():u}}),"Array, Index, any":t.referTo("Matrix, Index, any, any",function(o){return function(h,c,l){return o(n(h),c,l,void 0).valueOf()}}),"Matrix, Index, any":t.referTo("Matrix, Index, any, any",function(o){return function(h,c,l){return o(h,c,l,void 0)}}),"string, Index, string":Ui,"string, Index, string, string":Ui,"Object, Index, any":tc});function a(o,h){if(typeof o=="string")throw new Error("can't boradcast a string");if(h._isScalar)return o;var c=h.size();if(c.every(l=>l>0))try{return r(o,i(c))}catch{return o}else return o}});function ec(e,t){if(!ut(t))throw new TypeError("Index expected");if(Ir(t))return"";if(ft(Array.from(e),t),t.size().length!==1)throw new Ee(t.size().length,1);var n=e.length;_e(t.min()[0],n),_e(t.max()[0],n);var i=t.dimension(0),r="";return i.forEach(function(a){r+=e.charAt(a)}),r}function Ui(e,t,n,i){if(!t||t.isIndex!==!0)throw new TypeError("Index expected");if(Ir(t))return e;if(ft(Array.from(e),t),t.size().length!==1)throw new Ee(t.size().length,1);if(i!==void 0){if(typeof i!="string"||i.length!==1)throw new TypeError("Single character expected as defaultValue")}else i=" ";var r=t.dimension(0),a=r.size()[0];if(a!==n.length)throw new Ee(r.size()[0],n.length);var o=e.length;_e(t.min()[0]),_e(t.max()[0]);for(var h=[],c=0;c<o;c++)h[c]=e.charAt(c);if(r.forEach(function(u,f){h[u]=n.charAt(f[0])}),h.length>o)for(var l=o-1,s=h.length;l<s;l++)h[l]||(h[l]=i);return h.join("")}function rc(e,t){if(!Ir(t)){if(t.size().length!==1)throw new Ee(t.size(),1);var n=t.dimension(0);if(typeof n!="string")throw new TypeError("String expected as index to retrieve an object property");return _n(e,n)}}function tc(e,t,n){if(Ir(t))return e;if(t.size().length!==1)throw new Ee(t.size(),1);var i=t.dimension(0);if(typeof i!="string")throw new TypeError("String expected as index to retrieve an object property");var r=Ce(e);return zn(r,i,n),r}var Vi="transpose",nc=["typed","matrix"],ic=j(Vi,nc,e=>{var{typed:t,matrix:n}=e;return t(Vi,{Array:o=>i(n(o)).valueOf(),Matrix:i,any:Ce});function i(o){var h=o.size(),c;switch(h.length){case 1:c=o.clone();break;case 2:{var l=h[0],s=h[1];if(s===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+$e(h)+")");switch(o.storage()){case"dense":c=r(o,l,s);break;case"sparse":c=a(o,l,s);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+$e(h)+")")}return c}function r(o,h,c){for(var l=o._data,s=[],u,f=0;f<c;f++){u=s[f]=[];for(var d=0;d<h;d++)u[d]=Ce(l[d][f])}return o.createDenseMatrix({data:s,size:[c,h],datatype:o._datatype})}function a(o,h,c){for(var l=o._values,s=o._index,u=o._ptr,f=l?[]:void 0,d=[],D=[],v=[],m=0;m<h;m++)v[m]=0;var p,w,g;for(p=0,w=s.length;p<w;p++)v[s[p]]++;for(var A=0,F=0;F<h;F++)D.push(A),A+=v[F],v[F]=D[F];for(D.push(A),g=0;g<c;g++)for(var y=u[g],C=u[g+1],b=y;b<C;b++){var E=v[s[b]]++;d[E]=g,l&&(f[E]=Ce(l[b]))}return o.createSparseMatrix({values:f,index:d,ptr:D,size:[c,h],datatype:o._datatype})}}),Zi="ctranspose",ac=["typed","transpose","conj"],uc=j(Zi,ac,e=>{var{typed:t,transpose:n,conj:i}=e;return t(Zi,{any:function(a){return i(n(a))}})}),Gi="zeros",oc=["typed","config","matrix","BigNumber"],sc=j(Gi,oc,e=>{var{typed:t,config:n,matrix:i,BigNumber:r}=e;return t(Gi,{"":function(){return n.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(l){var s=l[l.length-1];if(typeof s=="string"){var u=l.pop();return a(l,u)}else return n.matrix==="Array"?a(l):a(l,"default")},Array:a,Matrix:function(l){var s=l.storage();return a(l.valueOf(),s)},"Array | Matrix, string":function(l,s){return a(l.valueOf(),s)}});function a(c,l){var s=o(c),u=s?new r(0):0;if(h(c),l){var f=i(l);return c.length>0?f.resize(c,u):f}else{var d=[];return c.length>0?ct(d,c,u):d}}function o(c){var l=!1;return c.forEach(function(s,u,f){Re(s)&&(l=!0,f[u]=s.toNumber())}),l}function h(c){c.forEach(function(l){if(typeof l!="number"||!Te(l)||l<0)throw new Error("Parameters in function zeros must be positive integers")})}}),fc="numeric",cc=["number","?bignumber","?fraction"],lc=j(fc,cc,e=>{var{number:t,bignumber:n,fraction:i}=e,r={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:o=>t(o),BigNumber:n?o=>n(o):Oi,Fraction:i?o=>i(o):Zf};return function(h){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",l=arguments.length>2?arguments[2]:void 0;if(l!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var s=hr(h);if(!(s in r))throw new TypeError("Cannot convert "+h+' of type "'+s+'"; valid input types are '+Object.keys(r).join(", "));if(!(c in a))throw new TypeError("Cannot convert "+h+' to type "'+c+'"; valid output types are '+Object.keys(a).join(", "));return c===s?h:a[c](h)}}),Yi="divideScalar",hc=["typed","numeric"],vc=j(Yi,hc,e=>{var{typed:t,numeric:n}=e;return t(Yi,{"number, number":function(r,a){return r/a},"Complex, Complex":function(r,a){return r.div(a)},"BigNumber, BigNumber":function(r,a){return r.div(a)},"Fraction, Fraction":function(r,a){return r.div(a)},"Unit, number | Complex | Fraction | BigNumber | Unit":(i,r)=>i.divide(r),"number | Fraction | Complex | BigNumber, Unit":(i,r)=>r.divideInto(i)})}),Ji="pow",dc=["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],pc=j(Ji,dc,e=>{var{typed:t,config:n,identity:i,multiply:r,matrix:a,inv:o,number:h,fraction:c,Complex:l}=e;return t(Ji,{"number, number":s,"Complex, Complex":function(D,v){return D.pow(v)},"BigNumber, BigNumber":function(D,v){return v.isInteger()||D>=0||n.predictable?D.pow(v):new l(D.toNumber(),0).pow(v.toNumber(),0)},"Fraction, Fraction":function(D,v){var m=D.pow(v);if(m!=null)return m;if(n.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return s(D.valueOf(),v.valueOf())},"Array, number":u,"Array, BigNumber":function(D,v){return u(D,v.toNumber())},"Matrix, number":f,"Matrix, BigNumber":function(D,v){return f(D,v.toNumber())},"Unit, number | BigNumber":function(D,v){return D.pow(v)}});function s(d,D){if(n.predictable&&!Te(D)&&d<0)try{var v=c(D),m=h(v);if((D===m||Math.abs((D-m)/D)<1e-14)&&v.d%2===1)return(v.n%2===0?1:-1)*Math.pow(-d,D)}catch{}return n.predictable&&(d<-1&&D===1/0||d>-1&&d<0&&D===-1/0)?NaN:Te(D)||d>=0||n.predictable?ui(d,D):d*d<1&&D===1/0||d*d>1&&D===-1/0?0:new l(d,0).pow(D,0)}function u(d,D){if(!Te(D))throw new TypeError("For A^b, b must be an integer (value is "+D+")");var v=qe(d);if(v.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+v.length+" dimensions)");if(v[0]!==v[1])throw new Error("For A^b, A must be square (size is "+v[0]+"x"+v[1]+")");if(D<0)try{return u(o(d),-D)}catch(w){throw w.message==="Cannot calculate inverse, determinant is zero"?new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+D+")"):w}for(var m=i(v[0]).valueOf(),p=d;D>=1;)(D&1)===1&&(m=r(p,m)),D>>=1,p=r(p,p);return m}function f(d,D){return a(u(d.valueOf(),D))}});function Et(e){var{DenseMatrix:t}=e;return function(i,r,a){var o=i.size();if(o.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+$e(o)+")");var h=o[0],c=o[1];if(h!==c)throw new RangeError("Matrix must be square (size: "+$e(o)+")");var l=[];if(Be(r)){var s=r.size(),u=r._data;if(s.length===1){if(s[0]!==h)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var f=0;f<h;f++)l[f]=[u[f]];return new t({data:l,size:[h,1],datatype:r._datatype})}if(s.length===2){if(s[0]!==h||s[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(sn(r)){if(a){l=[];for(var d=0;d<h;d++)l[d]=[u[d][0]];return new t({data:l,size:[h,1],datatype:r._datatype})}return r}if(fn(r)){for(var D=0;D<h;D++)l[D]=[0];for(var v=r._values,m=r._index,p=r._ptr,w=p[1],g=p[0];g<w;g++){var A=m[g];l[A][0]=v[g]}return new t({data:l,size:[h,1],datatype:r._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Me(r)){var F=qe(r);if(F.length===1){if(F[0]!==h)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<h;y++)l[y]=[r[y]];return new t({data:l,size:[h,1]})}if(F.length===2){if(F[0]!==h||F[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var C=0;C<h;C++)l[C]=[r[C][0]];return new t({data:l,size:[h,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var Qi="lsolve",mc=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],gc=j(Qi,mc,e=>{var{typed:t,matrix:n,divideScalar:i,multiplyScalar:r,subtractScalar:a,equalScalar:o,DenseMatrix:h}=e,c=Et({DenseMatrix:h});return t(Qi,{"SparseMatrix, Array | Matrix":function(f,d){return s(f,d)},"DenseMatrix, Array | Matrix":function(f,d){return l(f,d)},"Array, Array | Matrix":function(f,d){var D=n(f),v=l(D,d);return v.valueOf()}});function l(u,f){f=c(u,f,!0);for(var d=f._data,D=u._size[0],v=u._size[1],m=[],p=u._data,w=0;w<v;w++){var g=d[w][0]||0,A=void 0;if(o(g,0))A=0;else{var F=p[w][w];if(o(F,0))throw new Error("Linear system cannot be solved since matrix is singular");A=i(g,F);for(var y=w+1;y<D;y++)d[y]=[a(d[y][0]||0,r(A,p[y][w]))]}m[w]=[A]}return new h({data:m,size:[D,1]})}function s(u,f){f=c(u,f,!0);for(var d=f._data,D=u._size[0],v=u._size[1],m=u._values,p=u._index,w=u._ptr,g=[],A=0;A<v;A++){var F=d[A][0]||0;if(o(F,0))g[A]=[0];else{for(var y=0,C=[],b=[],E=w[A],S=w[A+1],M=E;M<S;M++){var N=p[M];N===A?y=m[M]:N>A&&(C.push(m[M]),b.push(N))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var O=i(F,y),T=0,I=b.length;T<I;T++){var B=b[T];d[B]=[a(d[B][0]||0,r(O,C[T]))]}g[A]=[O]}}return new h({data:g,size:[D,1]})}}),Xi="usolve",Dc=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],yc=j(Xi,Dc,e=>{var{typed:t,matrix:n,divideScalar:i,multiplyScalar:r,subtractScalar:a,equalScalar:o,DenseMatrix:h}=e,c=Et({DenseMatrix:h});return t(Xi,{"SparseMatrix, Array | Matrix":function(f,d){return s(f,d)},"DenseMatrix, Array | Matrix":function(f,d){return l(f,d)},"Array, Array | Matrix":function(f,d){var D=n(f),v=l(D,d);return v.valueOf()}});function l(u,f){f=c(u,f,!0);for(var d=f._data,D=u._size[0],v=u._size[1],m=[],p=u._data,w=v-1;w>=0;w--){var g=d[w][0]||0,A=void 0;if(o(g,0))A=0;else{var F=p[w][w];if(o(F,0))throw new Error("Linear system cannot be solved since matrix is singular");A=i(g,F);for(var y=w-1;y>=0;y--)d[y]=[a(d[y][0]||0,r(A,p[y][w]))]}m[w]=[A]}return new h({data:m,size:[D,1]})}function s(u,f){f=c(u,f,!0);for(var d=f._data,D=u._size[0],v=u._size[1],m=u._values,p=u._index,w=u._ptr,g=[],A=v-1;A>=0;A--){var F=d[A][0]||0;if(o(F,0))g[A]=[0];else{for(var y=0,C=[],b=[],E=w[A],S=w[A+1],M=S-1;M>=E;M--){var N=p[M];N===A?y=m[M]:N<A&&(C.push(m[M]),b.push(N))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var O=i(F,y),T=0,I=b.length;T<I;T++){var B=b[T];d[B]=[a(d[B][0],r(O,C[T]))]}g[A]=[O]}}return new h({data:g,size:[D,1]})}}),Hi="usolveAll",wc=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],Ac=j(Hi,wc,e=>{var{typed:t,matrix:n,divideScalar:i,multiplyScalar:r,subtractScalar:a,equalScalar:o,DenseMatrix:h}=e,c=Et({DenseMatrix:h});return t(Hi,{"SparseMatrix, Array | Matrix":function(f,d){return s(f,d)},"DenseMatrix, Array | Matrix":function(f,d){return l(f,d)},"Array, Array | Matrix":function(f,d){var D=n(f),v=l(D,d);return v.map(m=>m.valueOf())}});function l(u,f){for(var d=[c(u,f,!0)._data.map(b=>b[0])],D=u._data,v=u._size[0],m=u._size[1],p=m-1;p>=0;p--)for(var w=d.length,g=0;g<w;g++){var A=d[g];if(o(D[p][p],0))if(o(A[p],0)){if(g===0){var y=[...A];y[p]=1;for(var C=p-1;C>=0;C--)y[C]=a(y[C],D[C][p]);d.push(y)}}else{if(g===0)return[];d.splice(g,1),g-=1,w-=1}else{A[p]=i(A[p],D[p][p]);for(var F=p-1;F>=0;F--)A[F]=a(A[F],r(A[p],D[F][p]))}}return d.map(b=>new h({data:b.map(E=>[E]),size:[v,1]}))}function s(u,f){for(var d=[c(u,f,!0)._data.map(W=>W[0])],D=u._size[0],v=u._size[1],m=u._values,p=u._index,w=u._ptr,g=v-1;g>=0;g--)for(var A=d.length,F=0;F<A;F++){for(var y=d[F],C=[],b=[],E=w[g],S=w[g+1],M=0,N=S-1;N>=E;N--){var O=p[N];O===g?M=m[N]:O<g&&(C.push(m[N]),b.push(O))}if(o(M,0))if(o(y[g],0)){if(F===0){var G=[...y];G[g]=1;for(var $=0,z=b.length;$<z;$++){var V=b[$];G[V]=a(G[V],C[$])}d.push(G)}}else{if(F===0)return[];d.splice(F,1),F-=1,A-=1}else{y[g]=i(y[g],M);for(var T=0,I=b.length;T<I;T++){var B=b[T];y[B]=a(y[B],r(y[g],C[T]))}}}return d.map(W=>new h({data:W.map(P=>[P]),size:[D,1]}))}}),Ft="equal",Ec=["typed","matrix","equalScalar","DenseMatrix","concat"],Fc=j(Ft,Ec,e=>{var{typed:t,matrix:n,equalScalar:i,DenseMatrix:r,concat:a}=e,o=Rr({typed:t}),h=Kr({typed:t,DenseMatrix:r}),c=Pr({typed:t,DenseMatrix:r}),l=Nr({typed:t,matrix:n,concat:a});return t(Ft,Cc({typed:t,equalScalar:i}),l({elop:i,SS:h,DS:o,Ss:c}))}),Cc=j(Ft,["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return t(Ft,{"any, any":function(r,a){return r===null?a===null:a===null?r===null:r===void 0?a===void 0:a===void 0?r===void 0:n(r,a)}})}),Ct="smaller",bc=["typed","config","matrix","DenseMatrix","concat"],Mc=j(Ct,bc,e=>{var{typed:t,config:n,matrix:i,DenseMatrix:r,concat:a}=e,o=Rr({typed:t}),h=Kr({typed:t,DenseMatrix:r}),c=Pr({typed:t,DenseMatrix:r}),l=Nr({typed:t,matrix:i,concat:a}),s=Hr({typed:t});return t(Ct,Sc({typed:t,config:n}),{"boolean, boolean":(u,f)=>u<f,"BigNumber, BigNumber":function(f,d){return f.lt(d)&&!Xr(f,d,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)===-1,"Complex, Complex":function(f,d){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:h,DS:o,Ss:c}))}),Sc=j(Ct,["typed","config"],e=>{var{typed:t,config:n}=e;return t(Ct,{"number, number":function(r,a){return r<a&&!yr(r,a,n.epsilon)}})}),bt="smallerEq",Nc=["typed","config","matrix","DenseMatrix","concat"],xc=j(bt,Nc,e=>{var{typed:t,config:n,matrix:i,DenseMatrix:r,concat:a}=e,o=Rr({typed:t}),h=Kr({typed:t,DenseMatrix:r}),c=Pr({typed:t,DenseMatrix:r}),l=Nr({typed:t,matrix:i,concat:a}),s=Hr({typed:t});return t(bt,Bc({typed:t,config:n}),{"boolean, boolean":(u,f)=>u<=f,"BigNumber, BigNumber":function(f,d){return f.lte(d)||Xr(f,d,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:h,DS:o,Ss:c}))}),Bc=j(bt,["typed","config"],e=>{var{typed:t,config:n}=e;return t(bt,{"number, number":function(r,a){return r<=a||yr(r,a,n.epsilon)}})}),Mt="larger",_c=["typed","config","matrix","DenseMatrix","concat"],zc=j(Mt,_c,e=>{var{typed:t,config:n,matrix:i,DenseMatrix:r,concat:a}=e,o=Rr({typed:t}),h=Kr({typed:t,DenseMatrix:r}),c=Pr({typed:t,DenseMatrix:r}),l=Nr({typed:t,matrix:i,concat:a}),s=Hr({typed:t});return t(Mt,Tc({typed:t,config:n}),{"boolean, boolean":(u,f)=>u>f,"BigNumber, BigNumber":function(f,d){return f.gt(d)&&!Xr(f,d,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)===1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:h,DS:o,Ss:c}))}),Tc=j(Mt,["typed","config"],e=>{var{typed:t,config:n}=e;return t(Mt,{"number, number":function(r,a){return r>a&&!yr(r,a,n.epsilon)}})}),St="largerEq",Oc=["typed","config","matrix","DenseMatrix","concat"],Ic=j(St,Oc,e=>{var{typed:t,config:n,matrix:i,DenseMatrix:r,concat:a}=e,o=Rr({typed:t}),h=Kr({typed:t,DenseMatrix:r}),c=Pr({typed:t,DenseMatrix:r}),l=Nr({typed:t,matrix:i,concat:a}),s=Hr({typed:t});return t(St,Lc({typed:t,config:n}),{"boolean, boolean":(u,f)=>u>=f,"BigNumber, BigNumber":function(f,d){return f.gte(d)||Xr(f,d,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:h,DS:o,Ss:c}))}),Lc=j(St,["typed","config"],e=>{var{typed:t,config:n}=e;return t(St,{"number, number":function(r,a){return r>=a||yr(r,a,n.epsilon)}})}),$c="ImmutableDenseMatrix",qc=["smaller","DenseMatrix"],Pc=j($c,qc,e=>{var{smaller:t,DenseMatrix:n}=e;function i(r,a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!nr(a))throw new Error("Invalid datatype: "+a);if(Be(r)||Me(r)){var o=new n(r,a);this._data=o._data,this._size=o._size,this._datatype=o._datatype,this._min=null,this._max=null}else if(r&&Me(r.data)&&Me(r.size))this._data=r.data,this._size=r.size,this._datatype=r.datatype,this._min=typeof r.min<"u"?r.min:null,this._max=typeof r.max<"u"?r.max:null;else{if(r)throw new TypeError("Unsupported type of data ("+hr(r)+")");this._data=[],this._size=[0],this._datatype=a,this._min=null,this._max=null}}return i.prototype=new n,i.prototype.type="ImmutableDenseMatrix",i.prototype.isImmutableDenseMatrix=!0,i.prototype.subset=function(r){switch(arguments.length){case 1:{var a=n.prototype.subset.call(this,r);return Be(a)?new i({data:a._data,size:a._size,datatype:a._datatype}):a}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},i.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},i.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},i.prototype.clone=function(){return new i({data:Ce(this._data),size:Ce(this._size),datatype:this._datatype})},i.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.fromJSON=function(r){return new i(r)},i.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},i.prototype.min=function(){if(this._min===null){var r=null;this.forEach(function(a){(r===null||t(a,r))&&(r=a)}),this._min=r!==null?r:void 0}return this._min},i.prototype.max=function(){if(this._max===null){var r=null;this.forEach(function(a){(r===null||t(r,a))&&(r=a)}),this._max=r!==null?r:void 0}return this._max},i},{isClass:!0}),Rc="Index",Uc=["ImmutableDenseMatrix","getMatrixDataType"],Vc=j(Rc,Uc,e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:n}=e;function i(a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var o=0,h=arguments.length;o<h;o++){var c=arguments[o],l=Me(c),s=Be(c),u=null;if(cn(c))this._dimensions.push(c),this._isScalar=!1;else if(l||s){var f=void 0;n(c)==="boolean"?(l&&(f=r(Ki(c).valueOf())),s&&(f=r(Ki(c._data).valueOf())),u=c.valueOf().length):f=r(c.valueOf()),this._dimensions.push(f);var d=f.size();(d.length!==1||d[0]!==1||u!==null)&&(this._isScalar=!1)}else if(typeof c=="number")this._dimensions.push(r([c]));else if(typeof c=="string")this._dimensions.push(c);else throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(u)}}i.prototype.type="Index",i.prototype.isIndex=!0;function r(a){for(var o=0,h=a.length;o<h;o++)if(typeof a[o]!="number"||!Te(a[o]))throw new TypeError("Index parameters must be positive integer numbers");return new t(a)}return i.prototype.clone=function(){var a=new i;return a._dimensions=Ce(this._dimensions),a._isScalar=this._isScalar,a._sourceSize=this._sourceSize,a},i.create=function(a){var o=new i;return i.apply(o,a),o},i.prototype.size=function(){for(var a=[],o=0,h=this._dimensions.length;o<h;o++){var c=this._dimensions[o];a[o]=typeof c=="string"?1:c.size()[0]}return a},i.prototype.max=function(){for(var a=[],o=0,h=this._dimensions.length;o<h;o++){var c=this._dimensions[o];a[o]=typeof c=="string"?c:c.max()}return a},i.prototype.min=function(){for(var a=[],o=0,h=this._dimensions.length;o<h;o++){var c=this._dimensions[o];a[o]=typeof c=="string"?c:c.min()}return a},i.prototype.forEach=function(a){for(var o=0,h=this._dimensions.length;o<h;o++)a(this._dimensions[o],o,this)},i.prototype.dimension=function(a){return this._dimensions[a]||null},i.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},i.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},i.prototype.isScalar=function(){return this._isScalar},i.prototype.toArray=function(){for(var a=[],o=0,h=this._dimensions.length;o<h;o++){var c=this._dimensions[o];a.push(typeof c=="string"?c:c.toArray())}return a},i.prototype.valueOf=i.prototype.toArray,i.prototype.toString=function(){for(var a=[],o=0,h=this._dimensions.length;o<h;o++){var c=this._dimensions[o];typeof c=="string"?a.push(JSON.stringify(c)):a.push(c.toString())}return"["+a.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},i.fromJSON=function(a){return i.create(a.dimensions)},i},{isClass:!0});function Ki(e){var t=[];return e.forEach((n,i)=>{n&&t.push(i)}),t}var Zc="FibonacciHeap",Gc=["smaller","larger"],Yc=j(Zc,Gc,e=>{var{smaller:t,larger:n}=e,i=1/Math.log((1+Math.sqrt(5))/2);function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}r.prototype.type="FibonacciHeap",r.prototype.isFibonacciHeap=!0,r.prototype.insert=function(s,u){var f={key:s,value:u,degree:0};if(this._minimum){var d=this._minimum;f.left=d,f.right=d.right,d.right=f,f.right.left=f,t(s,d.key)&&(this._minimum=f)}else f.left=f,f.right=f,this._minimum=f;return this._size++,f},r.prototype.size=function(){return this._size},r.prototype.clear=function(){this._minimum=null,this._size=0},r.prototype.isEmpty=function(){return this._size===0},r.prototype.extractMinimum=function(){var s=this._minimum;if(s===null)return s;for(var u=this._minimum,f=s.degree,d=s.child;f>0;){var D=d.right;d.left.right=d.right,d.right.left=d.left,d.left=u,d.right=u.right,u.right=d,d.right.left=d,d.parent=null,d=D,f--}return s.left.right=s.right,s.right.left=s.left,s===s.right?u=null:(u=s.right,u=l(u,this._size)),this._size--,this._minimum=u,s},r.prototype.remove=function(s){this._minimum=a(this._minimum,s,-1),this.extractMinimum()};function a(s,u,f){u.key=f;var d=u.parent;return d&&t(u.key,d.key)&&(o(s,u,d),h(s,d)),t(u.key,s.key)&&(s=u),s}function o(s,u,f){u.left.right=u.right,u.right.left=u.left,f.degree--,f.child===u&&(f.child=u.right),f.degree===0&&(f.child=null),u.left=s,u.right=s.right,s.right=u,u.right.left=u,u.parent=null,u.mark=!1}function h(s,u){var f=u.parent;f&&(u.mark?(o(s,u,f),h(f)):u.mark=!0)}var c=function(u,f){u.left.right=u.right,u.right.left=u.left,u.parent=f,f.child?(u.left=f.child,u.right=f.child.right,f.child.right=u,u.right.left=u):(f.child=u,u.right=u,u.left=u),f.degree++,u.mark=!1};function l(s,u){var f=Math.floor(Math.log(u)*i)+1,d=new Array(f),D=0,v=s;if(v)for(D++,v=v.right;v!==s;)D++,v=v.right;for(var m;D>0;){for(var p=v.degree,w=v.right;m=d[p],!!m;){if(n(v.key,m.key)){var g=m;m=v,v=g}c(m,v),d[p]=null,p++}d[p]=v,v=w,D--}s=null;for(var A=0;A<f;A++)m=d[A],m&&(s?(m.left.right=m.right,m.right.left=m.left,m.left=s,m.right=s.right,s.right=m,m.right.left=m,t(m.key,s.key)&&(s=m)):s=m);return s}return r},{isClass:!0}),Jc="Spa",Qc=["addScalar","equalScalar","FibonacciHeap"],Xc=j(Jc,Qc,e=>{var{addScalar:t,equalScalar:n,FibonacciHeap:i}=e;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new i}return r.prototype.type="Spa",r.prototype.isSpa=!0,r.prototype.set=function(a,o){if(this._values[a])this._values[a].value=o;else{var h=this._heap.insert(a,o);this._values[a]=h}},r.prototype.get=function(a){var o=this._values[a];return o?o.value:0},r.prototype.accumulate=function(a,o){var h=this._values[a];h?h.value=t(h.value,o):(h=this._heap.insert(a,o),this._values[a]=h)},r.prototype.forEach=function(a,o,h){var c=this._heap,l=this._values,s=[],u=c.extractMinimum();for(u&&s.push(u);u&&u.key<=o;)u.key>=a&&(n(u.value,0)||h(u.key,u.value,this)),u=c.extractMinimum(),u&&s.push(u);for(var f=0;f<s.length;f++){var d=s[f];u=c.insert(d.key,d.value),l[u.key]=u}},r.prototype.swap=function(a,o){var h=this._values[a],c=this._values[o];if(!h&&c)h=this._heap.insert(a,c.value),this._heap.remove(c),this._values[a]=h,this._values[o]=void 0;else if(h&&!c)c=this._heap.insert(o,h.value),this._heap.remove(h),this._values[o]=c,this._values[a]=void 0;else if(h&&c){var l=h.value;h.value=c.value,c.value=l}},r},{isClass:!0}),Hc="atan",Kc=["typed"],Wc=j(Hc,Kc,e=>{var{typed:t}=e;return t("atan",{number:function(i){return Math.atan(i)},Complex:function(i){return i.atan()},BigNumber:function(i){return i.atan()}})}),Wi=j("trigUnit",["typed"],e=>{var{typed:t}=e;return{Unit:t.referToSelf(n=>i=>{if(!i.hasBase(i.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(n,i.valueType())(i.value)})}}),ki="cos",kc=["typed"],jc=j(ki,kc,e=>{var{typed:t}=e,n=Wi({typed:t});return t(ki,{number:Math.cos,"Complex | BigNumber":i=>i.cos()},n)}),ji="sin",el=["typed"],rl=j(ji,el,e=>{var{typed:t}=e,n=Wi({typed:t});return t(ji,{number:Math.sin,"Complex | BigNumber":i=>i.sin()},n)}),ea="add",tl=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],nl=j(ea,tl,e=>{var{typed:t,matrix:n,addScalar:i,equalScalar:r,DenseMatrix:a,SparseMatrix:o,concat:h}=e,c=wi({typed:t}),l=sf({typed:t,equalScalar:r}),s=Ai({typed:t,DenseMatrix:a}),u=Nr({typed:t,matrix:n,concat:h});return t(ea,{"any, any":i,"any, any, ...any":t.referToSelf(f=>(d,D,v)=>{for(var m=f(d,D),p=0;p<v.length;p++)m=f(m,v[p]);return m})},u({elop:i,DS:c,SS:l,Ss:s}))}),ra="norm",il=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],al=j(ra,il,e=>{var{typed:t,abs:n,add:i,pow:r,conj:a,sqrt:o,multiply:h,equalScalar:c,larger:l,smaller:s,matrix:u,ctranspose:f,eigs:d}=e;return t(ra,{number:Math.abs,Complex:function(b){return b.abs()},BigNumber:function(b){return b.abs()},boolean:function(b){return Math.abs(b)},Array:function(b){return y(u(b),2)},Matrix:function(b){return y(b,2)},"Array, number | BigNumber | string":function(b,E){return y(u(b),E)},"Matrix, number | BigNumber | string":function(b,E){return y(b,E)}});function D(C){var b=0;return C.forEach(function(E){var S=n(E);l(S,b)&&(b=S)},!0),b}function v(C){var b;return C.forEach(function(E){var S=n(E);(!b||s(S,b))&&(b=S)},!0),b||0}function m(C,b){if(b===Number.POSITIVE_INFINITY||b==="inf")return D(C);if(b===Number.NEGATIVE_INFINITY||b==="-inf")return v(C);if(b==="fro")return y(C,2);if(typeof b=="number"&&!isNaN(b)){if(!c(b,0)){var E=0;return C.forEach(function(S){E=i(r(n(S),b),E)},!0),r(E,1/b)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function p(C){var b=0;return C.forEach(function(E,S){b=i(b,h(E,a(E)))}),n(o(b))}function w(C){var b=[],E=0;return C.forEach(function(S,M){var N=M[1],O=i(b[N]||0,n(S));l(O,E)&&(E=O),b[N]=O},!0),E}function g(C){var b=C.size();if(b[0]!==b[1])throw new RangeError("Invalid matrix dimensions");var E=f(C),S=h(E,C),M=d(S).values.toArray(),N=M[M.length-1];return n(o(N))}function A(C){var b=[],E=0;return C.forEach(function(S,M){var N=M[0],O=i(b[N]||0,n(S));l(O,E)&&(E=O),b[N]=O},!0),E}function F(C,b){if(b===1)return w(C);if(b===Number.POSITIVE_INFINITY||b==="inf")return A(C);if(b==="fro")return p(C);if(b===2)return g(C);throw new Error("Unsupported parameter value "+b)}function y(C,b){var E=C.size();if(E.length===1)return m(C,b);if(E.length===2){if(E[0]&&E[1])return F(C,b);throw new RangeError("Invalid matrix dimensions")}}}),ta="dot",ul=["typed","addScalar","multiplyScalar","conj","size"],ol=j(ta,ul,e=>{var{typed:t,addScalar:n,multiplyScalar:i,conj:r,size:a}=e;return t(ta,{"Array | DenseMatrix, Array | DenseMatrix":h,"SparseMatrix, SparseMatrix":c});function o(s,u){var f=l(s),d=l(u),D,v;if(f.length===1)D=f[0];else if(f.length===2&&f[1]===1)D=f[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+f.join(", ")+")");if(d.length===1)v=d[0];else if(d.length===2&&d[1]===1)v=d[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+d.join(", ")+")");if(D!==v)throw new RangeError("Vectors must have equal length ("+D+" != "+v+")");if(D===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return D}function h(s,u){var f=o(s,u),d=Be(s)?s._data:s,D=Be(s)?s._datatype:void 0,v=Be(u)?u._data:u,m=Be(u)?u._datatype:void 0,p=l(s).length===2,w=l(u).length===2,g=n,A=i;if(D&&m&&D===m&&typeof D=="string"){var F=D;g=t.find(n,[F,F]),A=t.find(i,[F,F])}if(!p&&!w){for(var y=A(r(d[0]),v[0]),C=1;C<f;C++)y=g(y,A(r(d[C]),v[C]));return y}if(!p&&w){for(var b=A(r(d[0]),v[0][0]),E=1;E<f;E++)b=g(b,A(r(d[E]),v[E][0]));return b}if(p&&!w){for(var S=A(r(d[0][0]),v[0]),M=1;M<f;M++)S=g(S,A(r(d[M][0]),v[M]));return S}if(p&&w){for(var N=A(r(d[0][0]),v[0][0]),O=1;O<f;O++)N=g(N,A(r(d[O][0]),v[O][0]));return N}}function c(s,u){o(s,u);for(var f=s._index,d=s._values,D=u._index,v=u._values,m=0,p=n,w=i,g=0,A=0;g<f.length&&A<D.length;){var F=f[g],y=D[A];if(F<y){g++;continue}if(F>y){A++;continue}F===y&&(m=p(m,w(d[g],v[A])),g++,A++)}return m}function l(s){return Be(s)?s.size():a(s)}}),na="index",sl=["typed","Index"],fl=j(na,sl,e=>{var{typed:t,Index:n}=e;return t(na,{"...number | string | BigNumber | Range | Array | Matrix":function(r){var a=r.map(function(h){return Re(h)?h.toNumber():Me(h)||Be(h)?h.map(function(c){return Re(c)?c.toNumber():c}):h}),o=new n;return n.apply(o,a),o}})}),ia="lup",cl=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],ll=j(ia,cl,e=>{var{typed:t,matrix:n,abs:i,addScalar:r,divideScalar:a,multiplyScalar:o,subtractScalar:h,larger:c,equalScalar:l,unaryMinus:s,DenseMatrix:u,SparseMatrix:f,Spa:d}=e;return t(ia,{DenseMatrix:function(p){return D(p)},SparseMatrix:function(p){return v(p)},Array:function(p){var w=n(p),g=D(w);return{L:g.L.valueOf(),U:g.U.valueOf(),p:g.p}}});function D(m){var p=m._size[0],w=m._size[1],g=Math.min(p,w),A=Ce(m._data),F=[],y=[p,g],C=[],b=[g,w],E,S,M,N=[];for(E=0;E<p;E++)N[E]=E;for(S=0;S<w;S++){if(S>0)for(E=0;E<p;E++){var O=Math.min(E,S),T=0;for(M=0;M<O;M++)T=r(T,o(A[E][M],A[M][S]));A[E][S]=h(A[E][S],T)}var I=S,B=0,G=0;for(E=S;E<p;E++){var $=A[E][S],z=i($);c(z,B)&&(I=E,B=z,G=$)}if(S!==I&&(N[S]=[N[I],N[I]=N[S]][0],u._swapRows(S,I,A)),S<p)for(E=S+1;E<p;E++){var V=A[E][S];l(V,0)||(A[E][S]=a(A[E][S],G))}}for(S=0;S<w;S++)for(E=0;E<p;E++){if(S===0&&(E<w&&(C[E]=[]),F[E]=[]),E<S){E<w&&(C[E][S]=A[E][S]),S<p&&(F[E][S]=0);continue}if(E===S){E<w&&(C[E][S]=A[E][S]),S<p&&(F[E][S]=1);continue}E<w&&(C[E][S]=0),S<p&&(F[E][S]=A[E][S])}var W=new u({data:F,size:y}),P=new u({data:C,size:b}),q=[];for(E=0,g=N.length;E<g;E++)q[N[E]]=E;return{L:W,U:P,p:q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function v(m){var p=m._size[0],w=m._size[1],g=Math.min(p,w),A=m._values,F=m._index,y=m._ptr,C=[],b=[],E=[],S=[p,g],M=[],N=[],O=[],T=[g,w],I,B,G,$=[],z=[];for(I=0;I<p;I++)$[I]=I,z[I]=I;var V=function(q,Z){var ne=z[q],k=z[Z];$[ne]=Z,$[k]=q,z[q]=k,z[Z]=ne},W=function(){var q=new d;B<p&&(E.push(C.length),C.push(1),b.push(B)),O.push(M.length);var Z=y[B],ne=y[B+1];for(G=Z;G<ne;G++)I=F[G],q.set($[I],A[G]);B>0&&q.forEach(0,B-1,function(X,J){f._forEachRow(X,C,b,E,function(ue,ee){ue>X&&q.accumulate(ue,s(o(ee,J)))})});var k=B,U=q.get(B),Q=i(U);q.forEach(B+1,p-1,function(X,J){var ue=i(J);c(ue,Q)&&(k=X,Q=ue,U=J)}),B!==k&&(f._swapRows(B,k,S[1],C,b,E),f._swapRows(B,k,T[1],M,N,O),q.swap(B,k),V(B,k)),q.forEach(0,p-1,function(X,J){X<=B?(M.push(J),N.push(X)):(J=a(J,U),l(J,0)||(C.push(J),b.push(X)))})};for(B=0;B<w;B++)W();return O.push(M.length),E.push(C.length),{L:new f({values:C,index:b,ptr:E,size:S}),U:new f({values:M,index:N,ptr:O,size:T}),p:$,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),aa="qr",hl=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],vl=j(aa,hl,e=>{var{typed:t,matrix:n,zeros:i,identity:r,isZero:a,equal:o,sign:h,sqrt:c,conj:l,unaryMinus:s,addScalar:u,divideScalar:f,multiplyScalar:d,subtractScalar:D,complex:v}=e;return Ye(t(aa,{DenseMatrix:function(A){return p(A)},SparseMatrix:function(A){return w()},Array:function(A){var F=n(A),y=p(F);return{Q:y.Q.valueOf(),R:y.R.valueOf()}}}),{_denseQRimpl:m});function m(g){var A=g._size[0],F=g._size[1],y=r([A],"dense"),C=y._data,b=g.clone(),E=b._data,S,M,N,O=i([A],"");for(N=0;N<Math.min(F,A);++N){var T=E[N][N],I=s(o(T,0)?1:h(T)),B=l(I),G=0;for(S=N;S<A;S++)G=u(G,d(E[S][N],l(E[S][N])));var $=d(I,c(G));if(!a($)){var z=D(T,$);for(O[N]=1,S=N+1;S<A;S++)O[S]=f(E[S][N],z);var V=s(l(f(z,$))),W=void 0;for(M=N;M<F;M++){for(W=0,S=N;S<A;S++)W=u(W,d(l(O[S]),E[S][M]));for(W=d(W,V),S=N;S<A;S++)E[S][M]=d(D(E[S][M],d(O[S],W)),B)}for(S=0;S<A;S++){for(W=0,M=N;M<A;M++)W=u(W,d(C[S][M],O[M]));for(W=d(W,V),M=N;M<A;++M)C[S][M]=f(D(C[S][M],d(W,l(O[M]))),B)}}}return{Q:y,R:b,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function p(g){var A=m(g),F=A.R._data;if(g._data.length>0)for(var y=F[0][0].type==="Complex"?v(0):0,C=0;C<F.length;++C)for(var b=0;b<C&&b<(F[0]||[]).length;++b)F[C][b]=y;return A}function w(g){throw new Error("qr not implemented for sparse matrices yet")}});function dl(e,t,n,i){for(var r=e._values,a=e._index,o=e._ptr,h=e._size,c=e._datatype,l=h[0],s=h[1],u=i&&e._values?[]:null,f=[],d=[],D=0,v=0;v<s;v++){d[v]=D;for(var m=n?n[v]:v,p=o[m],w=o[m+1],g=p;g<w;g++){var A=t?t[a[g]]:a[g];f[D]=A,u&&(u[D]=r[g]),D++}}return d[s]=D,e.createSparseMatrix({values:u,index:f,ptr:d,size:[l,s],datatype:c})}function ua(e,t,n,i,r,a,o){var h=0;for(n[o]=e;h>=0;){var c=n[o+h],l=n[i+c];l===-1?(h--,a[t++]=c):(n[i+c]=n[r+l],++h,n[o+h]=l)}return t}function pl(e,t){if(!e)return null;var n=0,i,r=[],a=[],o=0,h=t,c=2*t;for(i=0;i<t;i++)a[o+i]=-1;for(i=t-1;i>=0;i--)e[i]!==-1&&(a[h+i]=a[o+e[i]],a[o+e[i]]=i);for(i=0;i<t;i++)e[i]===-1&&(n=ua(i,n,a,o,h,r,c));return r}function ml(e,t){if(!e)return null;var n=e._index,i=e._ptr,r=e._size,a=r[0],o=r[1],h=[],c=[],l=0,s=o,u,f;if(t)for(u=0;u<a;u++)c[s+u]=-1;for(var d=0;d<o;d++){h[d]=-1,c[l+d]=-1;for(var D=i[d],v=i[d+1],m=D;m<v;m++){var p=n[m];for(u=t?c[s+p]:p;u!==-1&&u<d;u=f)f=c[l+u],c[l+u]=d,f===-1&&(h[u]=d);t&&(c[s+p]=d)}}return h}function gl(e,t,n){for(var i=e._values,r=e._index,a=e._ptr,o=e._size,h=o[1],c=0,l=0;l<h;l++){var s=a[l];for(a[l]=c;s<a[l+1];s++)t(r[s],l,i?i[s]:1,n)&&(r[c]=r[s],i&&(i[c]=i[s]),c++)}return a[h]=c,r.splice(c,r.length-c),i&&i.splice(c,i.length-c),c}function Cr(e){return-e-2}var Dl="csAmd",yl=["add","multiply","transpose"],wl=j(Dl,yl,e=>{var{add:t,multiply:n,transpose:i}=e;return function(s,u){if(!u||s<=0||s>3)return null;var f=u._size,d=f[0],D=f[1],v=0,m=Math.max(16,10*Math.sqrt(D));m=Math.min(D-2,m);var p=r(s,u,d,D,m);gl(p,c,null);for(var w=p._index,g=p._ptr,A=g[D],F=[],y=[],C=0,b=D+1,E=2*(D+1),S=3*(D+1),M=4*(D+1),N=5*(D+1),O=6*(D+1),T=7*(D+1),I=F,B=a(D,g,y,C,S,I,E,T,b,O,M,N),G=o(D,g,y,N,M,O,m,b,S,I,E),$=0,z,V,W,P,q,Z,ne,k,U,Q,X,J,ue,ee,oe,le;G<D;){for(W=-1;$<D&&(W=y[S+$])===-1;$++);y[E+W]!==-1&&(I[y[E+W]]=-1),y[S+$]=y[E+W];var pe=y[M+W],ge=y[b+W];G+=ge;var we=0;y[b+W]=-ge;var he=g[W],be=pe===0?he:A,Fe=be;for(P=1;P<=pe+1;P++){for(P>pe?(Z=W,ne=he,k=y[C+W]-pe):(Z=w[he++],ne=g[Z],k=y[C+Z]),q=1;q<=k;q++)z=w[ne++],!((U=y[b+z])<=0)&&(we+=U,y[b+z]=-U,w[Fe++]=z,y[E+z]!==-1&&(I[y[E+z]]=I[z]),I[z]!==-1?y[E+I[z]]=y[E+z]:y[S+y[N+z]]=y[E+z]);Z!==W&&(g[Z]=Cr(W),y[O+Z]=0)}for(pe!==0&&(A=Fe),y[N+W]=we,g[W]=be,y[C+W]=Fe-be,y[M+W]=-2,B=h(B,v,y,O,D),Q=be;Q<Fe;Q++)if(z=w[Q],!((X=y[M+z])<=0)){U=-y[b+z];var Se=B-U;for(he=g[z],J=g[z]+X-1;he<=J;he++)Z=w[he],y[O+Z]>=B?y[O+Z]-=U:y[O+Z]!==0&&(y[O+Z]=y[N+Z]+Se)}for(Q=be;Q<Fe;Q++){for(z=w[Q],J=g[z],ue=J+y[M+z]-1,ee=J,oe=0,le=0,he=J;he<=ue;he++)if(Z=w[he],y[O+Z]!==0){var Ge=y[O+Z]-B;Ge>0?(le+=Ge,w[ee++]=Z,oe+=Z):(g[Z]=Cr(W),y[O+Z]=0)}y[M+z]=ee-J+1;var x=ee,_=J+y[C+z];for(he=ue+1;he<_;he++){V=w[he];var L=y[b+V];L<=0||(le+=L,w[ee++]=V,oe+=V)}le===0?(g[z]=Cr(W),U=-y[b+z],we-=U,ge+=U,G+=U,y[b+z]=0,y[M+z]=-1):(y[N+z]=Math.min(y[N+z],le),w[ee]=w[x],w[x]=w[J],w[J]=W,y[C+z]=ee-J+1,oe=(oe<0?-oe:oe)%D,y[E+z]=y[T+oe],y[T+oe]=z,I[z]=oe)}for(y[N+W]=we,v=Math.max(v,we),B=h(B+v,v,y,O,D),Q=be;Q<Fe;Q++)if(z=w[Q],!(y[b+z]>=0))for(oe=I[z],z=y[T+oe],y[T+oe]=-1;z!==-1&&y[E+z]!==-1;z=y[E+z],B++){for(k=y[C+z],X=y[M+z],he=g[z]+1;he<=g[z]+k-1;he++)y[O+w[he]]=B;var R=z;for(V=y[E+z];V!==-1;){var H=y[C+V]===k&&y[M+V]===X;for(he=g[V]+1;H&&he<=g[V]+k-1;he++)y[O+w[he]]!==B&&(H=0);H?(g[V]=Cr(z),y[b+z]+=y[b+V],y[b+V]=0,y[M+V]=-1,V=y[E+V],y[E+R]=V):(R=V,V=y[E+V])}}for(he=be,Q=be;Q<Fe;Q++)z=w[Q],!((U=-y[b+z])<=0)&&(y[b+z]=U,le=y[N+z]+we-U,le=Math.min(le,D-G-U),y[S+le]!==-1&&(I[y[S+le]]=z),y[E+z]=y[S+le],I[z]=-1,y[S+le]=z,$=Math.min($,le),y[N+z]=le,w[he++]=z);y[b+W]=ge,(y[C+W]=he-be)===0&&(g[W]=-1,y[O+W]=0),pe!==0&&(A=he)}for(z=0;z<D;z++)g[z]=Cr(g[z]);for(V=0;V<=D;V++)y[S+V]=-1;for(V=D;V>=0;V--)y[b+V]>0||(y[E+V]=y[S+g[V]],y[S+g[V]]=V);for(Z=D;Z>=0;Z--)y[b+Z]<=0||g[Z]!==-1&&(y[E+Z]=y[S+g[Z]],y[S+g[Z]]=Z);for(W=0,z=0;z<=D;z++)g[z]===-1&&(W=ua(z,W,y,S,E,F,O));return F.splice(F.length-1,1),F};function r(l,s,u,f,d){var D=i(s);if(l===1&&f===u)return t(s,D);if(l===2){for(var v=D._index,m=D._ptr,p=0,w=0;w<u;w++){var g=m[w];if(m[w]=p,!(m[w+1]-g>d))for(var A=m[w+1];g<A;g++)v[p++]=v[g]}return m[u]=p,s=i(D),n(D,s)}return n(D,s)}function a(l,s,u,f,d,D,v,m,p,w,g,A){for(var F=0;F<l;F++)u[f+F]=s[F+1]-s[F];u[f+l]=0;for(var y=0;y<=l;y++)u[d+y]=-1,D[y]=-1,u[v+y]=-1,u[m+y]=-1,u[p+y]=1,u[w+y]=1,u[g+y]=0,u[A+y]=u[f+y];var C=h(0,0,u,w,l);return u[g+l]=-2,s[l]=-1,u[w+l]=0,C}function o(l,s,u,f,d,D,v,m,p,w,g){for(var A=0,F=0;F<l;F++){var y=u[f+F];if(y===0)u[d+F]=-2,A++,s[F]=-1,u[D+F]=0;else if(y>v)u[m+F]=0,u[d+F]=-1,A++,s[F]=Cr(l),u[m+l]++;else{var C=u[p+y];C!==-1&&(w[C]=F),u[g+F]=u[p+y],u[p+y]=F}}return A}function h(l,s,u,f,d){if(l<2||l+s<0){for(var D=0;D<d;D++)u[f+D]!==0&&(u[f+D]=1);l=2}return l}function c(l,s){return l!==s}});function Al(e,t,n,i,r,a,o){var h,c,l=0,s;if(e<=t||n[i+t]<=n[r+e])return-1;n[r+e]=n[i+t];var u=n[a+e];if(n[a+e]=t,u===-1)l=1,s=e;else{for(l=2,s=u;s!==n[o+s];s=n[o+s]);for(h=u;h!==s;h=c)c=n[o+h],n[o+h]=s}return{jleaf:l,q:s}}var El="csCounts",Fl=["transpose"],Cl=j(El,Fl,e=>{var{transpose:t}=e;return function(n,i,r,a){if(!n||!i||!r)return null;var o=n._size,h=o[0],c=o[1],l,s,u,f,d,D,v,m=4*c+(a?c+h+1:0),p=[],w=0,g=c,A=2*c,F=3*c,y=4*c,C=5*c+1;for(u=0;u<m;u++)p[u]=-1;var b=[],E=t(n),S=E._index,M=E._ptr;for(u=0;u<c;u++)for(s=r[u],b[s]=p[F+s]===-1?1:0;s!==-1&&p[F+s]===-1;s=i[s])p[F+s]=u;if(a){for(u=0;u<c;u++)p[r[u]]=u;for(l=0;l<h;l++){for(u=c,D=M[l],v=M[l+1],d=D;d<v;d++)u=Math.min(u,p[S[d]]);p[C+l]=p[y+u],p[y+u]=l}}for(l=0;l<c;l++)p[w+l]=l;for(u=0;u<c;u++){for(s=r[u],i[s]!==-1&&b[i[s]]--,f=a?p[y+u]:s;f!==-1;f=a?p[C+f]:-1)for(d=M[f];d<M[f+1];d++){l=S[d];var N=Al(l,s,p,F,g,A,w);N.jleaf>=1&&b[s]++,N.jleaf===2&&b[N.q]--}i[s]!==-1&&(p[w+s]=i[s])}for(s=0;s<c;s++)i[s]!==-1&&(b[i[s]]+=b[s]);return b}}),bl="csSqr",Ml=["add","multiply","transpose"],Sl=j(bl,Ml,e=>{var{add:t,multiply:n,transpose:i}=e,r=wl({add:t,multiply:n,transpose:i}),a=Cl({transpose:i});return function(c,l,s){var u=l._ptr,f=l._size,d=f[1],D,v={};if(v.q=r(c,l),c&&!v.q)return null;if(s){var m=c?dl(l,null,v.q,0):l;v.parent=ml(m,1);var p=pl(v.parent,d);if(v.cp=a(m,v.parent,p,1),m&&v.parent&&v.cp&&o(m,v))for(v.unz=0,D=0;D<d;D++)v.unz+=v.cp[D]}else v.unz=4*u[d]+d,v.lnz=v.unz;return v};function o(h,c){var l=h._ptr,s=h._index,u=h._size,f=u[0],d=u[1];c.pinv=[],c.leftmost=[];var D=c.parent,v=c.pinv,m=c.leftmost,p=[],w=0,g=f,A=f+d,F=f+2*d,y,C,b,E,S;for(C=0;C<d;C++)p[g+C]=-1,p[A+C]=-1,p[F+C]=0;for(y=0;y<f;y++)m[y]=-1;for(C=d-1;C>=0;C--)for(E=l[C],S=l[C+1],b=E;b<S;b++)m[s[b]]=C;for(y=f-1;y>=0;y--)v[y]=-1,C=m[y],C!==-1&&(p[F+C]++===0&&(p[A+C]=y),p[w+y]=p[g+C],p[g+C]=y);for(c.lnz=0,c.m2=f,C=0;C<d;C++)if(y=p[g+C],c.lnz++,y<0&&(y=c.m2++),v[y]=C,!(--F[C]<=0)){c.lnz+=p[F+C];var M=D[C];M!==-1&&(p[F+M]===0&&(p[A+M]=p[A+C]),p[w+p[A+C]]=p[g+M],p[g+M]=p[w+y],p[F+M]+=p[F+C])}for(y=0;y<f;y++)v[y]<0&&(v[y]=C++);return!0}});function kt(e,t){return e[t]<0}function oa(e,t){e[t]=Cr(e[t])}function sa(e){return e<0?Cr(e):e}function Nl(e,t,n,i,r){var a=t._index,o=t._ptr,h=t._size,c=h[1],l,s,u,f=0;for(i[0]=e;f>=0;){e=i[f];var d=r?r[e]:e;kt(o,e)||(oa(o,e),i[c+f]=d<0?0:sa(o[d]));var D=1;for(s=i[c+f],u=d<0?0:sa(o[d+1]);s<u;s++)if(l=a[s],!kt(o,l)){i[c+f]=s,i[++f]=l,D=0;break}D&&(f--,i[--n]=e)}return n}function xl(e,t,n,i,r){var a=e._ptr,o=e._size,h=t._index,c=t._ptr,l=o[1],s,u,f,d=l;for(u=c[n],f=c[n+1],s=u;s<f;s++){var D=h[s];kt(a,D)||(d=Nl(D,e,d,i,r))}for(s=d;s<l;s++)oa(a,i[s]);return d}var Bl="csSpsolve",_l=["divideScalar","multiply","subtract"],zl=j(Bl,_l,e=>{var{divideScalar:t,multiply:n,subtract:i}=e;return function(a,o,h,c,l,s,u){var f=a._values,d=a._index,D=a._ptr,v=a._size,m=v[1],p=o._values,w=o._index,g=o._ptr,A,F,y,C,b=xl(a,o,h,c,s);for(A=b;A<m;A++)l[c[A]]=0;for(F=g[h],y=g[h+1],A=F;A<y;A++)l[w[A]]=p[A];for(var E=b;E<m;E++){var S=c[E],M=s?s[S]:S;if(!(M<0))for(F=D[M],y=D[M+1],l[S]=t(l[S],f[u?F:y-1]),A=u?F+1:F,C=u?y:y-1;A<C;A++){var N=d[A];l[N]=i(l[N],n(f[A],l[S]))}}return b}}),Tl="csLu",Ol=["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],Il=j(Tl,Ol,e=>{var{abs:t,divideScalar:n,multiply:i,subtract:r,larger:a,largerEq:o,SparseMatrix:h}=e,c=zl({divideScalar:n,multiply:i,subtract:r});return function(s,u,f){if(!s)return null;var d=s._size,D=d[1],v,m=100,p=100;u&&(v=u.q,m=u.lnz||m,p=u.unz||p);var w=[],g=[],A=[],F=new h({values:w,index:g,ptr:A,size:[D,D]}),y=[],C=[],b=[],E=new h({values:y,index:C,ptr:b,size:[D,D]}),S=[],M,N,O=[],T=[];for(M=0;M<D;M++)O[M]=0,S[M]=-1,A[M+1]=0;m=0,p=0;for(var I=0;I<D;I++){A[I]=m,b[I]=p;var B=v?v[I]:I,G=c(F,s,B,T,O,S,1),$=-1,z=-1;for(N=G;N<D;N++)if(M=T[N],S[M]<0){var V=t(O[M]);a(V,z)&&(z=V,$=M)}else C[p]=S[M],y[p++]=O[M];if($===-1||z<=0)return null;S[B]<0&&o(t(O[B]),i(z,f))&&($=B);var W=O[$];for(C[p]=I,y[p++]=W,S[$]=I,g[m]=$,w[m++]=1,N=G;N<D;N++)M=T[N],S[M]<0&&(g[m]=M,w[m++]=n(O[M],W)),O[M]=0}for(A[D]=m,b[D]=p,N=0;N<m;N++)g[N]=S[g[N]];return w.splice(m,w.length-m),g.splice(m,g.length-m),y.splice(p,y.length-p),C.splice(p,C.length-p),{L:F,U:E,pinv:S}}}),fa="slu",Ll=["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],$l=j(fa,Ll,e=>{var{typed:t,abs:n,add:i,multiply:r,transpose:a,divideScalar:o,subtract:h,larger:c,largerEq:l,SparseMatrix:s}=e,u=Sl({add:i,multiply:r,transpose:a}),f=Il({abs:n,divideScalar:o,multiply:r,subtract:h,larger:c,largerEq:l,SparseMatrix:s});return t(fa,{"SparseMatrix, number, number":function(D,v,m){if(!Te(v)||v<0||v>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(m<0||m>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var p=u(v,D,!1),w=f(D,p,m);return{L:w.L,U:w.U,p:w.pinv,q:p.q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
p: `+this.p.toString()+(this.q?`
q: `+this.q.toString():"")+`
`}}}})});function ca(e,t){var n,i=t.length,r=[];if(e)for(n=0;n<i;n++)r[e[n]]=t[n];else for(n=0;n<i;n++)r[n]=t[n];return r}var la="lusolve",ql=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],Pl=j(la,ql,e=>{var{typed:t,matrix:n,lup:i,slu:r,usolve:a,lsolve:o,DenseMatrix:h}=e,c=Et({DenseMatrix:h});return t(la,{"Array, Array | Matrix":function(f,d){f=n(f);var D=i(f),v=s(D.L,D.U,D.p,null,d);return v.valueOf()},"DenseMatrix, Array | Matrix":function(f,d){var D=i(f);return s(D.L,D.U,D.p,null,d)},"SparseMatrix, Array | Matrix":function(f,d){var D=i(f);return s(D.L,D.U,D.p,null,d)},"SparseMatrix, Array | Matrix, number, number":function(f,d,D,v){var m=r(f,D,v);return s(m.L,m.U,m.p,m.q,d)},"Object, Array | Matrix":function(f,d){return s(f.L,f.U,f.p,f.q,d)}});function l(u){if(Be(u))return u;if(Me(u))return n(u);throw new TypeError("Invalid Matrix LU decomposition")}function s(u,f,d,D,v){u=l(u),f=l(f),d&&(v=c(u,v,!0),v._data=ca(d,v._data));var m=o(u,v),p=a(f,m);return D&&(p._data=ca(D,p._data)),p}}),ha="det",Rl=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],Ul=j(ha,Rl,e=>{var{typed:t,matrix:n,subtractScalar:i,multiply:r,divideScalar:a,isZero:o,unaryMinus:h}=e;return t(ha,{any:function(s){return Ce(s)},"Array | Matrix":function(s){var u;switch(Be(s)?u=s.size():Array.isArray(s)?(s=n(s),u=s.size()):u=[],u.length){case 0:return Ce(s);case 1:if(u[0]===1)return Ce(s.valueOf()[0]);if(u[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+$e(u)+")");case 2:{var f=u[0],d=u[1];if(f===d)return c(s.clone().valueOf(),f);if(d===0)return 1;throw new RangeError("Matrix must be square (size: "+$e(u)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+$e(u)+")")}}});function c(l,s,u){if(s===1)return Ce(l[0][0]);if(s===2)return i(r(l[0][0],l[1][1]),r(l[1][0],l[0][1]));for(var f=!1,d=new Array(s).fill(0).map((C,b)=>b),D=0;D<s;D++){var v=d[D];if(o(l[v][D])){var m=void 0;for(m=D+1;m<s;m++)if(!o(l[d[m]][D])){v=d[m],d[m]=d[D],d[D]=v,f=!f;break}if(m===s)return l[v][D]}for(var p=l[v][D],w=D===0?1:l[d[D-1]][D-1],g=D+1;g<s;g++)for(var A=d[g],F=D+1;F<s;F++)l[A][F]=a(i(r(l[A][F],p),r(l[A][D],l[v][F])),w)}var y=l[d[s-1]][s-1];return f?h(y):y}}),va="inv",Vl=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],Zl=j(va,Vl,e=>{var{typed:t,matrix:n,divideScalar:i,addScalar:r,multiply:a,unaryMinus:o,det:h,identity:c,abs:l}=e;return t(va,{"Array | Matrix":function(f){var d=Be(f)?f.size():qe(f);switch(d.length){case 1:if(d[0]===1)return Be(f)?n([i(1,f.valueOf()[0])]):[i(1,f[0])];throw new RangeError("Matrix must be square (size: "+$e(d)+")");case 2:{var D=d[0],v=d[1];if(D===v)return Be(f)?n(s(f.valueOf(),D,v),f.storage()):s(f,D,v);throw new RangeError("Matrix must be square (size: "+$e(d)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+$e(d)+")")}},any:function(f){return i(1,f)}});function s(u,f,d){var D,v,m,p,w;if(f===1){if(p=u[0][0],p===0)throw Error("Cannot calculate inverse, determinant is zero");return[[i(1,p)]]}else if(f===2){var g=h(u);if(g===0)throw Error("Cannot calculate inverse, determinant is zero");return[[i(u[1][1],g),i(o(u[0][1]),g)],[i(o(u[1][0]),g),i(u[0][0],g)]]}else{var A=u.concat();for(D=0;D<f;D++)A[D]=A[D].concat();for(var F=c(f).valueOf(),y=0;y<d;y++){var C=l(A[y][y]),b=y;for(D=y+1;D<f;)l(A[D][y])>C&&(C=l(A[D][y]),b=D),D++;if(C===0)throw Error("Cannot calculate inverse, determinant is zero");D=b,D!==y&&(w=A[y],A[y]=A[D],A[D]=w,w=F[y],F[y]=F[D],F[D]=w);var E=A[y],S=F[y];for(D=0;D<f;D++){var M=A[D],N=F[D];if(D!==y){if(M[y]!==0){for(m=i(o(M[y]),E[y]),v=y;v<d;v++)M[v]=r(M[v],a(m,E[v]));for(v=0;v<d;v++)N[v]=r(N[v],a(m,S[v]))}}else{for(m=E[y],v=y;v<d;v++)M[v]=i(M[v],m);for(v=0;v<d;v++)N[v]=i(N[v],m)}}}return F}}});function Gl(e){var{addScalar:t,subtract:n,flatten:i,multiply:r,multiplyScalar:a,divideScalar:o,sqrt:h,abs:c,bignumber:l,diag:s,size:u,reshape:f,inv:d,qr:D,usolve:v,usolveAll:m,equal:p,complex:w,larger:g,smaller:A,matrixFromColumns:F,dot:y}=e;function C(P,q,Z,ne){var k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=b(P,q,Z,ne,k);E(P,q,Z,ne,k,U);var{values:Q,C:X}=S(P,q,Z,ne,k);if(k){var J=M(P,q,X,U,Q,Z,ne);return{values:Q,eigenvectors:J}}return{values:Q}}function b(P,q,Z,ne,k){var U=ne==="BigNumber",Q=ne==="Complex",X=U?l(0):0,J=U?l(1):Q?w(1):1,ue=U?l(1):1,ee=U?l(10):2,oe=a(ee,ee),le;k&&(le=Array(q).fill(J));for(var pe=!1;!pe;){pe=!0;for(var ge=0;ge<q;ge++){for(var we=X,he=X,be=0;be<q;be++)ge!==be&&(we=t(we,c(P[be][ge])),he=t(he,c(P[ge][be])));if(!p(we,0)&&!p(he,0)){for(var Fe=ue,Se=we,Ge=o(he,ee),x=a(he,ee);A(Se,Ge);)Se=a(Se,oe),Fe=a(Fe,ee);for(;g(Se,x);)Se=o(Se,oe),Fe=o(Fe,ee);var _=A(o(t(Se,he),Fe),a(t(we,he),.95));if(_){pe=!1;for(var L=o(1,Fe),R=0;R<q;R++)ge!==R&&(P[ge][R]=a(P[ge][R],L),P[R][ge]=a(P[R][ge],Fe));k&&(le[ge]=a(le[ge],L))}}}}return k?s(le):null}function E(P,q,Z,ne,k,U){var Q=ne==="BigNumber",X=ne==="Complex",J=Q?l(0):X?w(0):0;Q&&(Z=l(Z));for(var ue=0;ue<q-2;ue++){for(var ee=0,oe=J,le=ue+1;le<q;le++){var pe=P[le][ue];A(c(oe),c(pe))&&(oe=pe,ee=le)}if(!A(c(oe),Z)){if(ee!==ue+1){var ge=P[ee];P[ee]=P[ue+1],P[ue+1]=ge;for(var we=0;we<q;we++){var he=P[we][ee];P[we][ee]=P[we][ue+1],P[we][ue+1]=he}if(k){var be=U[ee];U[ee]=U[ue+1],U[ue+1]=be}}for(var Fe=ue+2;Fe<q;Fe++){var Se=o(P[Fe][ue],oe);if(Se!==0){for(var Ge=0;Ge<q;Ge++)P[Fe][Ge]=n(P[Fe][Ge],a(Se,P[ue+1][Ge]));for(var x=0;x<q;x++)P[x][ue+1]=t(P[x][ue+1],a(Se,P[x][Fe]));if(k)for(var _=0;_<q;_++)U[Fe][_]=n(U[Fe][_],a(Se,U[ue+1][_]))}}}}return U}function S(P,q,Z,ne,k){var U=ne==="BigNumber",Q=ne==="Complex",X=U?l(1):Q?w(1):1;U&&(Z=l(Z));for(var J=Ce(P),ue=[],ee=q,oe=[],le=k?s(Array(q).fill(X)):void 0,pe=k?s(Array(ee).fill(X)):void 0,ge=0;ge<=100;){ge+=1;for(var we=J[ee-1][ee-1],he=0;he<ee;he++)J[he][he]=n(J[he][he],we);var{Q:be,R:Fe}=D(J);J=r(Fe,be);for(var Se=0;Se<ee;Se++)J[Se][Se]=t(J[Se][Se],we);if(k&&(pe=r(pe,be)),ee===1||A(c(J[ee-1][ee-2]),Z)){ge=0,ue.push(J[ee-1][ee-1]),k&&(oe.unshift([[1]]),T(pe,q),le=r(le,pe),ee>1&&(pe=s(Array(ee-1).fill(X)))),ee-=1,J.pop();for(var Ge=0;Ge<ee;Ge++)J[Ge].pop()}else if(ee===2||A(c(J[ee-2][ee-3]),Z)){ge=0;var x=N(J[ee-2][ee-2],J[ee-2][ee-1],J[ee-1][ee-2],J[ee-1][ee-1]);ue.push(...x),k&&(oe.unshift(O(J[ee-2][ee-2],J[ee-2][ee-1],J[ee-1][ee-2],J[ee-1][ee-1],x[0],x[1],Z,ne)),T(pe,q),le=r(le,pe),ee>2&&(pe=s(Array(ee-2).fill(X)))),ee-=2,J.pop(),J.pop();for(var _=0;_<ee;_++)J[_].pop(),J[_].pop()}if(ee===0)break}if(ue.sort((H,Y)=>+n(c(H),c(Y))),ge>100){var L=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+ue.join(", "));throw L.values=ue,L.vectors=[],L}var R=k?r(le,I(oe,q)):void 0;return{values:ue,C:R}}function M(P,q,Z,ne,k,U,Q){var X=d(Z),J=r(X,P,Z),ue=Q==="BigNumber",ee=Q==="Complex",oe=ue?l(0):ee?w(0):0,le=ue?l(1):ee?w(1):1,pe=[],ge=[];for(var we of k){var he=B(pe,we,p);he===-1?(pe.push(we),ge.push(1)):ge[he]+=1}for(var be=[],Fe=pe.length,Se=Array(q).fill(oe),Ge=s(Array(q).fill(le)),x=function(){var R=pe[_],H=n(J,r(R,Ge)),Y=m(H,Se);for(Y.shift();Y.length<ge[_];){var ae=G(H,q,Y,U,Q);if(ae===null)break;Y.push(ae)}var te=r(d(ne),Z);Y=Y.map(ie=>r(te,ie)),be.push(...Y.map(ie=>({value:R,vector:i(ie)})))},_=0;_<Fe;_++)x();return be}function N(P,q,Z,ne){var k=t(P,ne),U=n(a(P,ne),a(q,Z)),Q=a(k,.5),X=a(h(n(a(k,k),a(4,U))),.5);return[t(Q,X),n(Q,X)]}function O(P,q,Z,ne,k,U,Q,X){var J=X==="BigNumber",ue=X==="Complex",ee=J?l(0):ue?w(0):0,oe=J?l(1):ue?w(1):1;if(A(c(Z),Q))return[[oe,ee],[ee,oe]];if(g(c(n(k,U)),Q))return[[n(k,ne),n(U,ne)],[Z,Z]];var le=n(P,k),pe=n(ne,k);return A(c(q),Q)&&A(c(pe),Q)?[[le,oe],[Z,ee]]:[[q,ee],[pe,oe]]}function T(P,q){for(var Z=0;Z<P.length;Z++)P[Z].push(...Array(q-P[Z].length).fill(0));for(var ne=P.length;ne<q;ne++)P.push(Array(q).fill(0)),P[ne][ne]=1;return P}function I(P,q){for(var Z=[],ne=0;ne<q;ne++)Z[ne]=Array(q).fill(0);var k=0;for(var U of P){for(var Q=U.length,X=0;X<Q;X++)for(var J=0;J<Q;J++)Z[k+X][k+J]=U[X][J];k+=Q}return Z}function B(P,q,Z){for(var ne=0;ne<P.length;ne++)if(Z(P[ne],q))return ne;return-1}function G(P,q,Z,ne,k){for(var U=k==="BigNumber"?l(1e3):1e3,Q,X=0;X<5;++X){Q=$(q,Z,k);try{Q=v(P,Q)}catch{continue}if(g(V(Q),U))break}if(X>=5)return null;for(X=0;;){var J=v(P,Q);if(A(V(z(Q,[J])),ne))break;if(++X>=10)return null;Q=W(J)}return Q}function $(P,q,Z){var ne=Z==="BigNumber",k=Z==="Complex",U=Array(P).fill(0).map(Q=>2*Math.random()-1);return ne&&(U=U.map(Q=>l(Q))),k&&(U=U.map(Q=>w(Q))),U=z(U,q),W(U,Z)}function z(P,q){var Z=u(P);for(var ne of q)ne=f(ne,Z),P=n(P,r(o(y(ne,P),y(ne,ne)),ne));return P}function V(P){return c(h(y(P,P)))}function W(P,q){var Z=q==="BigNumber",ne=q==="Complex",k=Z?l(1):ne?w(1):1;return r(o(k,V(P)),P)}return C}function Yl(e){var{config:t,addScalar:n,subtract:i,abs:r,atan:a,cos:o,sin:h,multiplyScalar:c,inv:l,bignumber:s,multiply:u,add:f}=e;function d(E,S){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.epsilon,N=arguments.length>3?arguments[3]:void 0,O=arguments.length>4?arguments[4]:void 0;if(N==="number")return D(E,M,O);if(N==="BigNumber")return v(E,M,O);throw TypeError("Unsupported data type: "+N)}function D(E,S,M){var N=E.length,O=Math.abs(S/N),T,I;if(M){I=new Array(N);for(var B=0;B<N;B++)I[B]=Array(N).fill(0),I[B][B]=1}for(var G=y(E);Math.abs(G[1])>=Math.abs(O);){var $=G[0][0],z=G[0][1];T=m(E[$][$],E[z][z],E[$][z]),E=F(E,T,$,z),M&&(I=w(I,T,$,z)),G=y(E)}for(var V=Array(N).fill(0),W=0;W<N;W++)V[W]=E[W][W];return b(Ce(V),I,M)}function v(E,S,M){var N=E.length,O=r(S/N),T,I;if(M){I=new Array(N);for(var B=0;B<N;B++)I[B]=Array(N).fill(0),I[B][B]=1}for(var G=C(E);r(G[1])>=r(O);){var $=G[0][0],z=G[0][1];T=p(E[$][$],E[z][z],E[$][z]),E=A(E,T,$,z),M&&(I=g(I,T,$,z)),G=C(E)}for(var V=Array(N).fill(0),W=0;W<N;W++)V[W]=E[W][W];return b(Ce(V),I,M)}function m(E,S,M){var N=S-E;return Math.abs(N)<=t.epsilon?Math.PI/4:.5*Math.atan(2*M/(S-E))}function p(E,S,M){var N=i(S,E);return r(N)<=t.epsilon?s(-1).acos().div(4):c(.5,a(u(2,M,l(N))))}function w(E,S,M,N){for(var O=E.length,T=Math.cos(S),I=Math.sin(S),B=Array(O).fill(0),G=Array(O).fill(0),$=0;$<O;$++)B[$]=T*E[$][M]-I*E[$][N],G[$]=I*E[$][M]+T*E[$][N];for(var z=0;z<O;z++)E[z][M]=B[z],E[z][N]=G[z];return E}function g(E,S,M,N){for(var O=E.length,T=o(S),I=h(S),B=Array(O).fill(s(0)),G=Array(O).fill(s(0)),$=0;$<O;$++)B[$]=i(c(T,E[$][M]),c(I,E[$][N])),G[$]=n(c(I,E[$][M]),c(T,E[$][N]));for(var z=0;z<O;z++)E[z][M]=B[z],E[z][N]=G[z];return E}function A(E,S,M,N){for(var O=E.length,T=s(o(S)),I=s(h(S)),B=c(T,T),G=c(I,I),$=Array(O).fill(s(0)),z=Array(O).fill(s(0)),V=u(s(2),T,I,E[M][N]),W=n(i(c(B,E[M][M]),V),c(G,E[N][N])),P=f(c(G,E[M][M]),V,c(B,E[N][N])),q=0;q<O;q++)$[q]=i(c(T,E[M][q]),c(I,E[N][q])),z[q]=n(c(I,E[M][q]),c(T,E[N][q]));E[M][M]=W,E[N][N]=P,E[M][N]=s(0),E[N][M]=s(0);for(var Z=0;Z<O;Z++)Z!==M&&Z!==N&&(E[M][Z]=$[Z],E[Z][M]=$[Z],E[N][Z]=z[Z],E[Z][N]=z[Z]);return E}function F(E,S,M,N){for(var O=E.length,T=Math.cos(S),I=Math.sin(S),B=T*T,G=I*I,$=Array(O).fill(0),z=Array(O).fill(0),V=B*E[M][M]-2*T*I*E[M][N]+G*E[N][N],W=G*E[M][M]+2*T*I*E[M][N]+B*E[N][N],P=0;P<O;P++)$[P]=T*E[M][P]-I*E[N][P],z[P]=I*E[M][P]+T*E[N][P];E[M][M]=V,E[N][N]=W,E[M][N]=0,E[N][M]=0;for(var q=0;q<O;q++)q!==M&&q!==N&&(E[M][q]=$[q],E[q][M]=$[q],E[N][q]=z[q],E[q][N]=z[q]);return E}function y(E){for(var S=E.length,M=0,N=[0,1],O=0;O<S;O++)for(var T=O+1;T<S;T++)Math.abs(M)<Math.abs(E[O][T])&&(M=Math.abs(E[O][T]),N=[O,T]);return[N,M]}function C(E){for(var S=E.length,M=0,N=[0,1],O=0;O<S;O++)for(var T=O+1;T<S;T++)r(M)<r(E[O][T])&&(M=r(E[O][T]),N=[O,T]);return[N,M]}function b(E,S,M){var N=E.length,O=Array(N),T;if(M){T=Array(N);for(var I=0;I<N;I++)T[I]=Array(N)}for(var B=0;B<N;B++){for(var G=0,$=E[0],z=0;z<E.length;z++)r(E[z])<r($)&&(G=z,$=E[G]);if(O[B]=E.splice(G,1)[0],M)for(var V=0;V<N;V++)T[B][V]=S[V][G],S[V].splice(G,1)}if(!M)return{values:O};var W=T.map((P,q)=>({value:O[q],vector:P}));return{values:O,eigenvectors:W}}return d}var Jl="eigs",Ql=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],Xl=j(Jl,Ql,e=>{var{config:t,typed:n,matrix:i,addScalar:r,subtract:a,equal:o,abs:h,atan:c,cos:l,sin:s,multiplyScalar:u,divideScalar:f,inv:d,bignumber:D,multiply:v,add:m,larger:p,column:w,flatten:g,number:A,complex:F,sqrt:y,diag:C,size:b,reshape:E,qr:S,usolve:M,usolveAll:N,im:O,re:T,smaller:I,matrixFromColumns:B,dot:G}=e,$=Yl({config:t,addScalar:r,subtract:a,column:w,flatten:g,equal:o,abs:h,atan:c,cos:l,sin:s,multiplyScalar:u,inv:d,bignumber:D,complex:F,multiply:v,add:m}),z=Gl({config:t,addScalar:r,subtract:a,multiply:v,multiplyScalar:u,flatten:g,divideScalar:f,sqrt:y,abs:h,bignumber:D,diag:C,size:b,reshape:E,qr:S,inv:d,usolve:M,usolveAll:N,equal:o,complex:F,larger:p,smaller:I,matrixFromColumns:B,dot:G});return n("eigs",{Array:function(U){return V(i(U))},"Array, number|BigNumber":function(U,Q){return V(i(U),{precision:Q})},"Array, Object"(k,U){return V(i(k),U)},Matrix:function(U){return V(U,{matricize:!0})},"Matrix, number|BigNumber":function(U,Q){return V(U,{precision:Q,matricize:!0})},"Matrix, Object":function(U,Q){var X={matricize:!0};return Ye(X,Q),V(U,X)}});function V(k){var U,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X="eigenvectors"in Q?Q.eigenvectors:!0,J=(U=Q.precision)!==null&&U!==void 0?U:t.epsilon,ue=W(k,J,X);return Q.matricize&&(ue.values=i(ue.values),X&&(ue.eigenvectors=ue.eigenvectors.map(ee=>{var{value:oe,vector:le}=ee;return{value:oe,vector:i(le)}}))),X&&Object.defineProperty(ue,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),ue}function W(k,U,Q){var X=k.toArray(),J=k.size();if(J.length!==2||J[0]!==J[1])throw new RangeError("Matrix must be square (size: ".concat($e(J),")"));var ue=J[0];if(q(X,ue,U)&&(Z(X,ue),P(X,ue,U))){var ee=ne(k,X,ue);return $(X,ue,U,ee,Q)}var oe=ne(k,X,ue);return z(X,ue,U,oe,Q)}function P(k,U,Q){for(var X=0;X<U;X++)for(var J=X;J<U;J++)if(p(D(h(a(k[X][J],k[J][X]))),Q))return!1;return!0}function q(k,U,Q){for(var X=0;X<U;X++)for(var J=0;J<U;J++)if(p(D(h(O(k[X][J]))),Q))return!1;return!0}function Z(k,U){for(var Q=0;Q<U;Q++)for(var X=0;X<U;X++)k[Q][X]=T(k[Q][X])}function ne(k,U,Q){var X=k.datatype();if(X==="number"||X==="BigNumber"||X==="Complex")return X;for(var J=!1,ue=!1,ee=!1,oe=0;oe<Q;oe++)for(var le=0;le<Q;le++){var pe=U[oe][le];if(Le(pe)||Ot(pe))J=!0;else if(Re(pe))ue=!0;else if(Tt(pe))ee=!0;else throw TypeError("Unsupported type in Matrix: "+hr(pe))}if(ue&&ee&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),ee){for(var ge=0;ge<Q;ge++)for(var we=0;we<Q;we++)U[ge][we]=F(U[ge][we]);return"Complex"}if(ue){for(var he=0;he<Q;he++)for(var be=0;be<Q;be++)U[he][be]=D(U[he][be]);return"BigNumber"}if(J){for(var Fe=0;Fe<Q;Fe++)for(var Se=0;Se<Q;Se++)U[Fe][Se]=A(U[Fe][Se]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}}),Wr=Lo({config:ke}),Nt=Ro({}),jt=Go({}),en=Qo({}),Xe=Ko({Matrix:en}),se=qu({BigNumber:Wr,Complex:Nt,DenseMatrix:Xe,Fraction:jt}),kr=zs({typed:se}),br=Os({typed:se}),Hl=Wc({typed:se}),rn=Ds({BigNumber:Wr,typed:se}),tn=As({Complex:Nt,typed:se}),xt=Mf({typed:se}),Kl=jc({typed:se}),or=os({config:ke,typed:se}),Wl=Rf({typed:se}),kl=Nf({typed:se}),da=ko({typed:se}),jl=es({typed:se}),pa=ts({typed:se}),Mr=vf({typed:se}),nn=ps({typed:se}),e0=Bf({typed:se}),r0=gf({BigNumber:Wr,Fraction:jt,complex:tn,typed:se}),t0=rl({typed:se}),Ur=cs({Matrix:en,equalScalar:or,typed:se}),xr=Ls({typed:se}),n0=is({typed:se}),an=wf({Complex:Nt,config:ke,typed:se}),jr=Bs({typed:se}),ma=Cs({Fraction:jt,typed:se}),ye=Ms({DenseMatrix:Xe,Matrix:en,SparseMatrix:Ur,typed:se}),i0=lc({bignumber:rn,fraction:ma,number:nn}),a0=Qf({isInteger:da,matrix:ye,typed:se}),et=Hf({matrix:ye,config:ke,typed:se}),Br=Wf({matrix:ye,typed:se}),Ze=ic({matrix:ye,typed:se}),Ke=sc({BigNumber:Wr,config:ke,matrix:ye,typed:se}),_r=zf({isInteger:da,matrix:ye,typed:se}),u0=uc({conj:xt,transpose:Ze,typed:se}),o0=Lf({DenseMatrix:Xe,SparseMatrix:Ur,matrix:ye,typed:se}),gr=vc({numeric:i0,typed:se}),ga=Fc({DenseMatrix:Xe,concat:_r,equalScalar:or,matrix:ye,typed:se}),Da=qf({matrix:ye,typed:se}),rt=Vf({BigNumber:Wr,DenseMatrix:Xe,SparseMatrix:Ur,config:ke,matrix:ye,typed:se}),ya=Ic({DenseMatrix:Xe,concat:_r,config:ke,matrix:ye,typed:se}),s0=gc({DenseMatrix:Xe,divideScalar:gr,equalScalar:or,matrix:ye,multiplyScalar:Mr,subtractScalar:xr,typed:se}),f0=Ns({flatten:Da,matrix:ye,size:et,typed:se}),c0=vl({addScalar:br,complex:tn,conj:xt,divideScalar:gr,equal:ga,identity:rt,isZero:pa,matrix:ye,multiplyScalar:Mr,sign:r0,sqrt:an,subtractScalar:xr,typed:se,unaryMinus:jr,zeros:Ke}),tt=Mc({DenseMatrix:Xe,concat:_r,config:ke,matrix:ye,typed:se}),sr=Ef({DenseMatrix:Xe,concat:_r,equalScalar:or,matrix:ye,subtractScalar:xr,typed:se,unaryMinus:jr}),wa=yc({DenseMatrix:Xe,divideScalar:gr,equalScalar:or,matrix:ye,multiplyScalar:Mr,subtractScalar:xr,typed:se}),fr=nl({DenseMatrix:Xe,SparseMatrix:Ur,addScalar:br,concat:_r,equalScalar:or,matrix:ye,typed:se}),Aa=ol({addScalar:br,conj:xt,multiplyScalar:Mr,size:et,typed:se}),l0=Pc({DenseMatrix:Xe,smaller:tt}),Ea=Vc({ImmutableDenseMatrix:l0,getMatrixDataType:Wl}),Vr=zc({DenseMatrix:Xe,concat:_r,config:ke,matrix:ye,typed:se}),fe=pf({addScalar:br,dot:Aa,equalScalar:or,matrix:ye,multiplyScalar:Mr,typed:se}),h0=$l({SparseMatrix:Ur,abs:kr,add:fr,divideScalar:gr,larger:Vr,largerEq:ya,multiply:fe,subtract:sr,transpose:Ze,typed:se}),Ae=jf({add:fr,matrix:ye,typed:se,zeros:Ke}),v0=Ac({DenseMatrix:Xe,divideScalar:gr,equalScalar:or,matrix:ye,multiplyScalar:Mr,subtractScalar:xr,typed:se}),d0=Ul({divideScalar:gr,isZero:pa,matrix:ye,multiply:fe,subtractScalar:xr,typed:se,unaryMinus:jr}),p0=Yc({larger:Vr,smaller:tt}),De=fl({Index:Ea,typed:se}),m0=xc({DenseMatrix:Xe,concat:_r,config:ke,matrix:ye,typed:se}),Zr=Yf({bignumber:rn,matrix:ye,add:fr,config:ke,isPositive:jl,larger:Vr,largerEq:ya,smaller:tt,smallerEq:m0,typed:se}),g0=Xc({FibonacciHeap:p0,addScalar:br,equalScalar:or}),D0=Of({Index:Ea,matrix:ye,range:Zr,typed:se}),dr=Zl({abs:kr,addScalar:br,det:d0,divideScalar:gr,identity:rt,matrix:ye,multiply:fe,typed:se,unaryMinus:jr}),y0=ll({DenseMatrix:Xe,Spa:g0,SparseMatrix:Ur,abs:kr,addScalar:br,divideScalar:gr,equalScalar:or,larger:Vr,matrix:ye,multiplyScalar:Mr,subtractScalar:xr,typed:se,unaryMinus:jr}),w0=pc({Complex:Nt,config:ke,fraction:ma,identity:rt,inv:dr,matrix:ye,multiply:fe,number:nn,typed:se}),A0=Pl({DenseMatrix:Xe,lsolve:s0,lup:y0,matrix:ye,slu:h0,typed:se,usolve:wa}),E0=Xl({abs:kr,add:fr,addScalar:br,atan:Hl,bignumber:rn,column:D0,complex:tn,config:ke,cos:Kl,diag:o0,divideScalar:gr,dot:Aa,equal:ga,flatten:Da,im:kl,inv:dr,larger:Vr,matrix:ye,matrixFromColumns:f0,multiply:fe,multiplyScalar:Mr,number:nn,qr:c0,re:e0,reshape:a0,sin:t0,size:et,smaller:tt,sqrt:an,subtract:sr,typed:se,usolve:wa,usolveAll:v0}),Fa=al({abs:kr,add:fr,conj:xt,ctranspose:u0,eigs:E0,equalScalar:or,larger:Vr,matrix:ye,multiply:fe,pow:w0,smaller:tt,sqrt:an,typed:se});class Ca{constructor(t,n,i=[0,0,0],r=[]){ce(this,"label");ce(this,"domain");ce(this,"coords");ce(this,"bcs");ce(this,"lcs");this.label=t.toString(),this.domain=n,this.coords=i,this.bcs=new Set(r),this.lcs=void 0}change(t,n,i=[]){t!=null&&(this.label=t.toString()),n!=null&&(this.coords=n),i!=null&&(this.bcs=new Set(i))}change2(t){t.label!=null&&(this.label=t.label.toString()),t.coords!=null&&(this.coords=t.coords),t.bcs!=null&&(this.bcs=new Set(t.bcs)),t.lcs!=null&&this.updateLcs(t.lcs)}getLocationArray(t){return this.domain.solver.getNodeLocationArray(this.label,t)}getUnknowns(t,n){const i=this.getLocationArray(n);return Ae(t.r,De(i))}getEigenValueUnknowns(t,n,i){const r=this.getLocationArray(n);return Ae(t.eigenVectors[i],De(r))}getTransformationMtrx(t){const n=t.length;if(this.lcs==null)return rt(n);{const i=Ke([n,n]);for(let r=0;r<n;r++){const a=t[r];switch(a){case Pe.Dx:case Pe.Dy:case Pe.Dz:for(let o=0;o<n;o++){const h=t[o];(h==Pe.Dx||h==Pe.Dy||h==Pe.Dz)&&(i[r][o]=this.lcs[h][a])}break;case Pe.Rx:case Pe.Ry:case Pe.Rz:for(let o=0;o<n;o++){const h=t[o];(h==Pe.Rx||h==Pe.Ry||h==Pe.Rz)&&(i[r][o]=this.lcs[h-Pe.Rx][a-Pe.Rx])}break;default:throw new TypeError("Unknown DofID: "+a)}}return ye(i)}}updateLcs(t){if(t==null)this.lcs=void 0;else{this.lcs=[[0,0,0],[0,0,0],[0,0,0]];const n=Fa(t.locx),i=Fa(t.locy);for(let r=0;r<3;r++)this.lcs[0][r]=t.locx[r]/n,this.lcs[1][r]=t.locy[r]/i;this.lcs[2][0]=this.lcs[0][1]*this.lcs[1][2]-this.lcs[0][2]*this.lcs[1][1],this.lcs[2][1]=this.lcs[0][2]*this.lcs[1][0]-this.lcs[0][0]*this.lcs[1][2],this.lcs[2][2]=this.lcs[0][0]*this.lcs[1][1]-this.lcs[0][1]*this.lcs[1][0]}}hasLcs(){return this.lcs!=null}getReactions(t,n=!1){if(n&&this.hasLcs()){const i=this.domain.solver.getNodeDofIDs(this.label),r=this.getLocationArray(i),a=[];for(let h=0;h<i.length;h++)this.bcs.has(i[h])?a.push(Ae(t.R,De([r[h]-this.domain.solver.neq]))):a.push(0);const o=this.getTransformationMtrx(i);return{dofs:i,values:fe(o,a).toArray()}}else if(this.bcs.size>0){const i=Array.from(this.bcs),r=this.getLocationArray(i),a=sr(r,this.domain.solver.neq),o=Ae(t.R,De(a));return n0(o)==="number"?{dofs:i,values:[o]}:{dofs:i,values:o}}else return{dofs:[],values:[]}}}class ba{constructor(t,n,i,r,a){ce(this,"label");ce(this,"nodes");ce(this,"mat");ce(this,"cs");ce(this,"domain");this.label=t.toString(),this.nodes=i.map(o=>o.toString()),this.mat=r.toString(),this.cs=a.toString(),this.domain=n}change(t,n,i,r){t!=null&&(this.label=t.toString()),n!=null&&(this.nodes=n.map(a=>a.toString())),i!=null&&(this.mat=i.toString()),r!=null&&(this.cs=r.toString())}getMaterial(){return this.domain.getMaterial(this.mat)}getCS(){return this.domain.getCS(this.cs)}getNodeDofs(t){return[]}computeStiffness(){}computeMassMatrix(){}getLocationArray(){}computeGeo(){}computeT(){return ye()}}class Ma extends ba{constructor(n,i,r,a,o,h=[!1,!1]){super(n,i,r,a,o);ce(this,"hinges");ce(this,"diagonalMassMatrix",!1);this.hinges=h}getNodeDofs(n){return[Pe.Dx,Pe.Dz,Pe.Ry]}getLocationArray(){let n=Array();for(const i of this.nodes)n=n.concat(this.domain.solver.getNodeLocationArray(i,[Pe.Dx,Pe.Dz,Pe.Ry]));return n}computeGeo(){const n=this.domain.getNode(this.nodes[0]).coords,i=this.domain.getNode(this.nodes[1]).coords,r=i[0]-n[0],a=i[2]-n[2];return{l:Math.sqrt(r*r+a*a),dx:r,dz:a}}hasHinges(){return this.hinges[0]||this.hinges[1]}computeT(){const n=this.computeGeo(),i=n.dx/n.l,r=n.dz/n.l;let a=ye([[i,r,0,0,0,0],[-r,i,0,0,0,0],[0,0,1,0,0,0],[0,0,0,i,r,0],[0,0,0,-r,i,0],[0,0,0,0,0,1]]);if(this.domain.getNode(this.nodes[0]).hasLcs()||this.domain.getNode(this.nodes[1]).hasLcs()){let o=Ke(6);o=Ae(o,De([0,1,2],[0,1,2]),this.domain.getNode(this.nodes[0]).getTransformationMtrx(this.getNodeDofs(this.nodes[0]))),o=Ae(o,De([3,4,5],[3,4,5]),this.domain.getNode(this.nodes[1]).getTransformationMtrx(this.getNodeDofs(this.nodes[1]))),a=fe(a,o)}return a}computeLocalStiffnessMtrx(n=!1){const i=this.computeGeo(),r=this.getMaterial(),a=this.getCS(),o=r.e*a.a,h=r.e*a.iy,c=i.l,l=c*c,s=l*c,u=12*h/(a.k*r.g*a.a*c*c),f=1+u,d=ye([[o/c,0,0,-o/c,0,0],[0,12*h/s/f,-6*h/l/f,0,-12*h/s/f,-6*h/l/f],[0,-6*h/l/f,(4+u)*h/c/f,0,6*h/l/f,(2-u)*h/c/f],[-o/c,0,0,o/c,0,0],[0,-12*h/s/f,6*h/l/f,0,12*h/s/f,6*h/l/f],[0,-6*h/l/f,(2-u)*h/c/f,0,6*h/l/f,(4+u)*h/c/f]]);if(this.hasHinges()){if(this.hinges[0]&&this.hinges[1])var D=[0,1,3,4],v=[2,5];else if(this.hinges[0])var D=[0,1,3,4,5],v=[2];else if(this.hinges[1])var D=[0,1,2,3,4],v=[5];const m=d.subset(De(D,D)),p=d.subset(De(D,v)),w=d.subset(De(v,v)),g=sr(m,fe(fe(p,dr(w)),Ze(p)));let A=Ke(6,6);return A=Ae(A,De(D,D),g),n?{answer:A,a:D,b:v,kaa:m,kab:p,kbb:w}:{answer:A}}return{answer:d}}computeLocalInitialStressMtrx(n){const i=this.computeGeo(),r=this.getMaterial(),a=this.getCS(),o=i.l,h=o*o,c=n/o,l=12*r.e*a.iy/(a.k*r.g*a.a*o*o),s=l*l,u=ye([[0,0,0,0,0,0],[0,6/5+2*l+s,-o/10,0,-6/5-2*l-s,-o/10],[0,-o/10,2*h/15+h*l/6+h*s/12,0,o/10,-h/30-h*l/6-h*s/12],[0,0,0,0,0,0],[0,-6/5-2*l-s,o/10,0,6/5+2*l+s,o/10],[0,-o/10,-h/30-h*l/6-h*s/12,0,o/10,2*h/15+h*l/6+h*s/12]]);fe(u,c/(1+l)/(1+l));const f=Math.min(Math.abs(u[1][1]),Math.abs(u[2][2]))/1e3;if(u[0][0]=f,u[0][3]=-f,u[3][0]=-f,u[3][3]=f,this.hasHinges()){const d=this.computeLocalStiffnessMtrx(!0),D=et(d.a)[0],v=Ke(6,D);Ae(v,De(d.a,Zr(0,D)),rt(D)),Ae(v,De(d.b,Zr(0,D)),fe(fe(dr(d.kbb),Ze(d.kab)),-1));const m=fe(Ze(v),fe(u,v)),p=Ke(6,6);return Ae(d.a,De(d.a,d.a),m),p}return u}computeLocalMassMatrix(n=!1){const i=this.computeGeo(),r=this.getMaterial(),a=this.getCS(),o=i.l,h=o*o;if(!this.diagonalMassMatrix)return fe(r.d*a.a*o/420,ye([[140,0,0,70,0,0],[0,156,-22*o,0,54,13*o],[0,-22*o,4*o*o,0,-13*o,-3*o*o],[70,0,0,140,0,0],[0,54,-13*o,0,156,22*o],[0,13*o,-3*o*o,0,22*o,4*o*o]]));const c=1/78;return fe(r.d*a.a*o,ye([[1/2,0,0,0,0,0],[0,1/2,0,0,0,0],[0,0,c*h,0,0,0],[0,0,0,1/2,0,0],[0,0,0,0,1/2,0],[0,0,0,0,0,c*h]]))}computeStiffness(){this.computeGeo();const n=this.computeLocalStiffnessMtrx(),i=this.computeT();return fe(fe(Ze(i),n.answer),i)}computeMassMatrix(){this.computeGeo();const n=this.computeLocalMassMatrix(),i=this.computeT();return fe(fe(Ze(i),n),i)}computeInitialStressMatrix(n){const i=this.computeLocalInitialStressMtrx(n),r=this.computeT();return fe(fe(Ze(r),i),r)}computeEndDisplacement(n){const i=this.computeT(),r=this.getLocationArray();let a=fe(i,Ae(n.r,De(r)));if(this.hasHinges()){const o=this.computeLocalStiffnessMtrx(!0);let h=Ke(6);for(const c of n.getElementLoadsOnElement(this.label))h=fr(h,c.getLoadVectorForClampedBeam());this.hasHinges()&&(a=Ae(a,De(o.b),fe(dr(o.kbb),fe(fr(Ae(h,De(o.b)),Br(fe(Ze(o.kab),Ae(a,De(o.a))))),-1))))}return a}computeEndForces(n){const i=this.computeT(),r=this.getLocationArray(),a=fe(i,Ae(n.r,De(r))),o=this.computeLocalStiffnessMtrx(!0);let h=fe(o.answer,a),c=Ke(6);for(const l of n.getElementLoadsOnElement(this.label))c=fr(c,l.getLoadVectorForClampedBeam());if(this.hasHinges()){const l=fe(o.kab,dr(o.kbb));if(o.b.length==1){const s=c.get(o.b);for(let u=0;u<o.a.length;u++)h.set([o.a[u]],h.get([o.a[u]])+c.get([o.a[u]])-l.get([u,0])*s)}else{const s=sr(Ae(c,De(o.a)),fe(l,Ae(c,De(o.b))));h=fr(h,Ae(h,De(o.a),s))}}else h=fr(h,c);return h}computeLocalDefl(n,i){const r=this.computeEndDisplacement(n),a=[],o=[],c=this.computeGeo().l,l=n.getElementLoadsOnElement(this.label);for(let s=0;s<=i;s++){const u=s/i;let f=(1-3*u*u+2*u*u*u)*r.get([1])+c*(-u+2*u*u-u*u*u)*r.get([2])+(3*u*u-2*u*u*u)*r.get([4])+c*(u*u-u*u*u)*r.get([5]),d=(1-u)*r.get([0])+u*r.get([3]);for(const D of l){const v=D.computeBeamDeflectionContrib(u);f+=v.w,d+=v.u}a.push(d),o.push(f)}return{u:a,w:o}}computeGlobalDefl(n,i){const r=this.computeLocalDefl(n,i),a=this.computeGeo(),o=a.dx/a.l,h=a.dz/a.l,c=[],l=[];for(let s=0;s<=i;s++)c.push(r.u[s]*o-r.w[s]*h),l.push(r.w[s]*o+r.u[s]*h);return{u:c,w:l}}computeEndDisplacementEigenMode(n,i){const r=this.computeT(),a=this.getLocationArray();let o=fe(r,Ae(n.eigenVectors[i],De(a)));if(this.hasHinges()){const h=this.computeLocalStiffnessMtrx(!0),c=Ke(6);this.hasHinges()&&(o=Ae(o,De(h.b),fe(dr(h.kbb),fe(fr(Ae(c,De(h.b)),Br(fe(Ze(h.kab),Ae(o,De(h.a))))),-1))))}return o}computeLocalEigenMode(n,i,r){const a=this.computeEndDisplacementEigenMode(n,i),o=[],h=[],l=this.computeGeo().l;for(let s=0;s<=r;s++){const u=s/r,f=(1-3*u*u+2*u*u*u)*a.get([1])+l*(-u+2*u*u-u*u*u)*a.get([2])+(3*u*u-2*u*u*u)*a.get([4])+l*(u*u-u*u*u)*a.get([5]),d=(1-u)*a.get([0])+u*a.get([3]);o.push(d),h.push(f)}return{u:o,w:h}}computeGlobalEigenMode(n,i,r){const a=this.computeLocalEigenMode(n,i,r),o=this.computeGeo(),h=o.dx/o.l,c=o.dz/o.l,l=[],s=[];for(let u=0;u<=r;u++)l.push(a.u[u]*h-a.w[u]*c),s.push(a.w[u]*h+a.u[u]*c);return{u:l,w:s}}computeNormalForce(n,i){const r=this.computeEndForces(n),a=this.computeGeo(),o=[],h=[],c=n.getElementLoadsOnElement(this.label);for(let l=0;l<=i;l++){const s=a.l*l/i;let u=-r.get([0]);for(const f of c)u+=f.computeBeamNContrib(s);o.push(s),h.push(u)}return{x:o,N:h}}computeNormalForceAt(n,i){const r=this.computeEndForces(n),a=n.getElementLoadsOnElement(this.label);let o=-r.get([0]);for(const h of a)o+=h.computeBeamNContrib(i);return o}computeShearForce(n,i){const r=this.computeEndForces(n),a=this.computeGeo(),o=[],h=[],c=n.getElementLoadsOnElement(this.label);for(let l=0;l<=i;l++){const s=a.l*l/i;let u=-r.get([1]);for(const f of c)u+=f.computeBeamVContrib(s);o.push(s),h.push(u)}return{x:o,V:h}}computeShearForceAt(n,i){const r=this.computeEndForces(n),a=n.getElementLoadsOnElement(this.label);let o=-r.get([1]);for(const h of a)o+=h.computeBeamVContrib(i);return o}computeBendingMoment(n,i){const r=this.computeEndForces(n),a=this.computeGeo(),o=[],h=[],c=n.getElementLoadsOnElement(this.label);for(let l=0;l<=i;l++){const s=a.l*l/i;let u=-r.get([2])-r.get([1])*s;for(const f of c)u+=f.computeBeamMContrib(s);o.push(s),h.push(u)}return{x:o,M:h}}computeBendingMomentAt(n,i){const r=this.computeEndForces(n),a=n.getElementLoadsOnElement(this.label);let o=-r.get([2])-r.get([1])*i;for(const h of a)o+=h.computeBeamMContrib(i);return o}}class un{constructor(t,n){ce(this,"target");ce(this,"domain");this.target=t.toString(),this.domain=n}getLoadVector(){return[]}getLocationArray(){return[]}}class Sa extends un{constructor(n,i,r={}){super(n,i);ce(this,"values");this.values=r}change(n,i){this.target=n.toString(),this.values=i}getLoadVector(){const n=this.domain.solver.getNodeDofIDs(this.target),i=Array();for(const r of n)r in this.values?i.push(this.values[r]):i.push(0);return i}getLocationArray(){return this.domain.solver.getNodeLocationArray(this.target,this.domain.solver.getNodeDofIDs(this.target))}}class Bt extends un{getLoadVectorForClampedBeam(){return[]}computeBeamDeflectionContrib(t){return{u:0,w:0}}computeBeamNContrib(t){return 0}computeBeamVContrib(t){return 0}computeBeamMContrib(t){return 0}}class Na extends Bt{constructor(n,i,r,a){super(n,i);ce(this,"values");ce(this,"lcs");this.values=r,this.lcs=a}change(n,i,r){this.target=n.toString(),this.values=i,this.lcs=r}getGlobalIntensities(){const n=this.values[0],i=this.values[1];if(this.lcs){const r=this.domain.getElement(this.target).computeGeo(),a=r.dx/r.l,o=r.dz/r.l;return{fx:n*a-i*o,fz:n*o+i*a,my:0}}else return{fx:n,fz:i,my:0}}getLocalIntensities(){const n=this.values[0],i=this.values[1],r=this.domain.getElement(this.target).computeGeo(),a=r.l,o=r.dx,h=r.dz,c=o/a,l=h/a;return this.lcs?{fx:n,fz:i}:{fx:n*c+i*l,fz:-n*l+i*c}}getLoadVectorForClampedBeam(){const i=this.domain.getElement(this.target).computeGeo().l,r=this.values[3],a=i-r;return[-a/i*this.values[0],a/i*(r*(r-a)/i/i-1)*this.values[1],r*a*a/i/i*this.values[1],-r/i*this.values[0],r/i*(a*(a-r)/i/i-1)*this.values[1],-r*r*a/i/i*this.values[1]]}getLocationArray(){return this.domain.getElement(this.target).getLocationArray()}getLoadVector(){const n=this.domain.getElement(this.target),i=n.computeT(),r=this.getLoadVectorForClampedBeam();if(n.hasHinges()){const a=n.computeLocalStiffnessMtrx(!0);let o=[0,0,0,0,0,0];const h=fe(a.kab,dr(a.kbb));if(a.b.length==1){const c=r[a.b[0]];for(let l=0;l<a.a.length;l++)o[a.a[l]]=r[a.a[l]]-h.get([l,0])*c;return fe(fe(Ze(i),o),-1).toArray()}else{const c=sr(Ae(r,De(a.a)),fe(h,Ae(r,De(a.b))));return o=Ae(o,De(a.a),c),fe(fe(Ze(i),o),-1).toArray()}}else return fe(fe(Ze(i),r),-1).toArray()}computeBeamDeflectionContrib(n){const i=this.getLocalIntensities(),o=this.domain.elements.get(this.target).computeGeo().l,h=i.fx,c=i.fz,l=this.domain.getElement(this.target).getMaterial().e,s=this.domain.getElement(this.target).getCS().a,u=this.domain.getElement(this.target).getCS().iy,f=this.values[3],d=o-f,D=d/o*(f*(f-d)/o/o-1)*c,v=f*d*d/o/o*c,m=l*u,p=l*s,w=n*o;let g=0,A=0;return w<f?g+=d/o*h*w/p:g+=d/o*h*f/p-f/o*h*(w-f)/p,w>f?A=(D*Math.pow(w,3)/6+v*Math.pow(w,2)/2+c*Math.pow(w-f,3)/6)/m:A=(D*Math.pow(w,3)/6+v*Math.pow(w,2)/2)/m,{u:g,w:A}}computeBeamNContrib(n){const i=this.getLocalIntensities(),r=this.values[3];return n<r?0:-i.fx}computeBeamVContrib(n){const i=this.getLocalIntensities(),r=this.values[3];return n<r?0:-i.fz}computeBeamMContrib(n){const i=this.getLocalIntensities(),r=this.values[3];return n<r?0:-i.fz*(n-r)}}class xa extends Bt{constructor(n,i,r,a){super(n,i);ce(this,"values");ce(this,"lcs");this.values=r,this.lcs=a}change(n,i,r){this.target=n.toString(),this.values=i,this.lcs=r}getGlobalIntensities(){const n=this.values[0],i=this.values[1];if(this.lcs){const r=this.domain.getElement(this.target).computeGeo(),a=r.dx/r.l,o=r.dz/r.l;return{fx:n*a-i*o,fz:n*o+i*a,my:0}}else return{fx:n,fz:i,my:0}}getLocalIntensities(){const n=this.values[0],i=this.values[1],r=this.domain.getElement(this.target).computeGeo(),a=r.l,o=r.dx,h=r.dz,c=o/a,l=h/a;return this.lcs?{fx:n,fz:i}:{fx:n*c+i*l,fz:-n*l+i*c}}getLoadVectorForClampedBeam(){const n=this.domain.getElement(this.target).computeGeo(),i=this.getLocalIntensities(),r=i.fx,a=i.fz,o=n.l;return[-.5*o*r,-.5*o*a,1/12*a*o*o,-.5*o*r,-.5*o*a,-1/12*a*o*o]}getLocationArray(){return this.domain.getElement(this.target).getLocationArray()}getLoadVector(){const n=this.domain.getElement(this.target),i=n.computeT(),r=this.getLoadVectorForClampedBeam();if(n.hasHinges()){const a=n.computeLocalStiffnessMtrx(!0);let o=[0,0,0,0,0,0];const h=fe(a.kab,dr(a.kbb));if(a.b.length==1){const c=r[a.b[0]];for(let l=0;l<a.a.length;l++)o[a.a[l]]=r[a.a[l]]-h.get([l,0])*c;return fe(fe(Ze(i),o),-1).toArray()}else{const c=sr(Ae(r,De(a.a)),fe(h,Ae(r,De(a.b))));return o=Ae(o,De(a.a),c),fe(fe(Ze(i),o),-1).toArray()}}else return fe(fe(Ze(i),r),-1).toArray()}computeBeamDeflectionContrib(n){const i=this.getLocalIntensities(),r=this.domain.elements.get(this.target),o=r.computeGeo().l;return{u:0,w:i.fz*o*o*o*o*(n*n*n*n/24-n*n*n/12+n*n/24)/(r.getMaterial().e*r.getCS().iy)}}computeBeamNContrib(n){return-this.getLocalIntensities().fx*n}computeBeamVContrib(n){return-this.getLocalIntensities().fz*n}computeBeamMContrib(n){return-this.getLocalIntensities().fz*n*n/2}}class Ba extends Bt{constructor(n,i,r){super(n,i);ce(this,"values");this.values=r}change(n,i){this.target=n.toString(),this.values=i}getLoadVectorForClampedBeam(){const n=this.domain.getElement(this.target).getMaterial(),i=this.domain.getElement(this.target).getCS(),r=n.e,a=n.alpha,o=i.a,h=i.iy,c=i.h,l=this.values[1]-this.values[2];return[+r*o*a*this.values[0],0,+(r*h*a*l)/c,-r*o*a*this.values[0],0,-(r*h*a*l)/c]}getLocationArray(){return this.domain.getElement(this.target).getLocationArray()}getLoadVector(){const n=this.domain.getElement(this.target),i=n.computeT(),r=this.getLoadVectorForClampedBeam();if(n.hasHinges()){const a=n.computeLocalStiffnessMtrx(!0);let o=[0,0,0,0,0,0];const h=fe(a.kab,dr(a.kbb));if(a.b.length==1){const c=r[a.b[0]];for(let l=0;l<a.a.length;l++)o[a.a[l]]=r[a.a[l]]-h.get([l,0])*c;return fe(fe(Ze(i),o),-1).toArray()}else{const c=sr(Ae(r,De(a.a)),fe(h,Ae(r,De(a.b))));return o=Ae(o,De(a.a),c),fe(fe(Ze(i),o),-1).toArray()}}else return fe(fe(Ze(i),r),-1).toArray()}computeBeamDeflectionContrib(n){return{u:0,w:0}}computeBeamNContrib(n){return 0}computeBeamVContrib(n){return 0}computeBeamMContrib(n){return 0}}class _a{constructor(t,n,i){ce(this,"target");ce(this,"prescribedValues");ce(this,"domain");this.target=t.toString(),this.prescribedValues=i,this.domain=n}getNodePrescribedDisplacementVector(){const t=new Array,n=this.domain.solver.getNodeDofIDs(this.target);for(const i of n)i in this.prescribedValues?t.push(this.prescribedValues[i]):t.push(0);return t}getLocationArray(){return this.domain.solver.getNodeLocationArray(this.target,this.domain.solver.getNodeDofIDs(this.target))}}const F0={};class za{constructor(t,n={}){ce(this,"label");ce(this,"a");ce(this,"iy");ce(this,"iz");ce(this,"dyz");ce(this,"h");ce(this,"k");ce(this,"j");this.label=t.toString(),n={...F0,...n},this.a=n.a,this.iy=n.iy,this.iz=n.iz,this.dyz=n.dyz,this.h=n.h,this.k=n.k,this.j=n.j}change(t){t.a!=null&&(this.a=t.a),t.iy!=null&&(this.iy=t.iy),t.iz!=null&&(this.iz=t.iz),t.dyz!=null&&(this.dyz=t.dyz),t.h!=null&&(this.h=t.h),t.k!=null&&(this.k=t.k),t.j!=null&&(this.j=t.j)}}const C0={e:1,g:1,alpha:1,d:1};class Ta{constructor(t,n={}){ce(this,"label");ce(this,"e");ce(this,"g");ce(this,"alpha");ce(this,"d");this.label=t.toString(),n={...C0,...n},this.e=n.e,this.g=n.g,this.alpha=n.alpha,this.d=n.d}change(t){t.e!==void 0&&(this.e=t.e),t.g!==void 0&&(this.g=t.g),t.alpha!==void 0&&(this.alpha=t.alpha),t.d!==void 0&&(this.d=t.d)}}class Oa{constructor(t){ce(this,"solver");ce(this,"nodes",new Map);ce(this,"elements",new Map);ce(this,"materials",new Map);ce(this,"crossSections",new Map);this.solver=t}getNode(t){const n=t.toString();if(this.nodes.has(n))return this.nodes.get(n);throw new RangeError("Node label "+t+" does not exists")}getElement(t){const n=t.toString();if(this.elements.has(n))return this.elements.get(n);throw new RangeError("Element label "+t+" does not exists")}getMaterial(t){const n=t.toString();if(this.materials.has(n))return this.materials.get(n);throw new RangeError("Material label "+t+" does not exists")}getCS(t){const n=t.toString();if(this.crossSections.has(n))return this.crossSections.get(n);throw new RangeError("CrossSection label "+t+" does not exists")}createNode(t,n=[0,0,0],i=[]){const r=new Ca(t,this,n,i);return this.nodes.set(t.toString(),r),r}createBeam2D(t,n,i,r,a=[!1,!1]){const o=new Ma(t,this,n,i,r,a);return this.elements.set(t.toString(),o),o}createMaterial(t,n={}){const i=new Ta(t,n);return this.materials.set(t.toString(),i),i}createCrossSection(t,n={}){const i=new za(t,n);return this.crossSections.set(t.toString(),i),i}}class Ia{constructor(){ce(this,"domain");ce(this,"neq");ce(this,"pneq");ce(this,"k");ce(this,"m");ce(this,"f");ce(this,"loadCases",new Array);ce(this,"codeNumberGenerated",!1);ce(this,"nodeCodeNumbers",new Map);this.domain=new Oa(this),this.loadCases.push(new La("DefaultLC",this.domain))}getNodeLocationArray(t,n){let i=[];for(const r of n)i=i.concat(this.nodeCodeNumbers.get(t)[r]);return i}getNodeDofIDs(t){const n=[];for(const i in this.nodeCodeNumbers.get(t))n.push(parseInt(i));return n}generateCodeNumbers(){const t=new Map;for(const[r,a]of this.domain.nodes)this.nodeCodeNumbers.set(r,{}),t.set(r,new Set);for(const[r,a]of this.domain.elements)for(const o of a.nodes){const h=a.getNodeDofs(o);for(const c of h)if(t.has(o))t.get(o).add(c);else throw console.log(o,o in t,t.get(o)),new RangeError("Node label "+o+" does not exists")}this.neq=0,this.pneq=0;for(const[r,a]of this.domain.nodes)for(const o of t.get(r))a.bcs.has(o)?this.pneq++:this.neq++;let n=0,i=this.neq;for(const[r,a]of this.domain.nodes)for(const o of t.get(r))a.bcs.has(o)?this.nodeCodeNumbers.get(r)[o]=i++:this.nodeCodeNumbers.get(r)[o]=n++;this.codeNumberGenerated=!0}assembleVecLC(t,n,i,r){for(let a=0;a<i.length;a++)t.set([i[a],r],t.get([i[a],r])+n[a])}assembleVec(t,n,i){for(let r=0;r<i.length;r++)t.set([i[r]],t.get([i[r]])+n[r])}}class b0 extends Ia{assemble(){this.k=Ke(this.neq+this.pneq,this.neq+this.pneq);for(const[t,n]of this.domain.elements){const i=n.computeStiffness(),r=n.getLocationArray(),a=et(r)[0];for(let o=0;o<a;o++){const h=r[o];for(let c=0;c<a;c++){const l=r[c];this.k.set([h,l],this.k.get([h,l])+i.get([o,c]))}}}this.f=Ke(this.neq+this.pneq,this.loadCases.length);for(let t=0;t<this.loadCases.length;t++){this.loadCases[t].r=Ke(this.neq+this.pneq);const n=this.loadCases[t];for(const i of n.nodalLoadList)this.assembleVecLC(this.f,i.getLoadVector(),i.getLocationArray(),t);for(const i of n.elementLoadList)this.assembleVecLC(this.f,i.getLoadVector(),i.getLocationArray(),t);for(const i of n.prescribedBC)this.assembleVec(n.r,i.getNodePrescribedDisplacementVector(),i.getLocationArray())}}solve(){const t=new Date;this.codeNumberGenerated||this.generateCodeNumbers();const n=Zr(0,this.neq),i=Zr(this.neq,this.neq+this.pneq);if(this.assemble(),this.neq>0)for(let o=0;o<this.loadCases.length;o++){this.loadCases[o].solved=!1;const h=Ae(this.loadCases[o].r,De(i)),c=fe(Ae(this.k,De(n,i)),h);let l=Ae(this.k,De(n,n));typeof l=="number"&&(l=ye([[l]]));let s=Ae(this.f,De(n,[o]));typeof s=="number"&&(s=ye([s]));const u=sr(Br(s),c),f=Br(A0(l,u));this.loadCases[o].r=Ae(this.loadCases[o].r,De(Zr(0,this.neq)),f),this.loadCases[o].R=Ae(fe(this.k,this.loadCases[o].r),De(i)),this.loadCases[o].R=sr(this.loadCases[o].R,Br(Ae(this.f,De(i,[o])))),this.loadCases[o].solved=!0}else for(let o=0;o<this.loadCases.length;o++)this.loadCases[o].R=Br(fe(this.k,this.loadCases[o].r)),this.loadCases[o].R=sr(this.loadCases[o].R,Br(Ae(this.f,De(i,[o])))),this.loadCases[o].solved=!0;const a=new Date().getTime()-t.getTime();console.log("Solution took ",Math.round(a*100)/100," [ms]")}}class La{constructor(t,n){ce(this,"label");ce(this,"domain");ce(this,"bcMap",{});ce(this,"nodalLoadList",new Array);ce(this,"elementLoadList",new Array);ce(this,"prescribedBC",new Array);ce(this,"r",Ke(0));ce(this,"R",Ke(0));ce(this,"eigenNumbers",[]);ce(this,"eigenVectors",[]);ce(this,"solved",!1);this.label=t,this.domain=n}getElementLoadsOnElement(t){const n=[];for(const i of this.elementLoadList)i.target==t&&n.push(i);return n}createNodalLoad(t,n={}){const i=new Sa(t,this.domain,n);return this.nodalLoadList.push(i),i}createBeamElementUniformEdgeLoad(t,n,i){const r=new xa(t,this.domain,n,i);return this.elementLoadList.push(r),r}createBeamConcentratedLoad(t,n,i){const r=new Na(t,this.domain,n,i);return this.elementLoadList.push(r),r}createBeamTemperatureLoad(t,n){const i=new Ba(t,this.domain,n);return this.elementLoadList.push(i),i}createPrescribedDisplacement(t,n){const i=new _a(t,this.domain,n);return this.prescribedBC.push(i),i}}var Pe=(e=>(e[e.Dx=0]="Dx",e[e.Dy=1]="Dy",e[e.Dz=2]="Dz",e[e.Rx=3]="Rx",e[e.Ry=4]="Ry",e[e.Rz=5]="Rz",e))(Pe||{});xe.Beam2D=Ma,xe.BeamConcentratedLoad=Na,xe.BeamElementLoad=Bt,xe.BeamElementUniformEdgeLoad=xa,xe.BeamTemperatureLoad=Ba,xe.CrossSection=za,xe.DofID=Pe,xe.Domain=Oa,xe.Element=ba,xe.LinearStaticSolver=b0,xe.Load=un,xe.LoadCase=La,xe.Material=Ta,xe.NodalLoad=Sa,xe.Node=Ca,xe.PrescribedDisplacement=_a,xe.Solver=Ia,Object.defineProperty(xe,Symbol.toStringTag,{value:"Module"})});
