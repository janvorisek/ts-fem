(function(Or,Gr){typeof exports=="object"&&typeof module<"u"?Gr(exports):typeof define=="function"&&define.amd?define(["exports"],Gr):(Or=typeof globalThis<"u"?globalThis:Or||self,Gr(Or["ts-fem"]={}))})(this,function(Or){"use strict";var rv=Object.defineProperty;var ev=(Or,Gr,ge)=>Gr in Or?rv(Or,Gr,{enumerable:!0,configurable:!0,writable:!0,value:ge}):Or[Gr]=ge;var lr=(Or,Gr,ge)=>(ev(Or,typeof Gr!="symbol"?Gr+"":Gr,ge),ge);function Gr(){return Gr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Gr.apply(this,arguments)}var ge={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function $r(r){return typeof r=="number"}function Rr(r){return!r||typeof r!="object"||typeof r.constructor!="function"?!1:r.isBigNumber===!0&&typeof r.constructor.prototype=="object"&&r.constructor.prototype.isBigNumber===!0||typeof r.constructor.isDecimal=="function"&&r.constructor.isDecimal(r)===!0}function zt(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isComplex===!0||!1}function Tt(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isFraction===!0||!1}function un(r){return r&&r.constructor.prototype.isUnit===!0||!1}function ne(r){return typeof r=="string"}var Mr=Array.isArray;function xr(r){return r&&r.constructor.prototype.isMatrix===!0||!1}function at(r){return Array.isArray(r)||xr(r)}function on(r){return r&&r.isDenseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function sn(r){return r&&r.isSparseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function fn(r){return r&&r.constructor.prototype.isRange===!0||!1}function ut(r){return r&&r.constructor.prototype.isIndex===!0||!1}function Ia(r){return typeof r=="boolean"}function $a(r){return r&&r.constructor.prototype.isResultSet===!0||!1}function qa(r){return r&&r.constructor.prototype.isHelp===!0||!1}function La(r){return typeof r=="function"}function Pa(r){return r instanceof Date}function Ra(r){return r instanceof RegExp}function cn(r){return!!(r&&typeof r=="object"&&r.constructor===Object&&!zt(r)&&!Tt(r))}function Ua(r){return r===null}function Va(r){return r===void 0}function Za(r){return r&&r.isAccessorNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ga(r){return r&&r.isArrayNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ya(r){return r&&r.isAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ja(r){return r&&r.isBlockNode===!0&&r.constructor.prototype.isNode===!0||!1}function Qa(r){return r&&r.isConditionalNode===!0&&r.constructor.prototype.isNode===!0||!1}function Xa(r){return r&&r.isConstantNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ka(r){return r&&r.isFunctionAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ha(r){return r&&r.isFunctionNode===!0&&r.constructor.prototype.isNode===!0||!1}function Wa(r){return r&&r.isIndexNode===!0&&r.constructor.prototype.isNode===!0||!1}function ka(r){return r&&r.isNode===!0&&r.constructor.prototype.isNode===!0||!1}function ja(r){return r&&r.isObjectNode===!0&&r.constructor.prototype.isNode===!0||!1}function ru(r){return r&&r.isOperatorNode===!0&&r.constructor.prototype.isNode===!0||!1}function eu(r){return r&&r.isParenthesisNode===!0&&r.constructor.prototype.isNode===!0||!1}function tu(r){return r&&r.isRangeNode===!0&&r.constructor.prototype.isNode===!0||!1}function nu(r){return r&&r.isRelationalNode===!0&&r.constructor.prototype.isNode===!0||!1}function iu(r){return r&&r.isSymbolNode===!0&&r.constructor.prototype.isNode===!0||!1}function au(r){return r&&r.constructor.prototype.isChain===!0||!1}function ce(r){var e=typeof r;return e==="object"?r===null?"null":Rr(r)?"BigNumber":r.constructor&&r.constructor.name?r.constructor.name:"Object":e}function Fr(r){var e=typeof r;if(e==="number"||e==="string"||e==="boolean"||r===null||r===void 0)return r;if(typeof r.clone=="function")return r.clone();if(Array.isArray(r))return r.map(function(n){return Fr(n)});if(r instanceof Date)return new Date(r.valueOf());if(Rr(r))return r;if(cn(r))return uu(r,Fr);throw new TypeError("Cannot clone: unknown type of value (value: ".concat(r,")"))}function uu(r,e){var n={};for(var i in r)Ye(r,i)&&(n[i]=e(r[i]));return n}function ou(r,e){for(var n in e)Ye(e,n)&&(r[n]=e[n]);return r}function ze(r,e){var n,i,t;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(i=0,t=r.length;i<t;i++)if(!ze(r[i],e[i]))return!1;return!0}else{if(typeof r=="function")return r===e;if(r instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(n in r)if(!(n in e)||!ze(r[n],e[n]))return!1;for(n in e)if(!(n in r))return!1;return!0}else return r===e}}function Ye(r,e){return r&&Object.hasOwnProperty.call(r,e)}function su(r,e){for(var n={},i=0;i<e.length;i++){var t=e[i],a=r[t];a!==void 0&&(n[t]=a)}return n}var fu=["Matrix","Array"],cu=["number","BigNumber","Fraction"],Wr=function(e){if(e)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(ge)};Gr(Wr,ge,{MATRIX_OPTIONS:fu,NUMBER_OPTIONS:cu});function ln(){return!0}function ie(){return!1}function Te(){}const vn="Argument is not a typed-function.";function hn(){function r(x){return typeof x=="object"&&x!==null&&x.constructor===Object}const e=[{name:"number",test:function(x){return typeof x=="number"}},{name:"string",test:function(x){return typeof x=="string"}},{name:"boolean",test:function(x){return typeof x=="boolean"}},{name:"Function",test:function(x){return typeof x=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(x){return x instanceof Date}},{name:"RegExp",test:function(x){return x instanceof RegExp}},{name:"Object",test:r},{name:"null",test:function(x){return x===null}},{name:"undefined",test:function(x){return x===void 0}}],n={name:"any",test:ln,isAny:!0};let i,t,a=0,o={createCount:0};function v(x){const _=i.get(x);if(_)return _;let $='Unknown type "'+x+'"';const R=x.toLowerCase();let K;for(K of t)if(K.toLowerCase()===R){$+='. Did you mean "'+K+'" ?';break}throw new TypeError($)}function c(x){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any";const $=_?v(_).index:t.length,R=[];for(let Y=0;Y<x.length;++Y){if(!x[Y]||typeof x[Y].name!="string"||typeof x[Y].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");const ar=x[Y].name;if(i.has(ar))throw new TypeError('Duplicate type name "'+ar+'"');R.push(ar),i.set(ar,{name:ar,test:x[Y].test,isAny:x[Y].isAny,index:$+Y,conversionsTo:[]})}const K=t.slice($);t=t.slice(0,$).concat(R).concat(K);for(let Y=$+R.length;Y<t.length;++Y)i.get(t[Y]).index=Y}function l(){i=new Map,t=[],a=0,c([n],!1)}l(),c(e);function s(){let x;for(x of t)i.get(x).conversionsTo=[];a=0}function u(x){const _=t.filter($=>{const R=i.get($);return!R.isAny&&R.test(x)});return _.length?_:["any"]}function f(x){return x&&typeof x=="function"&&"_typedFunctionData"in x}function p(x,_,$){if(!f(x))throw new TypeError(vn);const R=$&&$.exact,K=Array.isArray(_)?_.join(","):_,Y=E(K),ar=m(Y);if(!R||ar in x.signatures){const _r=x._typedFunctionData.signatureMap.get(ar);if(_r)return _r}const tr=Y.length;let ir;if(R){ir=[];let _r;for(_r in x.signatures)ir.push(x._typedFunctionData.signatureMap.get(_r))}else ir=x._typedFunctionData.signatures;for(let _r=0;_r<tr;++_r){const Ir=Y[_r],Ur=[];let re;for(re of ir){const Hr=b(re.params,_r);if(!(!Hr||Ir.restParam&&!Hr.restParam)){if(!Hr.hasAny){const se=g(Hr);if(Ir.types.some(fe=>!se.has(fe.name)))continue}Ur.push(re)}}if(ir=Ur,ir.length===0)break}let er;for(er of ir)if(er.params.length<=tr)return er;throw new TypeError("Signature not found (signature: "+(x.name||"unnamed")+"("+m(Y,", ")+"))")}function D(x,_,$){return p(x,_,$).implementation}function h(x,_){const $=v(_);if($.test(x))return x;const R=$.conversionsTo;if(R.length===0)throw new Error("There are no conversions to "+_+" defined.");for(let K=0;K<R.length;K++)if(v(R[K].from).test(x))return R[K].convert(x);throw new Error("Cannot convert "+x+" to "+_)}function m(x){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return x.map($=>$.name).join(_)}function d(x){const _=x.indexOf("...")===0,R=(_?x.length>3?x.slice(3):"any":x).split("|").map(tr=>v(tr.trim()));let K=!1,Y=_?"...":"";return{types:R.map(function(tr){return K=tr.isAny||K,Y+=tr.name+"|",{name:tr.name,typeIndex:tr.index,test:tr.test,isAny:tr.isAny,conversion:null,conversionIndex:-1}}),name:Y.slice(0,-1),hasAny:K,hasConversion:!1,restParam:_}}function w(x){const _=x.types.map(ar=>ar.name),$=G(_);let R=x.hasAny,K=x.name;const Y=$.map(function(ar){const tr=v(ar.from);return R=tr.isAny||R,K+="|"+ar.from,{name:ar.from,typeIndex:tr.index,test:tr.test,isAny:tr.isAny,conversion:ar,conversionIndex:ar.index}});return{types:x.types.concat(Y),name:K,hasAny:R,hasConversion:Y.length>0,restParam:x.restParam}}function g(x){return x.typeSet||(x.typeSet=new Set,x.types.forEach(_=>x.typeSet.add(_.name))),x.typeSet}function E(x){const _=[];if(typeof x!="string")throw new TypeError("Signatures must be strings");const $=x.trim();if($==="")return _;const R=$.split(",");for(let K=0;K<R.length;++K){const Y=d(R[K].trim());if(Y.restParam&&K!==R.length-1)throw new SyntaxError('Unexpected rest parameter "'+R[K]+'": only allowed for the last parameter');if(Y.types.length===0)return null;_.push(Y)}return _}function F(x){const _=X(x);return _?_.restParam:!1}function y(x){if(!x||x.types.length===0)return ln;if(x.types.length===1)return v(x.types[0].name).test;if(x.types.length===2){const _=v(x.types[0].name).test,$=v(x.types[1].name).test;return function(K){return _(K)||$(K)}}else{const _=x.types.map(function($){return v($.name).test});return function(R){for(let K=0;K<_.length;K++)if(_[K](R))return!0;return!1}}}function C(x){let _,$,R;if(F(x)){_=Q(x).map(y);const K=_.length,Y=y(X(x)),ar=function(tr){for(let ir=K;ir<tr.length;ir++)if(!Y(tr[ir]))return!1;return!0};return function(ir){for(let er=0;er<_.length;er++)if(!_[er](ir[er]))return!1;return ar(ir)&&ir.length>=K+1}}else return x.length===0?function(Y){return Y.length===0}:x.length===1?($=y(x[0]),function(Y){return $(Y[0])&&Y.length===1}):x.length===2?($=y(x[0]),R=y(x[1]),function(Y){return $(Y[0])&&R(Y[1])&&Y.length===2}):(_=x.map(y),function(Y){for(let ar=0;ar<_.length;ar++)if(!_[ar](Y[ar]))return!1;return Y.length===_.length})}function b(x,_){return _<x.length?x[_]:F(x)?X(x):null}function A(x,_){const $=b(x,_);return $?g($):new Set}function S(x){return x.conversion===null||x.conversion===void 0}function M(x,_){const $=new Set;return x.forEach(R=>{const K=A(R.params,_);let Y;for(Y of K)$.add(Y)}),$.has("any")?["any"]:Array.from($)}function N(x,_,$){let R,K;const Y=x||"unnamed";let ar=$,tr;for(tr=0;tr<_.length;tr++){const Ir=[];if(ar.forEach(Ur=>{const re=b(Ur.params,tr),Hr=y(re);(tr<Ur.params.length||F(Ur.params))&&Hr(_[tr])&&Ir.push(Ur)}),Ir.length===0){if(K=M(ar,tr),K.length>0){const Ur=u(_[tr]);return R=new TypeError("Unexpected type of argument in function "+Y+" (expected: "+K.join(" or ")+", actual: "+Ur.join(" | ")+", index: "+tr+")"),R.data={category:"wrongType",fn:Y,index:tr,actual:Ur,expected:K},R}}else ar=Ir}const ir=ar.map(function(Ir){return F(Ir.params)?1/0:Ir.params.length});if(_.length<Math.min.apply(null,ir))return K=M(ar,tr),R=new TypeError("Too few arguments in function "+Y+" (expected: "+K.join(" or ")+", index: "+_.length+")"),R.data={category:"tooFewArgs",fn:Y,index:_.length,expected:K},R;const er=Math.max.apply(null,ir);if(_.length>er)return R=new TypeError("Too many arguments in function "+Y+" (expected: "+er+", actual: "+_.length+")"),R.data={category:"tooManyArgs",fn:Y,index:_.length,expectedLength:er},R;const _r=[];for(let Ir=0;Ir<_.length;++Ir)_r.push(u(_[Ir]).join("|"));return R=new TypeError('Arguments of type "'+_r.join(", ")+'" do not match any of the defined signatures of function '+Y+"."),R.data={category:"mismatch",actual:_r},R}function O(x){let _=t.length+1;for(let $=0;$<x.types.length;$++)S(x.types[$])&&(_=Math.min(_,x.types[$].typeIndex));return _}function T(x){let _=a+1;for(let $=0;$<x.types.length;$++)S(x.types[$])||(_=Math.min(_,x.types[$].conversionIndex));return _}function I(x,_){if(x.hasAny){if(!_.hasAny)return 1}else if(_.hasAny)return-1;if(x.restParam){if(!_.restParam)return 1}else if(_.restParam)return-1;if(x.hasConversion){if(!_.hasConversion)return 1}else if(_.hasConversion)return-1;const $=O(x)-O(_);if($<0)return-1;if($>0)return 1;const R=T(x)-T(_);return R<0?-1:R>0?1:0}function B(x,_){const $=x.params,R=_.params,K=X($),Y=X(R),ar=F($),tr=F(R);if(ar&&K.hasAny){if(!tr||!Y.hasAny)return 1}else if(tr&&Y.hasAny)return-1;let ir=0,er=0,_r;for(_r of $)_r.hasAny&&++ir,_r.hasConversion&&++er;let Ir=0,Ur=0;for(_r of R)_r.hasAny&&++Ir,_r.hasConversion&&++Ur;if(ir!==Ir)return ir-Ir;if(ar&&K.hasConversion){if(!tr||!Y.hasConversion)return 1}else if(tr&&Y.hasConversion)return-1;if(er!==Ur)return er-Ur;if(ar){if(!tr)return 1}else if(tr)return-1;const re=($.length-R.length)*(ar?-1:1);if(re!==0)return re;const Hr=[];let se=0;for(let Ge=0;Ge<$.length;++Ge){const Bt=I($[Ge],R[Ge]);Hr.push(Bt),se+=Bt}if(se!==0)return se;let fe;for(fe of Hr)if(fe!==0)return fe;return 0}function G(x){if(x.length===0)return[];const _=x.map(v);x.length>1&&_.sort((K,Y)=>K.index-Y.index);let $=_[0].conversionsTo;if(x.length===1)return $;$=$.concat([]);const R=new Set(x);for(let K=1;K<_.length;++K){let Y;for(Y of _[K].conversionsTo)R.has(Y.from)||($.push(Y),R.add(Y.from))}return $}function q(x,_){let $=_;if(x.some(K=>K.hasConversion)){const K=F(x),Y=x.map(z);$=function(){const tr=[],ir=K?arguments.length-1:arguments.length;for(let er=0;er<ir;er++)tr[er]=Y[er](arguments[er]);return K&&(tr[ir]=arguments[ir].map(Y[ir])),_.apply(this,tr)}}let R=$;if(F(x)){const K=x.length-1;R=function(){return $.apply(this,J(arguments,0,K).concat([J(arguments,K)]))}}return R}function z(x){let _,$,R,K;const Y=[],ar=[];switch(x.types.forEach(function(tr){tr.conversion&&(Y.push(v(tr.conversion.from).test),ar.push(tr.conversion.convert))}),ar.length){case 0:return function(ir){return ir};case 1:return _=Y[0],R=ar[0],function(ir){return _(ir)?R(ir):ir};case 2:return _=Y[0],$=Y[1],R=ar[0],K=ar[1],function(ir){return _(ir)?R(ir):$(ir)?K(ir):ir};default:return function(ir){for(let er=0;er<ar.length;er++)if(Y[er](ir))return ar[er](ir);return ir}}}function V(x){function _($,R,K){if(R<$.length){const Y=$[R];let ar=[];if(Y.restParam){const tr=Y.types.filter(S);tr.length<Y.types.length&&ar.push({types:tr,name:"..."+tr.map(ir=>ir.name).join("|"),hasAny:tr.some(ir=>ir.isAny),hasConversion:!1,restParam:!0}),ar.push(Y)}else ar=Y.types.map(function(tr){return{types:[tr],name:tr.name,hasAny:tr.isAny,hasConversion:tr.conversion,restParam:!1}});return rr(ar,function(tr){return _($,R+1,K.concat([tr]))})}else return[K]}return _(x,0,[])}function W(x,_){const $=Math.max(x.length,_.length);for(let tr=0;tr<$;tr++){const ir=A(x,tr),er=A(_,tr);let _r=!1,Ir;for(Ir of er)if(ir.has(Ir)){_r=!0;break}if(!_r)return!1}const R=x.length,K=_.length,Y=F(x),ar=F(_);return Y?ar?R===K:K>=R:ar?R>=K:R===K}function P(x){return x.map(_=>yr(_)?pr(_.referToSelf.callback):gr(_)?fr(_.referTo.references,_.referTo.callback):_)}function L(x,_,$){const R=[];let K;for(K of x){let Y=$[K];if(typeof Y!="number")throw new TypeError('No definition for referenced signature "'+K+'"');if(Y=_[Y],typeof Y!="function")return!1;R.push(Y)}return R}function Z(x,_,$){const R=P(x),K=new Array(R.length).fill(!1);let Y=!0;for(;Y;){Y=!1;let ar=!0;for(let tr=0;tr<R.length;++tr){if(K[tr])continue;const ir=R[tr];if(yr(ir))R[tr]=ir.referToSelf.callback($),R[tr].referToSelf=ir.referToSelf,K[tr]=!0,ar=!1;else if(gr(ir)){const er=L(ir.referTo.references,R,_);er?(R[tr]=ir.referTo.callback.apply(this,er),R[tr].referTo=ir.referTo,K[tr]=!0,ar=!1):Y=!0}}if(ar&&Y)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return R}function nr(x){const _=/\bthis(\(|\.signatures\b)/;Object.keys(x).forEach($=>{const R=x[$];if(_.test(R.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function k(x,_){if(o.createCount++,Object.keys(_).length===0)throw new SyntaxError("No signatures provided");o.warnAgainstDeprecatedThis&&nr(_);const $=[],R=[],K={},Y=[];let ar;for(ar in _){if(!Object.prototype.hasOwnProperty.call(_,ar))continue;const Nr=E(ar);if(!Nr)continue;$.forEach(function(it){if(W(it,Nr))throw new TypeError('Conflicting signatures "'+m(it)+'" and "'+m(Nr)+'".')}),$.push(Nr);const ee=R.length;R.push(_[ar]);const k0=Nr.map(w);let _t;for(_t of V(k0)){const it=m(_t);Y.push({params:_t,name:it,fn:ee}),_t.every(j0=>!j0.hasConversion)&&(K[it]=ee)}}Y.sort(B);const tr=Z(R,K,nt);let ir;for(ir in K)Object.prototype.hasOwnProperty.call(K,ir)&&(K[ir]=tr[K[ir]]);const er=[],_r=new Map;for(ir of Y)_r.has(ir.name)||(ir.fn=tr[ir.fn],er.push(ir),_r.set(ir.name,ir));const Ir=er[0]&&er[0].params.length<=2&&!F(er[0].params),Ur=er[1]&&er[1].params.length<=2&&!F(er[1].params),re=er[2]&&er[2].params.length<=2&&!F(er[2].params),Hr=er[3]&&er[3].params.length<=2&&!F(er[3].params),se=er[4]&&er[4].params.length<=2&&!F(er[4].params),fe=er[5]&&er[5].params.length<=2&&!F(er[5].params),Ge=Ir&&Ur&&re&&Hr&&se&&fe;for(let Nr=0;Nr<er.length;++Nr)er[Nr].test=C(er[Nr].params);const Bt=Ir?y(er[0].params[0]):ie,C0=Ur?y(er[1].params[0]):ie,b0=re?y(er[2].params[0]):ie,M0=Hr?y(er[3].params[0]):ie,S0=se?y(er[4].params[0]):ie,N0=fe?y(er[5].params[0]):ie,x0=Ir?y(er[0].params[1]):ie,B0=Ur?y(er[1].params[1]):ie,_0=re?y(er[2].params[1]):ie,z0=Hr?y(er[3].params[1]):ie,T0=se?y(er[4].params[1]):ie,O0=fe?y(er[5].params[1]):ie;for(let Nr=0;Nr<er.length;++Nr)er[Nr].implementation=q(er[Nr].params,er[Nr].fn);const I0=Ir?er[0].implementation:Te,$0=Ur?er[1].implementation:Te,q0=re?er[2].implementation:Te,L0=Hr?er[3].implementation:Te,P0=se?er[4].implementation:Te,R0=fe?er[5].implementation:Te,U0=Ir?er[0].params.length:-1,V0=Ur?er[1].params.length:-1,Z0=re?er[2].params.length:-1,G0=Hr?er[3].params.length:-1,Y0=se?er[4].params.length:-1,J0=fe?er[5].params.length:-1,Q0=Ge?6:0,X0=er.length,K0=er.map(Nr=>Nr.test),H0=er.map(Nr=>Nr.implementation),W0=function(){for(let ee=Q0;ee<X0;ee++)if(K0[ee](arguments))return H0[ee].apply(this,arguments);return o.onMismatch(x,arguments,er)};function nt(Nr,ee){return arguments.length===U0&&Bt(Nr)&&x0(ee)?I0.apply(this,arguments):arguments.length===V0&&C0(Nr)&&B0(ee)?$0.apply(this,arguments):arguments.length===Z0&&b0(Nr)&&_0(ee)?q0.apply(this,arguments):arguments.length===G0&&M0(Nr)&&z0(ee)?L0.apply(this,arguments):arguments.length===Y0&&S0(Nr)&&T0(ee)?P0.apply(this,arguments):arguments.length===J0&&N0(Nr)&&O0(ee)?R0.apply(this,arguments):W0.apply(this,arguments)}try{Object.defineProperty(nt,"name",{value:x})}catch{}return nt.signatures=K,nt._typedFunctionData={signatures:er,signatureMap:_r},nt}function U(x,_,$){throw N(x,_,$)}function Q(x){return J(x,0,x.length-1)}function X(x){return x[x.length-1]}function J(x,_,$){return Array.prototype.slice.call(x,_,$)}function ur(x,_){for(let $=0;$<x.length;$++)if(_(x[$]))return x[$]}function rr(x,_){return Array.prototype.concat.apply([],x.map(_))}function or(){const x=Q(arguments).map($=>m(E($))),_=X(arguments);if(typeof _!="function")throw new TypeError("Callback function expected as last argument");return fr(x,_)}function fr(x,_){return{referTo:{references:x,callback:_}}}function pr(x){if(typeof x!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:x}}}function gr(x){return x&&typeof x.referTo=="object"&&Array.isArray(x.referTo.references)&&typeof x.referTo.callback=="function"}function yr(x){return x&&typeof x.referToSelf=="object"&&typeof x.referToSelf.callback=="function"}function cr(x,_){if(!x)return _;if(_&&_!==x){const $=new Error("Function names do not match (expected: "+x+", actual: "+_+")");throw $.data={actual:_,expected:x},$}return x}function Cr(x){let _;for(const $ in x)Object.prototype.hasOwnProperty.call(x,$)&&(f(x[$])||typeof x[$].signature=="string")&&(_=cr(_,x[$].name));return _}function Er(x,_){let $;for($ in _)if(Object.prototype.hasOwnProperty.call(_,$)){if($ in x&&_[$]!==x[$]){const R=new Error('Signature "'+$+'" is defined twice');throw R.data={signature:$,sourceFunction:_[$],destFunction:x[$]},R}x[$]=_[$]}}const Sr=o;o=function(x){const _=typeof x=="string",$=_?1:0;let R=_?x:"";const K={};for(let Y=$;Y<arguments.length;++Y){const ar=arguments[Y];let tr={},ir;if(typeof ar=="function"?(ir=ar.name,typeof ar.signature=="string"?tr[ar.signature]=ar:f(ar)&&(tr=ar.signatures)):r(ar)&&(tr=ar,_||(ir=Cr(ar))),Object.keys(tr).length===0){const er=new TypeError("Argument to 'typed' at index "+Y+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw er.data={index:Y,argument:ar},er}_||(R=cr(R,ir)),Er(K,tr)}return k(R||"",K)},o.create=hn,o.createCount=Sr.createCount,o.onMismatch=U,o.throwMismatchError=U,o.createError=N,o.clear=l,o.clearConversions=s,o.addTypes=c,o._findType=v,o.referTo=or,o.referToSelf=pr,o.convert=h,o.findSignature=p,o.find=D,o.isTypedFunction=f,o.warnAgainstDeprecatedThis=!0,o.addType=function(x,_){let $="any";_!==!1&&i.has("Object")&&($="Object"),o.addTypes([x],$)};function Zr(x){if(!x||typeof x.from!="string"||typeof x.to!="string"||typeof x.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(x.to===x.from)throw new SyntaxError('Illegal to define conversion from "'+x.from+'" to itself.')}return o.addConversion=function(x){Zr(x);const _=v(x.to);if(_.conversionsTo.every(function($){return $.from!==x.from}))_.conversionsTo.push({from:x.from,convert:x.convert,index:a++});else throw new Error('There is already a conversion from "'+x.from+'" to "'+_.name+'"')},o.addConversions=function(x){x.forEach(o.addConversion)},o.removeConversion=function(x){Zr(x);const _=v(x.to),$=ur(_.conversionsTo,K=>K.from===x.from);if(!$)throw new Error("Attempt to remove nonexistent conversion from "+x.from+" to "+x.to);if($.convert!==x.convert)throw new Error("Conversion to remove does not match existing conversion");const R=_.conversionsTo.indexOf($);_.conversionsTo.splice(R,1)},o.resolve=function(x,_){if(!f(x))throw new TypeError(vn);const $=x._typedFunctionData.signatures;for(let R=0;R<$.length;++R)if($[R].test(_))return $[R];return null},o}const pn=hn();function zr(r){return typeof r=="boolean"?!0:isFinite(r)?r===Math.round(r):!1}var lu=Math.sign||function(r){return r>0?1:r<0?-1:0};function Ot(r,e,n){var i={2:"0b",8:"0o",16:"0x"},t=i[e],a="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!zr(n))throw new Error("size must be an integer");if(r>2**(n-1)-1||r<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!zr(r))throw new Error("Value must be an integer");r<0&&(r=r+2**n),a="i".concat(n)}var o="";return r<0&&(r=-r,o="-"),"".concat(o).concat(t).concat(r.toString(e)).concat(a)}function It(r,e){if(typeof e=="function")return e(r);if(r===1/0)return"Infinity";if(r===-1/0)return"-Infinity";if(isNaN(r))return"NaN";var n="auto",i,t;if(e&&(e.notation&&(n=e.notation),$r(e)?i=e:$r(e.precision)&&(i=e.precision),e.wordSize&&(t=e.wordSize,typeof t!="number")))throw new Error('Option "wordSize" must be a number');switch(n){case"fixed":return hu(r,i);case"exponential":return dn(r,i);case"engineering":return vu(r,i);case"bin":return Ot(r,2,t);case"oct":return Ot(r,8,t);case"hex":return Ot(r,16,t);case"auto":return pu(r,i,e&&e).replace(/((\.\d*?)(0+))($|e)/,function(){var a=arguments[2],o=arguments[4];return a!=="."?a+o:o});default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function ot(r){var e=String(r).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+r);var n=e[1],i=e[2],t=parseFloat(e[4]||"0"),a=i.indexOf(".");t+=a!==-1?a-1:i.length-1;var o=i.replace(".","").replace(/^0*/,function(v){return t-=v.length,""}).replace(/0*$/,"").split("").map(function(v){return parseInt(v)});return o.length===0&&(o.push(0),t++),{sign:n,coefficients:o,exponent:t}}function vu(r,e){if(isNaN(r)||!isFinite(r))return String(r);var n=ot(r),i=st(n,e),t=i.exponent,a=i.coefficients,o=t%3===0?t:t<0?t-3-t%3:t-t%3;if($r(e))for(;e>a.length||t-o+1>a.length;)a.push(0);else for(var v=Math.abs(t-o)-(a.length-1),c=0;c<v;c++)a.push(0);for(var l=Math.abs(t-o),s=1;l>0;)s++,l--;var u=a.slice(s).join(""),f=$r(e)&&u.length||u.match(/[1-9]/)?"."+u:"",p=a.slice(0,s).join("")+f+"e"+(t>=0?"+":"")+o.toString();return i.sign+p}function hu(r,e){if(isNaN(r)||!isFinite(r))return String(r);var n=ot(r),i=typeof e=="number"?st(n,n.exponent+1+e):n,t=i.coefficients,a=i.exponent+1,o=a+(e||0);return t.length<o&&(t=t.concat(Oe(o-t.length))),a<0&&(t=Oe(-a+1).concat(t),a=1),a<t.length&&t.splice(a,0,a===0?"0.":"."),i.sign+t.join("")}function dn(r,e){if(isNaN(r)||!isFinite(r))return String(r);var n=ot(r),i=e?st(n,e):n,t=i.coefficients,a=i.exponent;t.length<e&&(t=t.concat(Oe(e-t.length)));var o=t.shift();return i.sign+o+(t.length>0?"."+t.join(""):"")+"e"+(a>=0?"+":"")+a}function pu(r,e,n){if(isNaN(r)||!isFinite(r))return String(r);var i=n&&n.lowerExp!==void 0?n.lowerExp:-3,t=n&&n.upperExp!==void 0?n.upperExp:5,a=ot(r),o=e?st(a,e):a;if(o.exponent<i||o.exponent>=t)return dn(r,e);var v=o.coefficients,c=o.exponent;v.length<e&&(v=v.concat(Oe(e-v.length))),v=v.concat(Oe(c-v.length+1+(v.length<e?e-v.length:0))),v=Oe(-c).concat(v);var l=c>0?c:0;return l<v.length-1&&v.splice(l+1,0,"."),o.sign+v.join("")}function st(r,e){for(var n={sign:r.sign,coefficients:r.coefficients,exponent:r.exponent},i=n.coefficients;e<=0;)i.unshift(0),n.exponent++,e++;if(i.length>e){var t=i.splice(e,i.length-e);if(t[0]>=5){var a=e-1;for(i[a]++;i[a]===10;)i.pop(),a===0&&(i.unshift(0),n.exponent++,a++),a--,i[a]++}}return n}function Oe(r){for(var e=[],n=0;n<r;n++)e.push(0);return e}function du(r){return r.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var mu=Number.EPSILON||2220446049250313e-31;function De(r,e,n){if(n==null)return r===e;if(r===e)return!0;if(isNaN(r)||isNaN(e))return!1;if(isFinite(r)&&isFinite(e)){var i=Math.abs(r-e);return i<=mu?!0:i<=Math.max(Math.abs(r),Math.abs(e))*n}return!1}function $t(r,e,n){var i=r.constructor,t=new i(2),a="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!zr(n))throw new Error("size must be an integer");if(r.greaterThan(t.pow(n-1).sub(1))||r.lessThan(t.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!r.isInteger())throw new Error("Value must be an integer");r.lessThan(0)&&(r=r.add(t.pow(n))),a="i".concat(n)}switch(e){case 2:return"".concat(r.toBinary()).concat(a);case 8:return"".concat(r.toOctal()).concat(a);case 16:return"".concat(r.toHexadecimal()).concat(a);default:throw new Error("Base ".concat(e," not supported "))}}function gu(r,e){if(typeof e=="function")return e(r);if(!r.isFinite())return r.isNaN()?"NaN":r.gt(0)?"Infinity":"-Infinity";var n="auto",i,t;if(e!==void 0&&(e.notation&&(n=e.notation),typeof e=="number"?i=e:e.precision!==void 0&&(i=e.precision),e.wordSize&&(t=e.wordSize,typeof t!="number")))throw new Error('Option "wordSize" must be a number');switch(n){case"fixed":return yu(r,i);case"exponential":return mn(r,i);case"engineering":return Du(r,i);case"bin":return $t(r,2,t);case"oct":return $t(r,8,t);case"hex":return $t(r,16,t);case"auto":{var a=e&&e.lowerExp!==void 0?e.lowerExp:-3,o=e&&e.upperExp!==void 0?e.upperExp:5;if(r.isZero())return"0";var v,c=r.toSignificantDigits(i),l=c.e;return l>=a&&l<o?v=c.toFixed():v=mn(r,i),v.replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],u=arguments[4];return s!=="."?s+u:u})}default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Du(r,e){var n=r.e,i=n%3===0?n:n<0?n-3-n%3:n-n%3,t=r.mul(Math.pow(10,-i)),a=t.toPrecision(e);if(a.indexOf("e")!==-1){var o=r.constructor;a=new o(a).toFixed()}return a+"e"+(n>=0?"+":"")+i.toString()}function mn(r,e){return e!==void 0?r.toExponential(e-1):r.toExponential()}function yu(r,e){return r.toFixed(e)}function qr(r,e){var n=wu(r,e);return e&&typeof e=="object"&&"truncate"in e&&n.length>e.truncate?n.substring(0,e.truncate-3)+"...":n}function wu(r,e){if(typeof r=="number")return It(r,e);if(Rr(r))return gu(r,e);if(Au(r))return!e||e.fraction!=="decimal"?r.s*r.n+"/"+r.d:r.toString();if(Array.isArray(r))return yn(r,e);if(ne(r))return gn(r);if(typeof r=="function")return r.syntax?String(r.syntax):"function";if(r&&typeof r=="object"){if(typeof r.format=="function")return r.format(e);if(r&&r.toString(e)!=={}.toString())return r.toString(e);var n=Object.keys(r).map(i=>gn(i)+": "+qr(r[i],e));return"{"+n.join(", ")+"}"}return String(r)}function gn(r){for(var e=String(r),n="",i=0;i<e.length;){var t=e.charAt(i);n+=t in Dn?Dn[t]:t,i++}return'"'+n+'"'}var Dn={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function yn(r,e){if(Array.isArray(r)){for(var n="[",i=r.length,t=0;t<i;t++)t!==0&&(n+=", "),n+=yn(r[t],e);return n+="]",n}else return qr(r,e)}function Au(r){return r&&typeof r=="object"&&typeof r.s=="number"&&typeof r.n=="number"&&typeof r.d=="number"||!1}function wr(r,e,n){if(!(this instanceof wr))throw new SyntaxError("Constructor must be called with the new operator");this.actual=r,this.expected=e,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(r)?"["+r.join(", ")+"]":r)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}wr.prototype=new RangeError,wr.prototype.constructor=RangeError,wr.prototype.name="DimensionError",wr.prototype.isDimensionError=!0;function Ne(r,e,n){if(!(this instanceof Ne))throw new SyntaxError("Constructor must be called with the new operator");this.index=r,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=n),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}Ne.prototype=new RangeError,Ne.prototype.constructor=RangeError,Ne.prototype.name="IndexError",Ne.prototype.isIndexError=!0;function Lr(r){for(var e=[];Array.isArray(r);)e.push(r.length),r=r[0];return e}function wn(r,e,n){var i,t=r.length;if(t!==e[n])throw new wr(t,e[n]);if(n<e.length-1){var a=n+1;for(i=0;i<t;i++){var o=r[i];if(!Array.isArray(o))throw new wr(e.length-1,e.length,"<");wn(r[i],e,a)}}else for(i=0;i<t;i++)if(Array.isArray(r[i]))throw new wr(e.length+1,e.length,">")}function An(r,e){var n=e.length===0;if(n){if(Array.isArray(r))throw new wr(r.length,0)}else wn(r,e,0)}function ft(r,e){var n=r.isMatrix?r._size:Lr(r),i=e._sourceSize;i.forEach((t,a)=>{if(t!==null&&t!==n[a])throw new wr(t,n[a])})}function Br(r,e){if(r!==void 0){if(!$r(r)||!zr(r))throw new TypeError("Index must be an integer (value: "+r+")");if(r<0||typeof e=="number"&&r>=e)throw new Ne(r,e)}}function Ie(r){for(var e=0;e<r._dimensions.length;++e){var n=r._dimensions[e];if(n._data&&Mr(n._data)){if(n._size[0]===0)return!0}else if(n.isRange){if(n.start===n.end)return!0}else if(ne(n)&&n.length===0)return!0}return!1}function ct(r,e,n){if(!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(t){if(!$r(t)||!zr(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+qr(e)+")")}),($r(r)||Rr(r))&&(r=[r]);var i=n!==void 0?n:0;return qt(r,e,0,i),r}function qt(r,e,n,i){var t,a,o=r.length,v=e[n],c=Math.min(o,v);if(r.length=v,n<e.length-1){var l=n+1;for(t=0;t<c;t++)a=r[t],Array.isArray(a)||(a=[a],r[t]=a),qt(a,e,l,i);for(t=c;t<v;t++)a=[],r[t]=a,qt(a,e,l,i)}else{for(t=0;t<c;t++)for(;Array.isArray(r[t]);)r[t]=r[t][0];for(t=c;t<v;t++)r[t]=i}}function Lt(r,e){var n=Rt(r),i=n.length;if(!Array.isArray(r)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new wr(0,i,"!=");e=Pt(e,i);var t=En(e);if(i!==t)throw new wr(t,i,"!=");try{return Eu(n,e)}catch(a){throw a instanceof wr?new wr(t,i,"!="):a}}function Pt(r,e){var n=En(r),i=r.slice(),t=-1,a=r.indexOf(t),o=r.indexOf(t,a+1)>=0;if(o)throw new Error("More than one wildcard in sizes");var v=a>=0,c=e%n===0;if(v)if(c)i[a]=-e/n;else throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-n);return i}function En(r){return r.reduce((e,n)=>e*n,1)}function Eu(r,e){for(var n=r,i,t=e.length-1;t>0;t--){var a=e[t];i=[];for(var o=n.length/a,v=0;v<o;v++)i.push(n.slice(v*a,(v+1)*a));n=i}return n}function Fn(r,e){for(var n=e||Lr(r);Array.isArray(r)&&r.length===1;)r=r[0],n.shift();for(var i=n.length;n[i-1]===1;)i--;return i<n.length&&(r=Cn(r,i,0),n.length=i),r}function Cn(r,e,n){var i,t;if(n<e){var a=n+1;for(i=0,t=r.length;i<t;i++)r[i]=Cn(r[i],e,a)}else for(;Array.isArray(r);)r=r[0];return r}function bn(r,e,n,i){var t=i||Lr(r);if(n)for(var a=0;a<n;a++)r=[r],t.unshift(1);for(r=Mn(r,e,0);t.length<e;)t.push(1);return r}function Mn(r,e,n){var i,t;if(Array.isArray(r)){var a=n+1;for(i=0,t=r.length;i<t;i++)r[i]=Mn(r[i],e,a)}else for(var o=n;o<e;o++)r=[r];return r}function Rt(r){if(!Array.isArray(r))return r;var e=[];return r.forEach(function n(i){Array.isArray(i)?i.forEach(n):e.push(i)}),e}function Je(r,e){for(var n,i=0,t=0;t<r.length;t++){var a=r[t],o=Array.isArray(a);if(t===0&&o&&(i=a.length),o&&a.length!==i)return;var v=o?Je(a,e):e(a);if(n===void 0)n=v;else if(n!==v)return"mixed"}return n}function Sn(r,e,n,i){if(i<n){if(r.length!==e.length)throw new wr(r.length,e.length);for(var t=[],a=0;a<r.length;a++)t[a]=Sn(r[a],e[a],n,i+1);return t}else return r.concat(e)}function Nn(){var r=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(r.length===1)return r[0];if(r.length>1)return r.slice(1).reduce(function(n,i){return Sn(n,i,e,0)},r[0]);throw new Error("Wrong number of arguments in function concat")}function Fu(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];for(var i=e.map(f=>f.length),t=Math.max(...i),a=new Array(t).fill(null),o=0;o<e.length;o++)for(var v=e[o],c=i[o],l=0;l<c;l++){var s=t-c+l;v[l]>a[s]&&(a[s]=v[l])}for(var u=0;u<e.length;u++)lt(e[u],a);return a}function lt(r,e){for(var n=e.length,i=r.length,t=0;t<i;t++){var a=n-i+t;if(r[t]<e[a]&&r[t]>1||r[t]>e[a])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(r,") not possible to broadcast dimension ").concat(i," with size ").concat(r[t]," to size ").concat(e[a]))}}function xn(r,e){var n=Lr(r);if(ze(n,e))return r;lt(n,e);var i=Fu(n,e),t=i.length,a=[...Array(t-n.length).fill(1),...n],o=bu(r);n.length<t&&(o=Lt(o,a),n=Lr(o));for(var v=0;v<t;v++)n[v]<i[v]&&(o=Cu(o,i[v],v),n=Lr(o));return o}function Cu(r,e,n){return Nn(...Array(e).fill(r),n)}function bu(r){return Gr([],r)}function j(r,e,n,i){function t(a){var o=su(a,e.map(Nu));return Mu(r,e,a),n(o)}return t.isFactory=!0,t.fn=r,t.dependencies=e.slice().sort(),i&&(t.meta=i),t}function Mu(r,e,n){var i=e.filter(a=>!Su(a)).every(a=>n[a]!==void 0);if(!i){var t=e.filter(a=>n[a]===void 0);throw new Error('Cannot create function "'.concat(r,'", ')+"some dependencies are missing: ".concat(t.map(a=>'"'.concat(a,'"')).join(", "),"."))}}function Su(r){return r&&r[0]==="?"}function Nu(r){return r&&r[0]==="?"?r.slice(1):r}function Bn(r,e){if(Tn(r)&&zn(r,e))return r[e];throw typeof r[e]=="function"&&Bu(r,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function _n(r,e,n){if(Tn(r)&&zn(r,e))return r[e]=n,n;throw new Error('No access to property "'+e+'"')}function xu(r,e){return e in r}function zn(r,e){return!r||typeof r!="object"?!1:Ye(_u,e)?!0:!(e in Object.prototype||e in Function.prototype)}function Bu(r,e){return r==null||typeof r[e]!="function"||Ye(r,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(r)?!1:Ye(zu,e)?!0:!(e in Object.prototype||e in Function.prototype)}function Tn(r){return typeof r=="object"&&r&&r.constructor===Object}var _u={length:!0,name:!0},zu={toString:!0,valueOf:!0,toLocaleString:!0};class Tu{constructor(e){this.wrappedObject=e}keys(){return Object.keys(this.wrappedObject)}get(e){return Bn(this.wrappedObject,e)}set(e,n){return _n(this.wrappedObject,e,n),this}has(e){return xu(this.wrappedObject,e)}}function Ou(r){return r?r instanceof Map||r instanceof Tu||typeof r.set=="function"&&typeof r.get=="function"&&typeof r.keys=="function"&&typeof r.has=="function":!1}var On=function(){return On=pn.create,pn},Iu=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],$u=j("typed",Iu,function(e){var{BigNumber:n,Complex:i,DenseMatrix:t,Fraction:a}=e,o=On();return o.clear(),o.addTypes([{name:"number",test:$r},{name:"Complex",test:zt},{name:"BigNumber",test:Rr},{name:"Fraction",test:Tt},{name:"Unit",test:un},{name:"identifier",test:v=>ne&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(v)},{name:"string",test:ne},{name:"Chain",test:au},{name:"Array",test:Mr},{name:"Matrix",test:xr},{name:"DenseMatrix",test:on},{name:"SparseMatrix",test:sn},{name:"Range",test:fn},{name:"Index",test:ut},{name:"boolean",test:Ia},{name:"ResultSet",test:$a},{name:"Help",test:qa},{name:"function",test:La},{name:"Date",test:Pa},{name:"RegExp",test:Ra},{name:"null",test:Ua},{name:"undefined",test:Va},{name:"AccessorNode",test:Za},{name:"ArrayNode",test:Ga},{name:"AssignmentNode",test:Ya},{name:"BlockNode",test:Ja},{name:"ConditionalNode",test:Qa},{name:"ConstantNode",test:Xa},{name:"FunctionNode",test:Ha},{name:"FunctionAssignmentNode",test:Ka},{name:"IndexNode",test:Wa},{name:"Node",test:ka},{name:"ObjectNode",test:ja},{name:"OperatorNode",test:ru},{name:"ParenthesisNode",test:eu},{name:"RangeNode",test:tu},{name:"RelationalNode",test:nu},{name:"SymbolNode",test:iu},{name:"Map",test:Ou},{name:"Object",test:cn}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(c){if(n||Ut(c),du(c)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+c+"). Use function bignumber(x) to convert to BigNumber.");return new n(c)}},{from:"number",to:"Complex",convert:function(c){return i||vt(c),new i(c,0)}},{from:"BigNumber",to:"Complex",convert:function(c){return i||vt(c),new i(c.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(c){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(c){return i||vt(c),new i(c.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(c){a||Vt(c);var l=new a(c);if(l.valueOf()!==c)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+c+"). Use function fraction(x) to convert to Fraction.");return l}},{from:"string",to:"number",convert:function(c){var l=Number(c);if(isNaN(l))throw new Error('Cannot convert "'+c+'" to a number');return l}},{from:"string",to:"BigNumber",convert:function(c){n||Ut(c);try{return new n(c)}catch{throw new Error('Cannot convert "'+c+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(c){a||Vt(c);try{return new a(c)}catch{throw new Error('Cannot convert "'+c+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(c){i||vt(c);try{return new i(c)}catch{throw new Error('Cannot convert "'+c+'" to Complex')}}},{from:"boolean",to:"number",convert:function(c){return+c}},{from:"boolean",to:"BigNumber",convert:function(c){return n||Ut(c),new n(+c)}},{from:"boolean",to:"Fraction",convert:function(c){return a||Vt(c),new a(+c)}},{from:"boolean",to:"string",convert:function(c){return String(c)}},{from:"Array",to:"Matrix",convert:function(c){return t||qu(),new t(c)}},{from:"Matrix",to:"Array",convert:function(c){return c.valueOf()}}]),o.onMismatch=(v,c,l)=>{var s=o.createError(v,c,l);if(["wrongType","mismatch"].includes(s.data.category)&&c.length===1&&at(c[0])&&l.some(f=>!f.params.includes(","))){var u=new TypeError("Function '".concat(v,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(v,")'."));throw u.data=s.data,u}throw s},o.onMismatch=(v,c,l)=>{var s=o.createError(v,c,l);if(["wrongType","mismatch"].includes(s.data.category)&&c.length===1&&at(c[0])&&l.some(f=>!f.params.includes(","))){var u=new TypeError("Function '".concat(v,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(v,")'."));throw u.data=s.data,u}throw s},o});function Ut(r){throw new Error("Cannot convert value ".concat(r," into a BigNumber: no class 'BigNumber' provided"))}function vt(r){throw new Error("Cannot convert value ".concat(r," into a Complex number: no class 'Complex' provided"))}function qu(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function Vt(r){throw new Error("Cannot convert value ".concat(r," into a Fraction, no class 'Fraction' provided."))}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var $e=9e15,ye=1e9,Zt="0123456789abcdef",ht="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",pt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Gt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-$e,maxE:$e,crypto:!1},In,pe,dr=!0,dt="[DecimalError] ",we=dt+"Invalid argument: ",$n=dt+"Precision limit exceeded",qn=dt+"crypto unavailable",Ln="[object Decimal]",Xr=Math.floor,Vr=Math.pow,Lu=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Pu=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Ru=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Pn=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ae=1e7,hr=7,Uu=9007199254740991,Vu=ht.length-1,Yt=pt.length-1,H={toStringTag:Ln};H.absoluteValue=H.abs=function(){var r=new this.constructor(this);return r.s<0&&(r.s=1),vr(r)},H.ceil=function(){return vr(new this.constructor(this),this.e+1,2)},H.clampedTo=H.clamp=function(r,e){var n,i=this,t=i.constructor;if(r=new t(r),e=new t(e),!r.s||!e.s)return new t(NaN);if(r.gt(e))throw Error(we+e);return n=i.cmp(r),n<0?r:i.cmp(e)>0?e:new t(i)},H.comparedTo=H.cmp=function(r){var e,n,i,t,a=this,o=a.d,v=(r=new a.constructor(r)).d,c=a.s,l=r.s;if(!o||!v)return!c||!l?NaN:c!==l?c:o===v?0:!o^c<0?1:-1;if(!o[0]||!v[0])return o[0]?c:v[0]?-l:0;if(c!==l)return c;if(a.e!==r.e)return a.e>r.e^c<0?1:-1;for(i=o.length,t=v.length,e=0,n=i<t?i:t;e<n;++e)if(o[e]!==v[e])return o[e]>v[e]^c<0?1:-1;return i===t?0:i>t^c<0?1:-1},H.cosine=H.cos=function(){var r,e,n=this,i=n.constructor;return n.d?n.d[0]?(r=i.precision,e=i.rounding,i.precision=r+Math.max(n.e,n.sd())+hr,i.rounding=1,n=Zu(i,Yn(i,n)),i.precision=r,i.rounding=e,vr(pe==2||pe==3?n.neg():n,r,e,!0)):new i(1):new i(NaN)},H.cubeRoot=H.cbrt=function(){var r,e,n,i,t,a,o,v,c,l,s=this,u=s.constructor;if(!s.isFinite()||s.isZero())return new u(s);for(dr=!1,a=s.s*Vr(s.s*s,1/3),!a||Math.abs(a)==1/0?(n=Yr(s.d),r=s.e,(a=(r-n.length+1)%3)&&(n+=a==1||a==-2?"0":"00"),a=Vr(n,1/3),r=Xr((r+1)/3)-(r%3==(r<0?-1:2)),a==1/0?n="5e"+r:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+r),i=new u(n),i.s=s.s):i=new u(a.toString()),o=(r=u.precision)+3;;)if(v=i,c=v.times(v).times(v),l=c.plus(s),i=Tr(l.plus(s).times(v),l.plus(c),o+2,1),Yr(v.d).slice(0,o)===(n=Yr(i.d)).slice(0,o))if(n=n.slice(o-3,o+1),n=="9999"||!t&&n=="4999"){if(!t&&(vr(v,r+1,0),v.times(v).times(v).eq(s))){i=v;break}o+=4,t=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(vr(i,r+1,1),e=!i.times(i).times(i).eq(s));break}return dr=!0,vr(i,r,u.rounding,e)},H.decimalPlaces=H.dp=function(){var r,e=this.d,n=NaN;if(e){if(r=e.length-1,n=(r-Xr(this.e/hr))*hr,r=e[r],r)for(;r%10==0;r/=10)n--;n<0&&(n=0)}return n},H.dividedBy=H.div=function(r){return Tr(this,new this.constructor(r))},H.dividedToIntegerBy=H.divToInt=function(r){var e=this,n=e.constructor;return vr(Tr(e,new n(r),0,1,1),n.precision,n.rounding)},H.equals=H.eq=function(r){return this.cmp(r)===0},H.floor=function(){return vr(new this.constructor(this),this.e+1,3)},H.greaterThan=H.gt=function(r){return this.cmp(r)>0},H.greaterThanOrEqualTo=H.gte=function(r){var e=this.cmp(r);return e==1||e===0},H.hyperbolicCosine=H.cosh=function(){var r,e,n,i,t,a=this,o=a.constructor,v=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return v;n=o.precision,i=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,t=a.d.length,t<32?(r=Math.ceil(t/3),e=(1/yt(4,r)).toString()):(r=16,e="2.3283064365386962890625e-10"),a=qe(o,1,a.times(e),new o(1),!0);for(var c,l=r,s=new o(8);l--;)c=a.times(a),a=v.minus(c.times(s.minus(c.times(s))));return vr(a,o.precision=n,o.rounding=i,!0)},H.hyperbolicSine=H.sinh=function(){var r,e,n,i,t=this,a=t.constructor;if(!t.isFinite()||t.isZero())return new a(t);if(e=a.precision,n=a.rounding,a.precision=e+Math.max(t.e,t.sd())+4,a.rounding=1,i=t.d.length,i<3)t=qe(a,2,t,t,!0);else{r=1.4*Math.sqrt(i),r=r>16?16:r|0,t=t.times(1/yt(5,r)),t=qe(a,2,t,t,!0);for(var o,v=new a(5),c=new a(16),l=new a(20);r--;)o=t.times(t),t=t.times(v.plus(o.times(c.times(o).plus(l))))}return a.precision=e,a.rounding=n,vr(t,e,n,!0)},H.hyperbolicTangent=H.tanh=function(){var r,e,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(r=i.precision,e=i.rounding,i.precision=r+7,i.rounding=1,Tr(n.sinh(),n.cosh(),i.precision=r,i.rounding=e)):new i(n.s)},H.inverseCosine=H.acos=function(){var r,e=this,n=e.constructor,i=e.abs().cmp(1),t=n.precision,a=n.rounding;return i!==-1?i===0?e.isNeg()?ue(n,t,a):new n(0):new n(NaN):e.isZero()?ue(n,t+4,a).times(.5):(n.precision=t+6,n.rounding=1,e=e.asin(),r=ue(n,t+4,a).times(.5),n.precision=t,n.rounding=a,r.minus(e))},H.inverseHyperbolicCosine=H.acosh=function(){var r,e,n=this,i=n.constructor;return n.lte(1)?new i(n.eq(1)?0:NaN):n.isFinite()?(r=i.precision,e=i.rounding,i.precision=r+Math.max(Math.abs(n.e),n.sd())+4,i.rounding=1,dr=!1,n=n.times(n).minus(1).sqrt().plus(n),dr=!0,i.precision=r,i.rounding=e,n.ln()):new i(n)},H.inverseHyperbolicSine=H.asinh=function(){var r,e,n=this,i=n.constructor;return!n.isFinite()||n.isZero()?new i(n):(r=i.precision,e=i.rounding,i.precision=r+2*Math.max(Math.abs(n.e),n.sd())+6,i.rounding=1,dr=!1,n=n.times(n).plus(1).sqrt().plus(n),dr=!0,i.precision=r,i.rounding=e,n.ln())},H.inverseHyperbolicTangent=H.atanh=function(){var r,e,n,i,t=this,a=t.constructor;return t.isFinite()?t.e>=0?new a(t.abs().eq(1)?t.s/0:t.isZero()?t:NaN):(r=a.precision,e=a.rounding,i=t.sd(),Math.max(i,r)<2*-t.e-1?vr(new a(t),r,e,!0):(a.precision=n=i-t.e,t=Tr(t.plus(1),new a(1).minus(t),n+r,1),a.precision=r+4,a.rounding=1,t=t.ln(),a.precision=r,a.rounding=e,t.times(.5))):new a(NaN)},H.inverseSine=H.asin=function(){var r,e,n,i,t=this,a=t.constructor;return t.isZero()?new a(t):(e=t.abs().cmp(1),n=a.precision,i=a.rounding,e!==-1?e===0?(r=ue(a,n+4,i).times(.5),r.s=t.s,r):new a(NaN):(a.precision=n+6,a.rounding=1,t=t.div(new a(1).minus(t.times(t)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=i,t.times(2)))},H.inverseTangent=H.atan=function(){var r,e,n,i,t,a,o,v,c,l=this,s=l.constructor,u=s.precision,f=s.rounding;if(l.isFinite()){if(l.isZero())return new s(l);if(l.abs().eq(1)&&u+4<=Yt)return o=ue(s,u+4,f).times(.25),o.s=l.s,o}else{if(!l.s)return new s(NaN);if(u+4<=Yt)return o=ue(s,u+4,f).times(.5),o.s=l.s,o}for(s.precision=v=u+10,s.rounding=1,n=Math.min(28,v/hr+2|0),r=n;r;--r)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(dr=!1,e=Math.ceil(v/hr),i=1,c=l.times(l),o=new s(l),t=l;r!==-1;)if(t=t.times(c),a=o.minus(t.div(i+=2)),t=t.times(c),o=a.plus(t.div(i+=2)),o.d[e]!==void 0)for(r=e;o.d[r]===a.d[r]&&r--;);return n&&(o=o.times(2<<n-1)),dr=!0,vr(o,s.precision=u,s.rounding=f,!0)},H.isFinite=function(){return!!this.d},H.isInteger=H.isInt=function(){return!!this.d&&Xr(this.e/hr)>this.d.length-2},H.isNaN=function(){return!this.s},H.isNegative=H.isNeg=function(){return this.s<0},H.isPositive=H.isPos=function(){return this.s>0},H.isZero=function(){return!!this.d&&this.d[0]===0},H.lessThan=H.lt=function(r){return this.cmp(r)<0},H.lessThanOrEqualTo=H.lte=function(r){return this.cmp(r)<1},H.logarithm=H.log=function(r){var e,n,i,t,a,o,v,c,l=this,s=l.constructor,u=s.precision,f=s.rounding,p=5;if(r==null)r=new s(10),e=!0;else{if(r=new s(r),n=r.d,r.s<0||!n||!n[0]||r.eq(1))return new s(NaN);e=r.eq(10)}if(n=l.d,l.s<0||!n||!n[0]||l.eq(1))return new s(n&&!n[0]?-1/0:l.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)a=!0;else{for(t=n[0];t%10===0;)t/=10;a=t!==1}if(dr=!1,v=u+p,o=Ee(l,v),i=e?Dt(s,v+10):Ee(r,v),c=Tr(o,i,v,1),Qe(c.d,t=u,f))do if(v+=10,o=Ee(l,v),i=e?Dt(s,v+10):Ee(r,v),c=Tr(o,i,v,1),!a){+Yr(c.d).slice(t+1,t+15)+1==1e14&&(c=vr(c,u+1,0));break}while(Qe(c.d,t+=10,f));return dr=!0,vr(c,u,f)},H.minus=H.sub=function(r){var e,n,i,t,a,o,v,c,l,s,u,f,p=this,D=p.constructor;if(r=new D(r),!p.d||!r.d)return!p.s||!r.s?r=new D(NaN):p.d?r.s=-r.s:r=new D(r.d||p.s!==r.s?p:NaN),r;if(p.s!=r.s)return r.s=-r.s,p.plus(r);if(l=p.d,f=r.d,v=D.precision,c=D.rounding,!l[0]||!f[0]){if(f[0])r.s=-r.s;else if(l[0])r=new D(p);else return new D(c===3?-0:0);return dr?vr(r,v,c):r}if(n=Xr(r.e/hr),s=Xr(p.e/hr),l=l.slice(),a=s-n,a){for(u=a<0,u?(e=l,a=-a,o=f.length):(e=f,n=s,o=l.length),i=Math.max(Math.ceil(v/hr),o)+2,a>i&&(a=i,e.length=1),e.reverse(),i=a;i--;)e.push(0);e.reverse()}else{for(i=l.length,o=f.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=f[i]){u=l[i]<f[i];break}a=0}for(u&&(e=l,l=f,f=e,r.s=-r.s),o=l.length,i=f.length-o;i>0;--i)l[o++]=0;for(i=f.length;i>a;){if(l[--i]<f[i]){for(t=i;t&&l[--t]===0;)l[t]=ae-1;--l[t],l[i]+=ae}l[i]-=f[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(r.d=l,r.e=gt(l,n),dr?vr(r,v,c):r):new D(c===3?-0:0)},H.modulo=H.mod=function(r){var e,n=this,i=n.constructor;return r=new i(r),!n.d||!r.s||r.d&&!r.d[0]?new i(NaN):!r.d||n.d&&!n.d[0]?vr(new i(n),i.precision,i.rounding):(dr=!1,i.modulo==9?(e=Tr(n,r.abs(),0,3,1),e.s*=r.s):e=Tr(n,r,0,i.modulo,1),e=e.times(r),dr=!0,n.minus(e))},H.naturalExponential=H.exp=function(){return Jt(this)},H.naturalLogarithm=H.ln=function(){return Ee(this)},H.negated=H.neg=function(){var r=new this.constructor(this);return r.s=-r.s,vr(r)},H.plus=H.add=function(r){var e,n,i,t,a,o,v,c,l,s,u=this,f=u.constructor;if(r=new f(r),!u.d||!r.d)return!u.s||!r.s?r=new f(NaN):u.d||(r=new f(r.d||u.s===r.s?u:NaN)),r;if(u.s!=r.s)return r.s=-r.s,u.minus(r);if(l=u.d,s=r.d,v=f.precision,c=f.rounding,!l[0]||!s[0])return s[0]||(r=new f(u)),dr?vr(r,v,c):r;if(a=Xr(u.e/hr),i=Xr(r.e/hr),l=l.slice(),t=a-i,t){for(t<0?(n=l,t=-t,o=s.length):(n=s,i=a,o=l.length),a=Math.ceil(v/hr),o=a>o?a+1:o+1,t>o&&(t=o,n.length=1),n.reverse();t--;)n.push(0);n.reverse()}for(o=l.length,t=s.length,o-t<0&&(t=o,n=s,s=l,l=n),e=0;t;)e=(l[--t]=l[t]+s[t]+e)/ae|0,l[t]%=ae;for(e&&(l.unshift(e),++i),o=l.length;l[--o]==0;)l.pop();return r.d=l,r.e=gt(l,i),dr?vr(r,v,c):r},H.precision=H.sd=function(r){var e,n=this;if(r!==void 0&&r!==!!r&&r!==1&&r!==0)throw Error(we+r);return n.d?(e=Rn(n.d),r&&n.e+1>e&&(e=n.e+1)):e=NaN,e},H.round=function(){var r=this,e=r.constructor;return vr(new e(r),r.e+1,e.rounding)},H.sine=H.sin=function(){var r,e,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(r=i.precision,e=i.rounding,i.precision=r+Math.max(n.e,n.sd())+hr,i.rounding=1,n=Yu(i,Yn(i,n)),i.precision=r,i.rounding=e,vr(pe>2?n.neg():n,r,e,!0)):new i(NaN)},H.squareRoot=H.sqrt=function(){var r,e,n,i,t,a,o=this,v=o.d,c=o.e,l=o.s,s=o.constructor;if(l!==1||!v||!v[0])return new s(!l||l<0&&(!v||v[0])?NaN:v?o:1/0);for(dr=!1,l=Math.sqrt(+o),l==0||l==1/0?(e=Yr(v),(e.length+c)%2==0&&(e+="0"),l=Math.sqrt(e),c=Xr((c+1)/2)-(c<0||c%2),l==1/0?e="5e"+c:(e=l.toExponential(),e=e.slice(0,e.indexOf("e")+1)+c),i=new s(e)):i=new s(l.toString()),n=(c=s.precision)+3;;)if(a=i,i=a.plus(Tr(o,a,n+2,1)).times(.5),Yr(a.d).slice(0,n)===(e=Yr(i.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!t&&e=="4999"){if(!t&&(vr(a,c+1,0),a.times(a).eq(o))){i=a;break}n+=4,t=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(vr(i,c+1,1),r=!i.times(i).eq(o));break}return dr=!0,vr(i,c,s.rounding,r)},H.tangent=H.tan=function(){var r,e,n=this,i=n.constructor;return n.isFinite()?n.isZero()?new i(n):(r=i.precision,e=i.rounding,i.precision=r+10,i.rounding=1,n=n.sin(),n.s=1,n=Tr(n,new i(1).minus(n.times(n)).sqrt(),r+10,0),i.precision=r,i.rounding=e,vr(pe==2||pe==4?n.neg():n,r,e,!0)):new i(NaN)},H.times=H.mul=function(r){var e,n,i,t,a,o,v,c,l,s=this,u=s.constructor,f=s.d,p=(r=new u(r)).d;if(r.s*=s.s,!f||!f[0]||!p||!p[0])return new u(!r.s||f&&!f[0]&&!p||p&&!p[0]&&!f?NaN:!f||!p?r.s/0:r.s*0);for(n=Xr(s.e/hr)+Xr(r.e/hr),c=f.length,l=p.length,c<l&&(a=f,f=p,p=a,o=c,c=l,l=o),a=[],o=c+l,i=o;i--;)a.push(0);for(i=l;--i>=0;){for(e=0,t=c+i;t>i;)v=a[t]+p[i]*f[t-i-1]+e,a[t--]=v%ae|0,e=v/ae|0;a[t]=(a[t]+e)%ae|0}for(;!a[--o];)a.pop();return e?++n:a.shift(),r.d=a,r.e=gt(a,n),dr?vr(r,u.precision,u.rounding):r},H.toBinary=function(r,e){return Xt(this,2,r,e)},H.toDecimalPlaces=H.toDP=function(r,e){var n=this,i=n.constructor;return n=new i(n),r===void 0?n:(kr(r,0,ye),e===void 0?e=i.rounding:kr(e,0,8),vr(n,r+n.e+1,e))},H.toExponential=function(r,e){var n,i=this,t=i.constructor;return r===void 0?n=le(i,!0):(kr(r,0,ye),e===void 0?e=t.rounding:kr(e,0,8),i=vr(new t(i),r+1,e),n=le(i,!0,r+1)),i.isNeg()&&!i.isZero()?"-"+n:n},H.toFixed=function(r,e){var n,i,t=this,a=t.constructor;return r===void 0?n=le(t):(kr(r,0,ye),e===void 0?e=a.rounding:kr(e,0,8),i=vr(new a(t),r+t.e+1,e),n=le(i,!1,r+i.e+1)),t.isNeg()&&!t.isZero()?"-"+n:n},H.toFraction=function(r){var e,n,i,t,a,o,v,c,l,s,u,f,p=this,D=p.d,h=p.constructor;if(!D)return new h(p);if(l=n=new h(1),i=c=new h(0),e=new h(i),a=e.e=Rn(D)-p.e-1,o=a%hr,e.d[0]=Vr(10,o<0?hr+o:o),r==null)r=a>0?e:l;else{if(v=new h(r),!v.isInt()||v.lt(l))throw Error(we+v);r=v.gt(e)?a>0?e:l:v}for(dr=!1,v=new h(Yr(D)),s=h.precision,h.precision=a=D.length*hr*2;u=Tr(v,e,0,1,1),t=n.plus(u.times(i)),t.cmp(r)!=1;)n=i,i=t,t=l,l=c.plus(u.times(t)),c=t,t=e,e=v.minus(u.times(t)),v=t;return t=Tr(r.minus(n),i,0,1,1),c=c.plus(t.times(l)),n=n.plus(t.times(i)),c.s=l.s=p.s,f=Tr(l,i,a,1).minus(p).abs().cmp(Tr(c,n,a,1).minus(p).abs())<1?[l,i]:[c,n],h.precision=s,dr=!0,f},H.toHexadecimal=H.toHex=function(r,e){return Xt(this,16,r,e)},H.toNearest=function(r,e){var n=this,i=n.constructor;if(n=new i(n),r==null){if(!n.d)return n;r=new i(1),e=i.rounding}else{if(r=new i(r),e===void 0?e=i.rounding:kr(e,0,8),!n.d)return r.s?n:r;if(!r.d)return r.s&&(r.s=n.s),r}return r.d[0]?(dr=!1,n=Tr(n,r,0,e,1).times(r),dr=!0,vr(n)):(r.s=n.s,n=r),n},H.toNumber=function(){return+this},H.toOctal=function(r,e){return Xt(this,8,r,e)},H.toPower=H.pow=function(r){var e,n,i,t,a,o,v=this,c=v.constructor,l=+(r=new c(r));if(!v.d||!r.d||!v.d[0]||!r.d[0])return new c(Vr(+v,l));if(v=new c(v),v.eq(1))return v;if(i=c.precision,a=c.rounding,r.eq(1))return vr(v,i,a);if(e=Xr(r.e/hr),e>=r.d.length-1&&(n=l<0?-l:l)<=Uu)return t=Un(c,v,n,i),r.s<0?new c(1).div(t):vr(t,i,a);if(o=v.s,o<0){if(e<r.d.length-1)return new c(NaN);if(r.d[e]&1||(o=1),v.e==0&&v.d[0]==1&&v.d.length==1)return v.s=o,v}return n=Vr(+v,l),e=n==0||!isFinite(n)?Xr(l*(Math.log("0."+Yr(v.d))/Math.LN10+v.e+1)):new c(n+"").e,e>c.maxE+1||e<c.minE-1?new c(e>0?o/0:0):(dr=!1,c.rounding=v.s=1,n=Math.min(12,(e+"").length),t=Jt(r.times(Ee(v,i+n)),i),t.d&&(t=vr(t,i+5,1),Qe(t.d,i,a)&&(e=i+10,t=vr(Jt(r.times(Ee(v,e+n)),e),e+5,1),+Yr(t.d).slice(i+1,i+15)+1==1e14&&(t=vr(t,i+1,0)))),t.s=o,dr=!0,c.rounding=a,vr(t,i,a))},H.toPrecision=function(r,e){var n,i=this,t=i.constructor;return r===void 0?n=le(i,i.e<=t.toExpNeg||i.e>=t.toExpPos):(kr(r,1,ye),e===void 0?e=t.rounding:kr(e,0,8),i=vr(new t(i),r,e),n=le(i,r<=i.e||i.e<=t.toExpNeg,r)),i.isNeg()&&!i.isZero()?"-"+n:n},H.toSignificantDigits=H.toSD=function(r,e){var n=this,i=n.constructor;return r===void 0?(r=i.precision,e=i.rounding):(kr(r,1,ye),e===void 0?e=i.rounding:kr(e,0,8)),vr(new i(n),r,e)},H.toString=function(){var r=this,e=r.constructor,n=le(r,r.e<=e.toExpNeg||r.e>=e.toExpPos);return r.isNeg()&&!r.isZero()?"-"+n:n},H.truncated=H.trunc=function(){return vr(new this.constructor(this),this.e+1,1)},H.valueOf=H.toJSON=function(){var r=this,e=r.constructor,n=le(r,r.e<=e.toExpNeg||r.e>=e.toExpPos);return r.isNeg()?"-"+n:n};function Yr(r){var e,n,i,t=r.length-1,a="",o=r[0];if(t>0){for(a+=o,e=1;e<t;e++)i=r[e]+"",n=hr-i.length,n&&(a+=Ae(n)),a+=i;o=r[e],i=o+"",n=hr-i.length,n&&(a+=Ae(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function kr(r,e,n){if(r!==~~r||r<e||r>n)throw Error(we+r)}function Qe(r,e,n,i){var t,a,o,v;for(a=r[0];a>=10;a/=10)--e;return--e<0?(e+=hr,t=0):(t=Math.ceil((e+1)/hr),e%=hr),a=Vr(10,hr-e),v=r[t]%a|0,i==null?e<3?(e==0?v=v/100|0:e==1&&(v=v/10|0),o=n<4&&v==99999||n>3&&v==49999||v==5e4||v==0):o=(n<4&&v+1==a||n>3&&v+1==a/2)&&(r[t+1]/a/100|0)==Vr(10,e-2)-1||(v==a/2||v==0)&&(r[t+1]/a/100|0)==0:e<4?(e==0?v=v/1e3|0:e==1?v=v/100|0:e==2&&(v=v/10|0),o=(i||n<4)&&v==9999||!i&&n>3&&v==4999):o=((i||n<4)&&v+1==a||!i&&n>3&&v+1==a/2)&&(r[t+1]/a/1e3|0)==Vr(10,e-3)-1,o}function mt(r,e,n){for(var i,t=[0],a,o=0,v=r.length;o<v;){for(a=t.length;a--;)t[a]*=e;for(t[0]+=Zt.indexOf(r.charAt(o++)),i=0;i<t.length;i++)t[i]>n-1&&(t[i+1]===void 0&&(t[i+1]=0),t[i+1]+=t[i]/n|0,t[i]%=n)}return t.reverse()}function Zu(r,e){var n,i,t;if(e.isZero())return e;i=e.d.length,i<32?(n=Math.ceil(i/3),t=(1/yt(4,n)).toString()):(n=16,t="2.3283064365386962890625e-10"),r.precision+=n,e=qe(r,1,e.times(t),new r(1));for(var a=n;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return r.precision-=n,e}var Tr=function(){function r(i,t,a){var o,v=0,c=i.length;for(i=i.slice();c--;)o=i[c]*t+v,i[c]=o%a|0,v=o/a|0;return v&&i.unshift(v),i}function e(i,t,a,o){var v,c;if(a!=o)c=a>o?1:-1;else for(v=c=0;v<a;v++)if(i[v]!=t[v]){c=i[v]>t[v]?1:-1;break}return c}function n(i,t,a,o){for(var v=0;a--;)i[a]-=v,v=i[a]<t[a]?1:0,i[a]=v*o+i[a]-t[a];for(;!i[0]&&i.length>1;)i.shift()}return function(i,t,a,o,v,c){var l,s,u,f,p,D,h,m,d,w,g,E,F,y,C,b,A,S,M,N,O=i.constructor,T=i.s==t.s?1:-1,I=i.d,B=t.d;if(!I||!I[0]||!B||!B[0])return new O(!i.s||!t.s||(I?B&&I[0]==B[0]:!B)?NaN:I&&I[0]==0||!B?T*0:T/0);for(c?(p=1,s=i.e-t.e):(c=ae,p=hr,s=Xr(i.e/p)-Xr(t.e/p)),M=B.length,A=I.length,d=new O(T),w=d.d=[],u=0;B[u]==(I[u]||0);u++);if(B[u]>(I[u]||0)&&s--,a==null?(y=a=O.precision,o=O.rounding):v?y=a+(i.e-t.e)+1:y=a,y<0)w.push(1),D=!0;else{if(y=y/p+2|0,u=0,M==1){for(f=0,B=B[0],y++;(u<A||f)&&y--;u++)C=f*c+(I[u]||0),w[u]=C/B|0,f=C%B|0;D=f||u<A}else{for(f=c/(B[0]+1)|0,f>1&&(B=r(B,f,c),I=r(I,f,c),M=B.length,A=I.length),b=M,g=I.slice(0,M),E=g.length;E<M;)g[E++]=0;N=B.slice(),N.unshift(0),S=B[0],B[1]>=c/2&&++S;do f=0,l=e(B,g,M,E),l<0?(F=g[0],M!=E&&(F=F*c+(g[1]||0)),f=F/S|0,f>1?(f>=c&&(f=c-1),h=r(B,f,c),m=h.length,E=g.length,l=e(h,g,m,E),l==1&&(f--,n(h,M<m?N:B,m,c))):(f==0&&(l=f=1),h=B.slice()),m=h.length,m<E&&h.unshift(0),n(g,h,E,c),l==-1&&(E=g.length,l=e(B,g,M,E),l<1&&(f++,n(g,M<E?N:B,E,c))),E=g.length):l===0&&(f++,g=[0]),w[u++]=f,l&&g[0]?g[E++]=I[b]||0:(g=[I[b]],E=1);while((b++<A||g[0]!==void 0)&&y--);D=g[0]!==void 0}w[0]||w.shift()}if(p==1)d.e=s,In=D;else{for(u=1,f=w[0];f>=10;f/=10)u++;d.e=u+s*p-1,vr(d,v?a+d.e+1:a,o,D)}return d}}();function vr(r,e,n,i){var t,a,o,v,c,l,s,u,f,p=r.constructor;r:if(e!=null){if(u=r.d,!u)return r;for(t=1,v=u[0];v>=10;v/=10)t++;if(a=e-t,a<0)a+=hr,o=e,s=u[f=0],c=s/Vr(10,t-o-1)%10|0;else if(f=Math.ceil((a+1)/hr),v=u.length,f>=v)if(i){for(;v++<=f;)u.push(0);s=c=0,t=1,a%=hr,o=a-hr+1}else break r;else{for(s=v=u[f],t=1;v>=10;v/=10)t++;a%=hr,o=a-hr+t,c=o<0?0:s/Vr(10,t-o-1)%10|0}if(i=i||e<0||u[f+1]!==void 0||(o<0?s:s%Vr(10,t-o-1)),l=n<4?(c||i)&&(n==0||n==(r.s<0?3:2)):c>5||c==5&&(n==4||i||n==6&&(a>0?o>0?s/Vr(10,t-o):0:u[f-1])%10&1||n==(r.s<0?8:7)),e<1||!u[0])return u.length=0,l?(e-=r.e+1,u[0]=Vr(10,(hr-e%hr)%hr),r.e=-e||0):u[0]=r.e=0,r;if(a==0?(u.length=f,v=1,f--):(u.length=f+1,v=Vr(10,hr-a),u[f]=o>0?(s/Vr(10,t-o)%Vr(10,o)|0)*v:0),l)for(;;)if(f==0){for(a=1,o=u[0];o>=10;o/=10)a++;for(o=u[0]+=v,v=1;o>=10;o/=10)v++;a!=v&&(r.e++,u[0]==ae&&(u[0]=1));break}else{if(u[f]+=v,u[f]!=ae)break;u[f--]=0,v=1}for(a=u.length;u[--a]===0;)u.pop()}return dr&&(r.e>p.maxE?(r.d=null,r.e=NaN):r.e<p.minE&&(r.e=0,r.d=[0])),r}function le(r,e,n){if(!r.isFinite())return Gn(r);var i,t=r.e,a=Yr(r.d),o=a.length;return e?(n&&(i=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+Ae(i):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(r.e<0?"e":"e+")+r.e):t<0?(a="0."+Ae(-t-1)+a,n&&(i=n-o)>0&&(a+=Ae(i))):t>=o?(a+=Ae(t+1-o),n&&(i=n-t-1)>0&&(a=a+"."+Ae(i))):((i=t+1)<o&&(a=a.slice(0,i)+"."+a.slice(i)),n&&(i=n-o)>0&&(t+1===o&&(a+="."),a+=Ae(i))),a}function gt(r,e){var n=r[0];for(e*=hr;n>=10;n/=10)e++;return e}function Dt(r,e,n){if(e>Vu)throw dr=!0,n&&(r.precision=n),Error($n);return vr(new r(ht),e,1,!0)}function ue(r,e,n){if(e>Yt)throw Error($n);return vr(new r(pt),e,n,!0)}function Rn(r){var e=r.length-1,n=e*hr+1;if(e=r[e],e){for(;e%10==0;e/=10)n--;for(e=r[0];e>=10;e/=10)n++}return n}function Ae(r){for(var e="";r--;)e+="0";return e}function Un(r,e,n,i){var t,a=new r(1),o=Math.ceil(i/hr+4);for(dr=!1;;){if(n%2&&(a=a.times(e),Jn(a.d,o)&&(t=!0)),n=Xr(n/2),n===0){n=a.d.length-1,t&&a.d[n]===0&&++a.d[n];break}e=e.times(e),Jn(e.d,o)}return dr=!0,a}function Vn(r){return r.d[r.d.length-1]&1}function Zn(r,e,n){for(var i,t=new r(e[0]),a=0;++a<e.length;)if(i=new r(e[a]),i.s)t[n](i)&&(t=i);else{t=i;break}return t}function Jt(r,e){var n,i,t,a,o,v,c,l=0,s=0,u=0,f=r.constructor,p=f.rounding,D=f.precision;if(!r.d||!r.d[0]||r.e>17)return new f(r.d?r.d[0]?r.s<0?0:1/0:1:r.s?r.s<0?0:r:NaN);for(e==null?(dr=!1,c=D):c=e,v=new f(.03125);r.e>-2;)r=r.times(v),u+=5;for(i=Math.log(Vr(2,u))/Math.LN10*2+5|0,c+=i,n=a=o=new f(1),f.precision=c;;){if(a=vr(a.times(r),c,1),n=n.times(++s),v=o.plus(Tr(a,n,c,1)),Yr(v.d).slice(0,c)===Yr(o.d).slice(0,c)){for(t=u;t--;)o=vr(o.times(o),c,1);if(e==null)if(l<3&&Qe(o.d,c-i,p,l))f.precision=c+=10,n=a=v=new f(1),s=0,l++;else return vr(o,f.precision=D,p,dr=!0);else return f.precision=D,o}o=v}}function Ee(r,e){var n,i,t,a,o,v,c,l,s,u,f,p=1,D=10,h=r,m=h.d,d=h.constructor,w=d.rounding,g=d.precision;if(h.s<0||!m||!m[0]||!h.e&&m[0]==1&&m.length==1)return new d(m&&!m[0]?-1/0:h.s!=1?NaN:m?0:h);if(e==null?(dr=!1,s=g):s=e,d.precision=s+=D,n=Yr(m),i=n.charAt(0),Math.abs(a=h.e)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)h=h.times(r),n=Yr(h.d),i=n.charAt(0),p++;a=h.e,i>1?(h=new d("0."+n),a++):h=new d(i+"."+n.slice(1))}else return l=Dt(d,s+2,g).times(a+""),h=Ee(new d(i+"."+n.slice(1)),s-D).plus(l),d.precision=g,e==null?vr(h,g,w,dr=!0):h;for(u=h,c=o=h=Tr(h.minus(1),h.plus(1),s,1),f=vr(h.times(h),s,1),t=3;;){if(o=vr(o.times(f),s,1),l=c.plus(Tr(o,new d(t),s,1)),Yr(l.d).slice(0,s)===Yr(c.d).slice(0,s))if(c=c.times(2),a!==0&&(c=c.plus(Dt(d,s+2,g).times(a+""))),c=Tr(c,new d(p),s,1),e==null)if(Qe(c.d,s-D,w,v))d.precision=s+=D,l=o=h=Tr(u.minus(1),u.plus(1),s,1),f=vr(h.times(h),s,1),t=v=1;else return vr(c,d.precision=g,w,dr=!0);else return d.precision=g,c;c=l,t+=2}}function Gn(r){return String(r.s*r.s/0)}function Qt(r,e){var n,i,t;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;e.charCodeAt(i)===48;i++);for(t=e.length;e.charCodeAt(t-1)===48;--t);if(e=e.slice(i,t),e){if(t-=i,r.e=n=n-i-1,r.d=[],i=(n+1)%hr,n<0&&(i+=hr),i<t){for(i&&r.d.push(+e.slice(0,i)),t-=hr;i<t;)r.d.push(+e.slice(i,i+=hr));e=e.slice(i),i=hr-e.length}else i-=t;for(;i--;)e+="0";r.d.push(+e),dr&&(r.e>r.constructor.maxE?(r.d=null,r.e=NaN):r.e<r.constructor.minE&&(r.e=0,r.d=[0]))}else r.e=0,r.d=[0];return r}function Gu(r,e){var n,i,t,a,o,v,c,l,s;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Pn.test(e))return Qt(r,e)}else if(e==="Infinity"||e==="NaN")return+e||(r.s=NaN),r.e=NaN,r.d=null,r;if(Pu.test(e))n=16,e=e.toLowerCase();else if(Lu.test(e))n=2;else if(Ru.test(e))n=8;else throw Error(we+e);for(a=e.search(/p/i),a>0?(c=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,i=r.constructor,o&&(e=e.replace(".",""),v=e.length,a=v-a,t=Un(i,new i(n),a,a*2)),l=mt(e,n,ae),s=l.length-1,a=s;l[a]===0;--a)l.pop();return a<0?new i(r.s*0):(r.e=gt(l,s),r.d=l,dr=!1,o&&(r=Tr(r,t,v*4)),c&&(r=r.times(Math.abs(c)<54?Vr(2,c):Le.pow(2,c))),dr=!0,r)}function Yu(r,e){var n,i=e.d.length;if(i<3)return e.isZero()?e:qe(r,2,e,e);n=1.4*Math.sqrt(i),n=n>16?16:n|0,e=e.times(1/yt(5,n)),e=qe(r,2,e,e);for(var t,a=new r(5),o=new r(16),v=new r(20);n--;)t=e.times(e),e=e.times(a.plus(t.times(o.times(t).minus(v))));return e}function qe(r,e,n,i,t){var a,o,v,c,l=r.precision,s=Math.ceil(l/hr);for(dr=!1,c=n.times(n),v=new r(i);;){if(o=Tr(v.times(c),new r(e++*e++),l,1),v=t?i.plus(o):i.minus(o),i=Tr(o.times(c),new r(e++*e++),l,1),o=v.plus(i),o.d[s]!==void 0){for(a=s;o.d[a]===v.d[a]&&a--;);if(a==-1)break}a=v,v=i,i=o,o=a}return dr=!0,o.d.length=s+1,o}function yt(r,e){for(var n=r;--e;)n*=r;return n}function Yn(r,e){var n,i=e.s<0,t=ue(r,r.precision,1),a=t.times(.5);if(e=e.abs(),e.lte(a))return pe=i?4:1,e;if(n=e.divToInt(t),n.isZero())pe=i?3:2;else{if(e=e.minus(n.times(t)),e.lte(a))return pe=Vn(n)?i?2:3:i?4:1,e;pe=Vn(n)?i?1:4:i?3:2}return e.minus(t).abs()}function Xt(r,e,n,i){var t,a,o,v,c,l,s,u,f,p=r.constructor,D=n!==void 0;if(D?(kr(n,1,ye),i===void 0?i=p.rounding:kr(i,0,8)):(n=p.precision,i=p.rounding),!r.isFinite())s=Gn(r);else{for(s=le(r),o=s.indexOf("."),D?(t=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):t=e,o>=0&&(s=s.replace(".",""),f=new p(1),f.e=s.length-o,f.d=mt(le(f),10,t),f.e=f.d.length),u=mt(s,10,t),a=c=u.length;u[--c]==0;)u.pop();if(!u[0])s=D?"0p+0":"0";else{if(o<0?a--:(r=new p(r),r.d=u,r.e=a,r=Tr(r,f,n,i,0,t),u=r.d,a=r.e,l=In),o=u[n],v=t/2,l=l||u[n+1]!==void 0,l=i<4?(o!==void 0||l)&&(i===0||i===(r.s<0?3:2)):o>v||o===v&&(i===4||l||i===6&&u[n-1]&1||i===(r.s<0?8:7)),u.length=n,l)for(;++u[--n]>t-1;)u[n]=0,n||(++a,u.unshift(1));for(c=u.length;!u[c-1];--c);for(o=0,s="";o<c;o++)s+=Zt.charAt(u[o]);if(D){if(c>1)if(e==16||e==8){for(o=e==16?4:3,--c;c%o;c++)s+="0";for(u=mt(s,t,e),c=u.length;!u[c-1];--c);for(o=1,s="1.";o<c;o++)s+=Zt.charAt(u[o])}else s=s.charAt(0)+"."+s.slice(1);s=s+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)s="0"+s;s="0."+s}else if(++a>c)for(a-=c;a--;)s+="0";else a<c&&(s=s.slice(0,a)+"."+s.slice(a))}s=(e==16?"0x":e==2?"0b":e==8?"0o":"")+s}return r.s<0?"-"+s:s}function Jn(r,e){if(r.length>e)return r.length=e,!0}function Ju(r){return new this(r).abs()}function Qu(r){return new this(r).acos()}function Xu(r){return new this(r).acosh()}function Ku(r,e){return new this(r).plus(e)}function Hu(r){return new this(r).asin()}function Wu(r){return new this(r).asinh()}function ku(r){return new this(r).atan()}function ju(r){return new this(r).atanh()}function ro(r,e){r=new this(r),e=new this(e);var n,i=this.precision,t=this.rounding,a=i+4;return!r.s||!e.s?n=new this(NaN):!r.d&&!e.d?(n=ue(this,a,1).times(e.s>0?.25:.75),n.s=r.s):!e.d||r.isZero()?(n=e.s<0?ue(this,i,t):new this(0),n.s=r.s):!r.d||e.isZero()?(n=ue(this,a,1).times(.5),n.s=r.s):e.s<0?(this.precision=a,this.rounding=1,n=this.atan(Tr(r,e,a,1)),e=ue(this,a,1),this.precision=i,this.rounding=t,n=r.s<0?n.minus(e):n.plus(e)):n=this.atan(Tr(r,e,a,1)),n}function eo(r){return new this(r).cbrt()}function to(r){return vr(r=new this(r),r.e+1,2)}function no(r,e,n){return new this(r).clamp(e,n)}function io(r){if(!r||typeof r!="object")throw Error(dt+"Object expected");var e,n,i,t=r.defaults===!0,a=["precision",1,ye,"rounding",0,8,"toExpNeg",-$e,0,"toExpPos",0,$e,"maxE",0,$e,"minE",-$e,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(n=a[e],t&&(this[n]=Gt[n]),(i=r[n])!==void 0)if(Xr(i)===i&&i>=a[e+1]&&i<=a[e+2])this[n]=i;else throw Error(we+n+": "+i);if(n="crypto",t&&(this[n]=Gt[n]),(i=r[n])!==void 0)if(i===!0||i===!1||i===0||i===1)if(i)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(qn);else this[n]=!1;else throw Error(we+n+": "+i);return this}function ao(r){return new this(r).cos()}function uo(r){return new this(r).cosh()}function Qn(r){var e,n,i;function t(a){var o,v,c,l=this;if(!(l instanceof t))return new t(a);if(l.constructor=t,Xn(a)){l.s=a.s,dr?!a.d||a.e>t.maxE?(l.e=NaN,l.d=null):a.e<t.minE?(l.e=0,l.d=[0]):(l.e=a.e,l.d=a.d.slice()):(l.e=a.e,l.d=a.d?a.d.slice():a.d);return}if(c=typeof a,c==="number"){if(a===0){l.s=1/a<0?-1:1,l.e=0,l.d=[0];return}if(a<0?(a=-a,l.s=-1):l.s=1,a===~~a&&a<1e7){for(o=0,v=a;v>=10;v/=10)o++;dr?o>t.maxE?(l.e=NaN,l.d=null):o<t.minE?(l.e=0,l.d=[0]):(l.e=o,l.d=[a]):(l.e=o,l.d=[a]);return}else if(a*0!==0){a||(l.s=NaN),l.e=NaN,l.d=null;return}return Qt(l,a.toString())}else if(c!=="string")throw Error(we+a);return(v=a.charCodeAt(0))===45?(a=a.slice(1),l.s=-1):(v===43&&(a=a.slice(1)),l.s=1),Pn.test(a)?Qt(l,a):Gu(l,a)}if(t.prototype=H,t.ROUND_UP=0,t.ROUND_DOWN=1,t.ROUND_CEIL=2,t.ROUND_FLOOR=3,t.ROUND_HALF_UP=4,t.ROUND_HALF_DOWN=5,t.ROUND_HALF_EVEN=6,t.ROUND_HALF_CEIL=7,t.ROUND_HALF_FLOOR=8,t.EUCLID=9,t.config=t.set=io,t.clone=Qn,t.isDecimal=Xn,t.abs=Ju,t.acos=Qu,t.acosh=Xu,t.add=Ku,t.asin=Hu,t.asinh=Wu,t.atan=ku,t.atanh=ju,t.atan2=ro,t.cbrt=eo,t.ceil=to,t.clamp=no,t.cos=ao,t.cosh=uo,t.div=oo,t.exp=so,t.floor=fo,t.hypot=co,t.ln=lo,t.log=vo,t.log10=po,t.log2=ho,t.max=mo,t.min=go,t.mod=Do,t.mul=yo,t.pow=wo,t.random=Ao,t.round=Eo,t.sign=Fo,t.sin=Co,t.sinh=bo,t.sqrt=Mo,t.sub=So,t.sum=No,t.tan=xo,t.tanh=Bo,t.trunc=_o,r===void 0&&(r={}),r&&r.defaults!==!0)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<i.length;)r.hasOwnProperty(n=i[e++])||(r[n]=this[n]);return t.config(r),t}function oo(r,e){return new this(r).div(e)}function so(r){return new this(r).exp()}function fo(r){return vr(r=new this(r),r.e+1,3)}function co(){var r,e,n=new this(0);for(dr=!1,r=0;r<arguments.length;)if(e=new this(arguments[r++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return dr=!0,new this(1/0);n=e}return dr=!0,n.sqrt()}function Xn(r){return r instanceof Le||r&&r.toStringTag===Ln||!1}function lo(r){return new this(r).ln()}function vo(r,e){return new this(r).log(e)}function ho(r){return new this(r).log(2)}function po(r){return new this(r).log(10)}function mo(){return Zn(this,arguments,"lt")}function go(){return Zn(this,arguments,"gt")}function Do(r,e){return new this(r).mod(e)}function yo(r,e){return new this(r).mul(e)}function wo(r,e){return new this(r).pow(e)}function Ao(r){var e,n,i,t,a=0,o=new this(1),v=[];if(r===void 0?r=this.precision:kr(r,1,ye),i=Math.ceil(r/hr),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(i));a<i;)t=e[a],t>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:v[a++]=t%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(i*=4);a<i;)t=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),t>=214e7?crypto.randomBytes(4).copy(e,a):(v.push(t%1e7),a+=4);a=i/4}else throw Error(qn);else for(;a<i;)v[a++]=Math.random()*1e7|0;for(i=v[--a],r%=hr,i&&r&&(t=Vr(10,hr-r),v[a]=(i/t|0)*t);v[a]===0;a--)v.pop();if(a<0)n=0,v=[0];else{for(n=-1;v[0]===0;n-=hr)v.shift();for(i=1,t=v[0];t>=10;t/=10)i++;i<hr&&(n-=hr-i)}return o.e=n,o.d=v,o}function Eo(r){return vr(r=new this(r),r.e+1,this.rounding)}function Fo(r){return r=new this(r),r.d?r.d[0]?r.s:0*r.s:r.s||NaN}function Co(r){return new this(r).sin()}function bo(r){return new this(r).sinh()}function Mo(r){return new this(r).sqrt()}function So(r,e){return new this(r).sub(e)}function No(){var r=0,e=arguments,n=new this(e[r]);for(dr=!1;n.s&&++r<e.length;)n=n.plus(e[r]);return dr=!0,vr(n,this.precision,this.rounding)}function xo(r){return new this(r).tan()}function Bo(r){return new this(r).tanh()}function _o(r){return vr(r=new this(r),r.e+1,1)}H[Symbol.for("nodejs.util.inspect.custom")]=H.toString,H[Symbol.toStringTag]="Decimal";var Le=H.constructor=Qn(Gt);ht=new Le(ht),pt=new Le(pt);var zo="BigNumber",To=["?on","config"],Oo=j(zo,To,r=>{var{on:e,config:n}=r,i=Le.clone({precision:n.precision,modulo:Le.EUCLID});return i.prototype=Object.create(i.prototype),i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(t){return new i(t.value)},e&&e("config",function(t,a){t.precision!==a.precision&&i.config({precision:t.precision})}),i},{isClass:!0});function Kn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Hn={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,e){(function(n){var i=Math.cosh||function(u){return Math.abs(u)<1e-9?1-u:(Math.exp(u)+Math.exp(-u))*.5},t=Math.sinh||function(u){return Math.abs(u)<1e-9?u:(Math.exp(u)-Math.exp(-u))*.5},a=function(u){var f=Math.PI/4;if(-f>u||u>f)return Math.cos(u)-1;var p=u*u;return p*(p*(p*(p*(p*(p*(p*(p/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},o=function(u,f){var p=Math.abs(u),D=Math.abs(f);return p<3e3&&D<3e3?Math.sqrt(p*p+D*D):(p<D?(p=D,D=u/f):D=f/u,p*Math.sqrt(1+D*D))},v=function(){throw SyntaxError("Invalid Param")};function c(u,f){var p=Math.abs(u),D=Math.abs(f);return u===0?Math.log(D):f===0?Math.log(p):p<3e3&&D<3e3?Math.log(u*u+f*f)*.5:(u=u/2,f=f/2,.5*Math.log(u*u+f*f)+Math.LN2)}var l=function(u,f){var p={re:0,im:0};if(u==null)p.re=p.im=0;else if(f!==void 0)p.re=u,p.im=f;else switch(typeof u){case"object":if("im"in u&&"re"in u)p.re=u.re,p.im=u.im;else if("abs"in u&&"arg"in u){if(!Number.isFinite(u.abs)&&Number.isFinite(u.arg))return s.INFINITY;p.re=u.abs*Math.cos(u.arg),p.im=u.abs*Math.sin(u.arg)}else if("r"in u&&"phi"in u){if(!Number.isFinite(u.r)&&Number.isFinite(u.phi))return s.INFINITY;p.re=u.r*Math.cos(u.phi),p.im=u.r*Math.sin(u.phi)}else u.length===2?(p.re=u[0],p.im=u[1]):v();break;case"string":p.im=p.re=0;var D=u.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),h=1,m=0;D===null&&v();for(var d=0;d<D.length;d++){var w=D[d];w===" "||w==="	"||w===`
`||(w==="+"?h++:w==="-"?m++:w==="i"||w==="I"?(h+m===0&&v(),D[d+1]!==" "&&!isNaN(D[d+1])?(p.im+=parseFloat((m%2?"-":"")+D[d+1]),d++):p.im+=parseFloat((m%2?"-":"")+"1"),h=m=0):((h+m===0||isNaN(w))&&v(),D[d+1]==="i"||D[d+1]==="I"?(p.im+=parseFloat((m%2?"-":"")+w),d++):p.re+=parseFloat((m%2?"-":"")+w),h=m=0))}h+m>0&&v();break;case"number":p.im=0,p.re=u;break;default:v()}return isNaN(p.re)||isNaN(p.im),p};function s(u,f){if(!(this instanceof s))return new s(u,f);var p=l(u,f);this.re=p.re,this.im=p.im}s.prototype={re:0,im:0,sign:function(){var u=this.abs();return new s(this.re/u,this.im/u)},add:function(u,f){var p=new s(u,f);return this.isInfinite()&&p.isInfinite()?s.NAN:this.isInfinite()||p.isInfinite()?s.INFINITY:new s(this.re+p.re,this.im+p.im)},sub:function(u,f){var p=new s(u,f);return this.isInfinite()&&p.isInfinite()?s.NAN:this.isInfinite()||p.isInfinite()?s.INFINITY:new s(this.re-p.re,this.im-p.im)},mul:function(u,f){var p=new s(u,f);return this.isInfinite()&&p.isZero()||this.isZero()&&p.isInfinite()?s.NAN:this.isInfinite()||p.isInfinite()?s.INFINITY:p.im===0&&this.im===0?new s(this.re*p.re,0):new s(this.re*p.re-this.im*p.im,this.re*p.im+this.im*p.re)},div:function(u,f){var p=new s(u,f);if(this.isZero()&&p.isZero()||this.isInfinite()&&p.isInfinite())return s.NAN;if(this.isInfinite()||p.isZero())return s.INFINITY;if(this.isZero()||p.isInfinite())return s.ZERO;u=this.re,f=this.im;var D=p.re,h=p.im,m,d;return h===0?new s(u/D,f/D):Math.abs(D)<Math.abs(h)?(d=D/h,m=D*d+h,new s((u*d+f)/m,(f*d-u)/m)):(d=h/D,m=h*d+D,new s((u+f*d)/m,(f-u*d)/m))},pow:function(u,f){var p=new s(u,f);if(u=this.re,f=this.im,p.isZero())return s.ONE;if(p.im===0){if(f===0&&u>0)return new s(Math.pow(u,p.re),0);if(u===0)switch((p.re%4+4)%4){case 0:return new s(Math.pow(f,p.re),0);case 1:return new s(0,Math.pow(f,p.re));case 2:return new s(-Math.pow(f,p.re),0);case 3:return new s(0,-Math.pow(f,p.re))}}if(u===0&&f===0&&p.re>0&&p.im>=0)return s.ZERO;var D=Math.atan2(f,u),h=c(u,f);return u=Math.exp(p.re*h-p.im*D),f=p.im*h+p.re*D,new s(u*Math.cos(f),u*Math.sin(f))},sqrt:function(){var u=this.re,f=this.im,p=this.abs(),D,h;if(u>=0){if(f===0)return new s(Math.sqrt(u),0);D=.5*Math.sqrt(2*(p+u))}else D=Math.abs(f)/Math.sqrt(2*(p-u));return u<=0?h=.5*Math.sqrt(2*(p-u)):h=Math.abs(f)/Math.sqrt(2*(p+u)),new s(D,f<0?-h:h)},exp:function(){var u=Math.exp(this.re);return this.im,new s(u*Math.cos(this.im),u*Math.sin(this.im))},expm1:function(){var u=this.re,f=this.im;return new s(Math.expm1(u)*Math.cos(f)+a(f),Math.exp(u)*Math.sin(f))},log:function(){var u=this.re,f=this.im;return new s(c(u,f),Math.atan2(f,u))},abs:function(){return o(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var u=this.re,f=this.im;return new s(Math.sin(u)*i(f),Math.cos(u)*t(f))},cos:function(){var u=this.re,f=this.im;return new s(Math.cos(u)*i(f),-Math.sin(u)*t(f))},tan:function(){var u=2*this.re,f=2*this.im,p=Math.cos(u)+i(f);return new s(Math.sin(u)/p,t(f)/p)},cot:function(){var u=2*this.re,f=2*this.im,p=Math.cos(u)-i(f);return new s(-Math.sin(u)/p,t(f)/p)},sec:function(){var u=this.re,f=this.im,p=.5*i(2*f)+.5*Math.cos(2*u);return new s(Math.cos(u)*i(f)/p,Math.sin(u)*t(f)/p)},csc:function(){var u=this.re,f=this.im,p=.5*i(2*f)-.5*Math.cos(2*u);return new s(Math.sin(u)*i(f)/p,-Math.cos(u)*t(f)/p)},asin:function(){var u=this.re,f=this.im,p=new s(f*f-u*u+1,-2*u*f).sqrt(),D=new s(p.re-f,p.im+u).log();return new s(D.im,-D.re)},acos:function(){var u=this.re,f=this.im,p=new s(f*f-u*u+1,-2*u*f).sqrt(),D=new s(p.re-f,p.im+u).log();return new s(Math.PI/2-D.im,D.re)},atan:function(){var u=this.re,f=this.im;if(u===0){if(f===1)return new s(0,1/0);if(f===-1)return new s(0,-1/0)}var p=u*u+(1-f)*(1-f),D=new s((1-f*f-u*u)/p,-2*u/p).log();return new s(-.5*D.im,.5*D.re)},acot:function(){var u=this.re,f=this.im;if(f===0)return new s(Math.atan2(1,u),0);var p=u*u+f*f;return p!==0?new s(u/p,-f/p).atan():new s(u!==0?u/0:0,f!==0?-f/0:0).atan()},asec:function(){var u=this.re,f=this.im;if(u===0&&f===0)return new s(0,1/0);var p=u*u+f*f;return p!==0?new s(u/p,-f/p).acos():new s(u!==0?u/0:0,f!==0?-f/0:0).acos()},acsc:function(){var u=this.re,f=this.im;if(u===0&&f===0)return new s(Math.PI/2,1/0);var p=u*u+f*f;return p!==0?new s(u/p,-f/p).asin():new s(u!==0?u/0:0,f!==0?-f/0:0).asin()},sinh:function(){var u=this.re,f=this.im;return new s(t(u)*Math.cos(f),i(u)*Math.sin(f))},cosh:function(){var u=this.re,f=this.im;return new s(i(u)*Math.cos(f),t(u)*Math.sin(f))},tanh:function(){var u=2*this.re,f=2*this.im,p=i(u)+Math.cos(f);return new s(t(u)/p,Math.sin(f)/p)},coth:function(){var u=2*this.re,f=2*this.im,p=i(u)-Math.cos(f);return new s(t(u)/p,-Math.sin(f)/p)},csch:function(){var u=this.re,f=this.im,p=Math.cos(2*f)-i(2*u);return new s(-2*t(u)*Math.cos(f)/p,2*i(u)*Math.sin(f)/p)},sech:function(){var u=this.re,f=this.im,p=Math.cos(2*f)+i(2*u);return new s(2*i(u)*Math.cos(f)/p,-2*t(u)*Math.sin(f)/p)},asinh:function(){var u=this.im;this.im=-this.re,this.re=u;var f=this.asin();return this.re=-this.im,this.im=u,u=f.re,f.re=-f.im,f.im=u,f},acosh:function(){var u=this.acos();if(u.im<=0){var f=u.re;u.re=-u.im,u.im=f}else{var f=u.im;u.im=-u.re,u.re=f}return u},atanh:function(){var u=this.re,f=this.im,p=u>1&&f===0,D=1-u,h=1+u,m=D*D+f*f,d=m!==0?new s((h*D-f*f)/m,(f*D+h*f)/m):new s(u!==-1?u/0:0,f!==0?f/0:0),w=d.re;return d.re=c(d.re,d.im)/2,d.im=Math.atan2(d.im,w)/2,p&&(d.im=-d.im),d},acoth:function(){var u=this.re,f=this.im;if(u===0&&f===0)return new s(0,Math.PI/2);var p=u*u+f*f;return p!==0?new s(u/p,-f/p).atanh():new s(u!==0?u/0:0,f!==0?-f/0:0).atanh()},acsch:function(){var u=this.re,f=this.im;if(f===0)return new s(u!==0?Math.log(u+Math.sqrt(u*u+1)):1/0,0);var p=u*u+f*f;return p!==0?new s(u/p,-f/p).asinh():new s(u!==0?u/0:0,f!==0?-f/0:0).asinh()},asech:function(){var u=this.re,f=this.im;if(this.isZero())return s.INFINITY;var p=u*u+f*f;return p!==0?new s(u/p,-f/p).acosh():new s(u!==0?u/0:0,f!==0?-f/0:0).acosh()},inverse:function(){if(this.isZero())return s.INFINITY;if(this.isInfinite())return s.ZERO;var u=this.re,f=this.im,p=u*u+f*f;return new s(u/p,-f/p)},conjugate:function(){return new s(this.re,-this.im)},neg:function(){return new s(-this.re,-this.im)},ceil:function(u){return u=Math.pow(10,u||0),new s(Math.ceil(this.re*u)/u,Math.ceil(this.im*u)/u)},floor:function(u){return u=Math.pow(10,u||0),new s(Math.floor(this.re*u)/u,Math.floor(this.im*u)/u)},round:function(u){return u=Math.pow(10,u||0),new s(Math.round(this.re*u)/u,Math.round(this.im*u)/u)},equals:function(u,f){var p=new s(u,f);return Math.abs(p.re-this.re)<=s.EPSILON&&Math.abs(p.im-this.im)<=s.EPSILON},clone:function(){return new s(this.re,this.im)},toString:function(){var u=this.re,f=this.im,p="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(u)<s.EPSILON&&(u=0),Math.abs(f)<s.EPSILON&&(f=0),f===0?p+u:(u!==0?(p+=u,p+=" ",f<0?(f=-f,p+="-"):p+="+",p+=" "):f<0&&(f=-f,p+="-"),f!==1&&(p+=f),p+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s.PI=new s(Math.PI,0),s.E=new s(Math.E,0),s.INFINITY=new s(1/0,1/0),s.NAN=new s(NaN,NaN),s.EPSILON=1e-15,Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Complex=s,r.exports=s})()})(Hn);var Io=Hn.exports;const Jr=Kn(Io);var $o="Complex",qo=[],Lo=j($o,qo,()=>(Object.defineProperty(Jr,"name",{value:"Complex"}),Jr.prototype.constructor=Jr,Jr.prototype.type="Complex",Jr.prototype.isComplex=!0,Jr.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Jr.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Jr.prototype.format=function(r){var e="",n=this.im,i=this.re,t=It(this.re,r),a=It(this.im,r),o=$r(r)?r:r?r.precision:null;if(o!==null){var v=Math.pow(10,-o);Math.abs(i/n)<v&&(i=0),Math.abs(n/i)<v&&(n=0)}return n===0?e=t:i===0?n===1?e="i":n===-1?e="-i":e=a+"i":n<0?n===-1?e=t+" - i":e=t+" - "+a.substring(1)+"i":n===1?e=t+" + i":e=t+" + "+a+"i",e},Jr.fromPolar=function(r){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return Jr(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var n=arguments[0],i=arguments[1];if($r(n)){if(un(i)&&i.hasBase("ANGLE")&&(i=i.toNumber("rad")),$r(i))return new Jr({r:n,phi:i});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Jr.prototype.valueOf=Jr.prototype.toString,Jr.fromJSON=function(r){return new Jr(r)},Jr.compare=function(r,e){return r.re>e.re?1:r.re<e.re?-1:r.im>e.im?1:r.im<e.im?-1:0},Jr),{isClass:!0}),Wn={exports:{}};/**
 * @license Fraction.js v4.3.0 20/08/2023
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2023, Robert Eisele (robert@raw.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,e){(function(n){var i=2e3,t={s:1,n:0,d:1};function a(d,w){if(isNaN(d=parseInt(d,10)))throw h();return d*w}function o(d,w){if(w===0)throw D();var g=Object.create(p.prototype);g.s=d<0?-1:1,d=d<0?-d:d;var E=f(d,w);return g.n=d/E,g.d=w/E,g}function v(d){for(var w={},g=d,E=2,F=4;F<=g;){for(;g%E===0;)g/=E,w[E]=(w[E]||0)+1;F+=1+2*E++}return g!==d?g>1&&(w[g]=(w[g]||0)+1):w[d]=(w[d]||0)+1,w}var c=function(d,w){var g=0,E=1,F=1,y=0,C=0,b=0,A=1,S=1,M=0,N=1,O=1,T=1,I=1e7,B;if(d!=null)if(w!==void 0){if(g=d,E=w,F=g*E,g%1!==0||E%1!==0)throw m()}else switch(typeof d){case"object":{if("d"in d&&"n"in d)g=d.n,E=d.d,"s"in d&&(g*=d.s);else if(0 in d)g=d[0],1 in d&&(E=d[1]);else throw h();F=g*E;break}case"number":{if(d<0&&(F=d,d=-d),d%1===0)g=d;else if(d>0){for(d>=1&&(S=Math.pow(10,Math.floor(1+Math.log(d)/Math.LN10)),d/=S);N<=I&&T<=I;)if(B=(M+O)/(N+T),d===B){N+T<=I?(g=M+O,E=N+T):T>N?(g=O,E=T):(g=M,E=N);break}else d>B?(M+=O,N+=T):(O+=M,T+=N),N>I?(g=O,E=T):(g=M,E=N);g*=S}else(isNaN(d)||isNaN(w))&&(E=g=NaN);break}case"string":{if(N=d.match(/\d+|./g),N===null)throw h();if(N[M]==="-"?(F=-1,M++):N[M]==="+"&&M++,N.length===M+1?C=a(N[M++],F):N[M+1]==="."||N[M]==="."?(N[M]!=="."&&(y=a(N[M++],F)),M++,(M+1===N.length||N[M+1]==="("&&N[M+3]===")"||N[M+1]==="'"&&N[M+3]==="'")&&(C=a(N[M],F),A=Math.pow(10,N[M].length),M++),(N[M]==="("&&N[M+2]===")"||N[M]==="'"&&N[M+2]==="'")&&(b=a(N[M+1],F),S=Math.pow(10,N[M+1].length)-1,M+=3)):N[M+1]==="/"||N[M+1]===":"?(C=a(N[M],F),A=a(N[M+2],1),M+=3):N[M+3]==="/"&&N[M+1]===" "&&(y=a(N[M],F),C=a(N[M+2],F),A=a(N[M+4],1),M+=5),N.length<=M){E=A*S,F=g=b+E*y+S*C;break}}default:throw h()}if(E===0)throw D();t.s=F<0?-1:1,t.n=Math.abs(g),t.d=Math.abs(E)};function l(d,w,g){for(var E=1;w>0;d=d*d%g,w>>=1)w&1&&(E=E*d%g);return E}function s(d,w){for(;w%2===0;w/=2);for(;w%5===0;w/=5);if(w===1)return 0;for(var g=10%w,E=1;g!==1;E++)if(g=g*10%w,E>i)return 0;return E}function u(d,w,g){for(var E=1,F=l(10,g,w),y=0;y<300;y++){if(E===F)return y;E=E*10%w,F=F*10%w}return 0}function f(d,w){if(!d)return w;if(!w)return d;for(;;){if(d%=w,!d)return w;if(w%=d,!w)return d}}function p(d,w){if(c(d,w),this instanceof p)d=f(t.d,t.n),this.s=t.s,this.n=t.n/d,this.d=t.d/d;else return o(t.s*t.n,t.d)}var D=function(){return new Error("Division by Zero")},h=function(){return new Error("Invalid argument")},m=function(){return new Error("Parameters must be integer")};p.prototype={s:1,n:0,d:1,abs:function(){return o(this.n,this.d)},neg:function(){return o(-this.s*this.n,this.d)},add:function(d,w){return c(d,w),o(this.s*this.n*t.d+t.s*this.d*t.n,this.d*t.d)},sub:function(d,w){return c(d,w),o(this.s*this.n*t.d-t.s*this.d*t.n,this.d*t.d)},mul:function(d,w){return c(d,w),o(this.s*t.s*this.n*t.n,this.d*t.d)},div:function(d,w){return c(d,w),o(this.s*t.s*this.n*t.d,this.d*t.n)},clone:function(){return o(this.s*this.n,this.d)},mod:function(d,w){if(isNaN(this.n)||isNaN(this.d))return new p(NaN);if(d===void 0)return o(this.s*this.n%this.d,1);if(c(d,w),t.n===0&&this.d===0)throw D();return o(this.s*(t.d*this.n)%(t.n*this.d),t.d*this.d)},gcd:function(d,w){return c(d,w),o(f(t.n,this.n)*f(t.d,this.d),t.d*this.d)},lcm:function(d,w){return c(d,w),t.n===0&&this.n===0?o(0,1):o(t.n*this.n,f(t.n,this.n)*f(t.d,this.d))},ceil:function(d){return d=Math.pow(10,d||0),isNaN(this.n)||isNaN(this.d)?new p(NaN):o(Math.ceil(d*this.s*this.n/this.d),d)},floor:function(d){return d=Math.pow(10,d||0),isNaN(this.n)||isNaN(this.d)?new p(NaN):o(Math.floor(d*this.s*this.n/this.d),d)},round:function(d){return d=Math.pow(10,d||0),isNaN(this.n)||isNaN(this.d)?new p(NaN):o(Math.round(d*this.s*this.n/this.d),d)},inverse:function(){return o(this.s*this.d,this.n)},pow:function(d,w){if(c(d,w),t.d===1)return t.s<0?o(Math.pow(this.s*this.d,t.n),Math.pow(this.n,t.n)):o(Math.pow(this.s*this.n,t.n),Math.pow(this.d,t.n));if(this.s<0)return null;var g=v(this.n),E=v(this.d),F=1,y=1;for(var C in g)if(C!=="1"){if(C==="0"){F=0;break}if(g[C]*=t.n,g[C]%t.d===0)g[C]/=t.d;else return null;F*=Math.pow(C,g[C])}for(var C in E)if(C!=="1"){if(E[C]*=t.n,E[C]%t.d===0)E[C]/=t.d;else return null;y*=Math.pow(C,E[C])}return t.s<0?o(y,F):o(F,y)},equals:function(d,w){return c(d,w),this.s*this.n*t.d===t.s*t.n*this.d},compare:function(d,w){c(d,w);var g=this.s*this.n*t.d-t.s*t.n*this.d;return(0<g)-(g<0)},simplify:function(d){if(isNaN(this.n)||isNaN(this.d))return this;d=d||.001;for(var w=this.abs(),g=w.toContinued(),E=1;E<g.length;E++){for(var F=o(g[E-1],1),y=E-2;y>=0;y--)F=F.inverse().add(g[y]);if(Math.abs(F.sub(w).valueOf())<d)return F.mul(this.s)}return this},divisible:function(d,w){return c(d,w),!(!(t.n*this.d)||this.n*t.d%(t.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(d){var w,g="",E=this.n,F=this.d;return this.s<0&&(g+="-"),F===1?g+=E:(d&&(w=Math.floor(E/F))>0&&(g+=w,g+=" ",E%=F),g+=E,g+="/",g+=F),g},toLatex:function(d){var w,g="",E=this.n,F=this.d;return this.s<0&&(g+="-"),F===1?g+=E:(d&&(w=Math.floor(E/F))>0&&(g+=w,E%=F),g+="\\frac{",g+=E,g+="}{",g+=F,g+="}"),g},toContinued:function(){var d,w=this.n,g=this.d,E=[];if(isNaN(w)||isNaN(g))return E;do E.push(Math.floor(w/g)),d=w%g,w=g,g=d;while(w!==1);return E},toString:function(d){var w=this.n,g=this.d;if(isNaN(w)||isNaN(g))return"NaN";d=d||15;var E=s(w,g),F=u(w,g,E),y=this.s<0?"-":"";if(y+=w/g|0,w%=g,w*=10,w&&(y+="."),E){for(var C=F;C--;)y+=w/g|0,w%=g,w*=10;y+="(";for(var C=E;C--;)y+=w/g|0,w%=g,w*=10;y+=")"}else for(var C=d;w&&C--;)y+=w/g|0,w%=g,w*=10;return y}},Object.defineProperty(p,"__esModule",{value:!0}),p.default=p,p.Fraction=p,r.exports=p})()})(Wn);var Po=Wn.exports;const de=Kn(Po);var Ro="Fraction",Uo=[],Vo=j(Ro,Uo,()=>(Object.defineProperty(de,"name",{value:"Fraction"}),de.prototype.constructor=de,de.prototype.type="Fraction",de.prototype.isFraction=!0,de.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},de.fromJSON=function(r){return new de(r)},de),{isClass:!0}),Zo="Matrix",Go=[],Yo=j(Zo,Go,()=>{function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}return r.prototype.type="Matrix",r.prototype.isMatrix=!0,r.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},r.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},r.prototype.create=function(e,n){throw new Error("Cannot invoke create on a Matrix interface")},r.prototype.subset=function(e,n,i){throw new Error("Cannot invoke subset on a Matrix interface")},r.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},r.prototype.set=function(e,n,i){throw new Error("Cannot invoke set on a Matrix interface")},r.prototype.resize=function(e,n){throw new Error("Cannot invoke resize on a Matrix interface")},r.prototype.reshape=function(e,n){throw new Error("Cannot invoke reshape on a Matrix interface")},r.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},r.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},r.prototype.map=function(e,n){throw new Error("Cannot invoke map on a Matrix interface")},r.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},r.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},r.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},r.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},r.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},r.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},r},{isClass:!0});function kn(r){return Object.keys(r.signatures||{}).reduce(function(e,n){var i=(n.match(/,/g)||[]).length+1;return Math.max(e,i)},-1)}var Jo="DenseMatrix",Qo=["Matrix"],Xo=j(Jo,Qo,r=>{var{Matrix:e}=r;function n(s,u){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(u&&!ne(u))throw new Error("Invalid datatype: "+u);if(xr(s))s.type==="DenseMatrix"?(this._data=Fr(s._data),this._size=Fr(s._size),this._datatype=u||s._datatype):(this._data=s.toArray(),this._size=s.size(),this._datatype=u||s._datatype);else if(s&&Mr(s.data)&&Mr(s.size))this._data=s.data,this._size=s.size,An(this._data,this._size),this._datatype=u||s.datatype;else if(Mr(s))this._data=l(s),this._size=Lr(this._data),An(this._data,this._size),this._datatype=u;else{if(s)throw new TypeError("Unsupported type of data ("+ce(s)+")");this._data=[],this._size=[0],this._datatype=u}}n.prototype=new e,n.prototype.createDenseMatrix=function(s,u){return new n(s,u)},Object.defineProperty(n,"name",{value:"DenseMatrix"}),n.prototype.constructor=n,n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return Je(this._data,ce)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(s,u){return new n(s,u)},n.prototype.subset=function(s,u,f){switch(arguments.length){case 1:return i(this,s);case 2:case 3:return a(this,s,u,f);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(s){if(!Mr(s))throw new TypeError("Array expected");if(s.length!==this._size.length)throw new wr(s.length,this._size.length);for(var u=0;u<s.length;u++)Br(s[u],this._size[u]);for(var f=this._data,p=0,D=s.length;p<D;p++){var h=s[p];Br(h,f.length),f=f[h]}return f},n.prototype.set=function(s,u,f){if(!Mr(s))throw new TypeError("Array expected");if(s.length<this._size.length)throw new wr(s.length,this._size.length,"<");var p,D,h,m=s.map(function(w){return w+1});c(this,m,f);var d=this._data;for(p=0,D=s.length-1;p<D;p++)h=s[p],Br(h,d.length),d=d[h];return h=s[s.length-1],Br(h,d.length),d[h]=u,this};function i(s,u){if(!ut(u))throw new TypeError("Invalid index");var f=u.isScalar();if(f)return s.get(u.min());var p=u.size();if(p.length!==s._size.length)throw new wr(p.length,s._size.length);for(var D=u.min(),h=u.max(),m=0,d=s._size.length;m<d;m++)Br(D[m],s._size[m]),Br(h[m],s._size[m]);return new n(t(s._data,u,p.length,0),s._datatype)}function t(s,u,f,p){var D=p===f-1,h=u.dimension(p);return D?h.map(function(m){return Br(m,s.length),s[m]}).valueOf():h.map(function(m){Br(m,s.length);var d=s[m];return t(d,u,f,p+1)}).valueOf()}function a(s,u,f,p){if(!u||u.isIndex!==!0)throw new TypeError("Invalid index");var D=u.size(),h=u.isScalar(),m;if(xr(f)?(m=f.size(),f=f.valueOf()):m=Lr(f),h){if(m.length!==0)throw new TypeError("Scalar expected");s.set(u.min(),f,p)}else{if(!ze(m,D))try{m.length===0?f=xn([f],D):f=xn(f,D),m=Lr(f)}catch{}if(D.length<s._size.length)throw new wr(D.length,s._size.length,"<");if(m.length<D.length){for(var d=0,w=0;D[d]===1&&m[d]===1;)d++;for(;D[d]===1;)w++,d++;f=bn(f,D.length,w,m)}if(!ze(D,m))throw new wr(D,m,">");var g=u.max().map(function(y){return y+1});c(s,g,p);var E=D.length,F=0;o(s._data,u,f,E,F)}return s}function o(s,u,f,p,D){var h=D===p-1,m=u.dimension(D);h?m.forEach(function(d,w){Br(d),s[d]=f[w[0]]}):m.forEach(function(d,w){Br(d),o(s[d],u,f[w[0]],p,D+1)})}n.prototype.resize=function(s,u,f){if(!at(s))throw new TypeError("Array or Matrix expected");var p=s.valueOf().map(h=>Array.isArray(h)&&h.length===1?h[0]:h),D=f?this.clone():this;return v(D,p,u)};function v(s,u,f){if(u.length===0){for(var p=s._data;Mr(p);)p=p[0];return p}return s._size=u.slice(0),s._data=ct(s._data,s._size,f),s}n.prototype.reshape=function(s,u){var f=u?this.clone():this;f._data=Lt(f._data,s);var p=f._size.reduce((D,h)=>D*h);return f._size=Pt(s,p),f};function c(s,u,f){for(var p=s._size.slice(0),D=!1;p.length<u.length;)p.push(0),D=!0;for(var h=0,m=u.length;h<m;h++)u[h]>p[h]&&(p[h]=u[h],D=!0);D&&v(s,p,f)}n.prototype.clone=function(){var s=new n({data:Fr(this._data),size:Fr(this._size),datatype:this._datatype});return s},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(s){var u=this,f=kn(s),p=function m(d,w){return Mr(d)?d.map(function(g,E){return m(g,w.concat(E))}):f===1?s(d):f===2?s(d,w):s(d,w,u)},D=p(this._data,[]),h=this._datatype!==void 0?Je(D,ce):void 0;return new n(D,h)},n.prototype.forEach=function(s){var u=this,f=function p(D,h){Mr(D)?D.forEach(function(m,d){p(m,h.concat(d))}):s(D,h,u)};f(this._data,[])},n.prototype[Symbol.iterator]=function*(){var s=function*u(f,p){if(Mr(f))for(var D=0;D<f.length;D++)yield*u(f[D],p.concat(D));else yield{value:f,index:p}};yield*s(this._data,[])},n.prototype.rows=function(){var s=[],u=this.size();if(u.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var f=this._data;for(var p of f)s.push(new n([p],this._datatype));return s},n.prototype.columns=function(){var s=this,u=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var p=this._data,D=function(d){var w=p.map(g=>[g[d]]);u.push(new n(w,s._datatype))},h=0;h<f[1];h++)D(h);return u},n.prototype.toArray=function(){return Fr(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(s){return qr(this._data,s)},n.prototype.toString=function(){return qr(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(s){if(s){if(Rr(s)&&(s=s.toNumber()),!$r(s)||!zr(s))throw new TypeError("The parameter k must be an integer number")}else s=0;for(var u=s>0?s:0,f=s<0?-s:0,p=this._size[0],D=this._size[1],h=Math.min(p-f,D-u),m=[],d=0;d<h;d++)m[d]=this._data[d+f][d+u];return new n({data:m,size:[h],datatype:this._datatype})},n.diagonal=function(s,u,f,p){if(!Mr(s))throw new TypeError("Array expected, size parameter");if(s.length!==2)throw new Error("Only two dimensions matrix are supported");if(s=s.map(function(C){if(Rr(C)&&(C=C.toNumber()),!$r(C)||!zr(C)||C<1)throw new Error("Size values must be positive integers");return C}),f){if(Rr(f)&&(f=f.toNumber()),!$r(f)||!zr(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var D=f>0?f:0,h=f<0?-f:0,m=s[0],d=s[1],w=Math.min(m-h,d-D),g;if(Mr(u)){if(u.length!==w)throw new Error("Invalid value array length");g=function(b){return u[b]}}else if(xr(u)){var E=u.size();if(E.length!==1||E[0]!==w)throw new Error("Invalid matrix length");g=function(b){return u.get([b])}}else g=function(){return u};p||(p=Rr(g(0))?g(0).mul(0):0);var F=[];if(s.length>0){F=ct(F,s,p);for(var y=0;y<w;y++)F[y+h][y+D]=g(y)}return new n({data:F,size:[m,d]})},n.fromJSON=function(s){return new n(s)},n.prototype.swapRows=function(s,u){if(!$r(s)||!zr(s)||!$r(u)||!zr(u))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Br(s,this._size[0]),Br(u,this._size[0]),n._swapRows(s,u,this._data),this},n._swapRows=function(s,u,f){var p=f[s];f[s]=f[u],f[u]=p};function l(s){return xr(s)?l(s.valueOf()):Mr(s)?s.map(l):s}return n},{isClass:!0});function jr(r,e,n){return r&&typeof r.map=="function"?r.map(function(i){return jr(i,e)}):e(r)}var jn="isInteger",Ko=["typed"],Ho=j(jn,Ko,r=>{var{typed:e}=r;return e(jn,{number:zr,BigNumber:function(i){return i.isInt()},Fraction:function(i){return i.d===1&&isFinite(i.n)},"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),Kt="number",wt="number, number";function ri(r){return Math.abs(r)}ri.signature=Kt;function ei(r,e){return r+e}ei.signature=wt;function ti(r,e){return r-e}ti.signature=wt;function ni(r,e){return r*e}ni.signature=wt;function ii(r){return-r}ii.signature=Kt;function Ht(r){return lu(r)}Ht.signature=Kt;function ai(r,e){return r*r<1&&e===1/0||r*r>1&&e===-1/0?0:Math.pow(r,e)}ai.signature=wt;var ui="number";function oi(r){return r>0}oi.signature=ui;function si(r){return r===0}si.signature=ui;var fi="isPositive",Wo=["typed"],ko=j(fi,Wo,r=>{var{typed:e}=r;return e(fi,{number:oi,BigNumber:function(i){return!i.isNeg()&&!i.isZero()&&!i.isNaN()},Fraction:function(i){return i.s>0&&i.n>0},Unit:e.referToSelf(n=>i=>e.find(n,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),ci="isZero",jo=["typed"],rs=j(ci,jo,r=>{var{typed:e}=r;return e(ci,{number:si,BigNumber:function(i){return i.isZero()},Complex:function(i){return i.re===0&&i.im===0},Fraction:function(i){return i.d===1&&i.n===0},Unit:e.referToSelf(n=>i=>e.find(n,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),li="typeOf",es=["typed"],ts=j(li,es,r=>{var{typed:e}=r;return e(li,{any:ce})});function Xe(r,e,n){if(n==null)return r.eq(e);if(r.eq(e))return!0;if(r.isNaN()||e.isNaN())return!1;if(r.isFinite()&&e.isFinite()){var i=r.minus(e).abs();if(i.isZero())return!0;var t=r.constructor.max(r.abs(),e.abs());return i.lte(t.times(n))}return!1}function ns(r,e,n){return De(r.re,e.re,n)&&De(r.im,e.im,n)}var Ke=j("compareUnits",["typed"],r=>{var{typed:e}=r;return{"Unit, Unit":e.referToSelf(n=>(i,t)=>{if(!i.equalBase(t))throw new Error("Cannot compare units with different base");return e.find(n,[i.valueType(),t.valueType()])(i.value,t.value)})}}),At="equalScalar",is=["typed","config"],as=j(At,is,r=>{var{typed:e,config:n}=r,i=Ke({typed:e});return e(At,{"boolean, boolean":function(a,o){return a===o},"number, number":function(a,o){return De(a,o,n.epsilon)},"BigNumber, BigNumber":function(a,o){return a.eq(o)||Xe(a,o,n.epsilon)},"Fraction, Fraction":function(a,o){return a.equals(o)},"Complex, Complex":function(a,o){return ns(a,o,n.epsilon)}},i)});j(At,["typed","config"],r=>{var{typed:e,config:n}=r;return e(At,{"number, number":function(t,a){return De(t,a,n.epsilon)}})});var us="SparseMatrix",os=["typed","equalScalar","Matrix"],ss=j(us,os,r=>{var{typed:e,equalScalar:n,Matrix:i}=r;function t(h,m){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(m&&!ne(m))throw new Error("Invalid datatype: "+m);if(xr(h))a(this,h,m);else if(h&&Mr(h.index)&&Mr(h.ptr)&&Mr(h.size))this._values=h.values,this._index=h.index,this._ptr=h.ptr,this._size=h.size,this._datatype=m||h.datatype;else if(Mr(h))o(this,h,m);else{if(h)throw new TypeError("Unsupported type of data ("+ce(h)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=m}}function a(h,m,d){m.type==="SparseMatrix"?(h._values=m._values?Fr(m._values):void 0,h._index=Fr(m._index),h._ptr=Fr(m._ptr),h._size=Fr(m._size),h._datatype=d||m._datatype):o(h,m.valueOf(),d||m._datatype)}function o(h,m,d){h._values=[],h._index=[],h._ptr=[],h._datatype=d;var w=m.length,g=0,E=n,F=0;if(ne(d)&&(E=e.find(n,[d,d])||n,F=e.convert(0,d)),w>0){var y=0;do{h._ptr.push(h._index.length);for(var C=0;C<w;C++){var b=m[C];if(Mr(b)){if(y===0&&g<b.length&&(g=b.length),y<b.length){var A=b[y];E(A,F)||(h._values.push(A),h._index.push(C))}}else y===0&&g<1&&(g=1),E(b,F)||(h._values.push(b),h._index.push(C))}y++}while(y<g)}h._ptr.push(h._index.length),h._size=[w,g]}t.prototype=new i,t.prototype.createSparseMatrix=function(h,m){return new t(h,m)},Object.defineProperty(t,"name",{value:"SparseMatrix"}),t.prototype.constructor=t,t.prototype.type="SparseMatrix",t.prototype.isSparseMatrix=!0,t.prototype.getDataType=function(){return Je(this._values,ce)},t.prototype.storage=function(){return"sparse"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(h,m){return new t(h,m)},t.prototype.density=function(){var h=this._size[0],m=this._size[1];return h!==0&&m!==0?this._index.length/(h*m):0},t.prototype.subset=function(h,m,d){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return v(this,h);case 2:case 3:return c(this,h,m,d);default:throw new SyntaxError("Wrong number of arguments")}};function v(h,m){if(!ut(m))throw new TypeError("Invalid index");var d=m.isScalar();if(d)return h.get(m.min());var w=m.size();if(w.length!==h._size.length)throw new wr(w.length,h._size.length);var g,E,F,y,C=m.min(),b=m.max();for(g=0,E=h._size.length;g<E;g++)Br(C[g],h._size[g]),Br(b[g],h._size[g]);var A=h._values,S=h._index,M=h._ptr,N=m.dimension(0),O=m.dimension(1),T=[],I=[];N.forEach(function(z,V){I[z]=V[0],T[z]=!0});var B=A?[]:void 0,G=[],q=[];return O.forEach(function(z){for(q.push(G.length),F=M[z],y=M[z+1];F<y;F++)g=S[F],T[g]===!0&&(G.push(I[g]),B&&B.push(A[F]))}),q.push(G.length),new t({values:B,index:G,ptr:q,size:w,datatype:h._datatype})}function c(h,m,d,w){if(!m||m.isIndex!==!0)throw new TypeError("Invalid index");var g=m.size(),E=m.isScalar(),F;if(xr(d)?(F=d.size(),d=d.toArray()):F=Lr(d),E){if(F.length!==0)throw new TypeError("Scalar expected");h.set(m.min(),d,w)}else{if(g.length!==1&&g.length!==2)throw new wr(g.length,h._size.length,"<");if(F.length<g.length){for(var y=0,C=0;g[y]===1&&F[y]===1;)y++;for(;g[y]===1;)C++,y++;d=bn(d,g.length,C,F)}if(!ze(g,F))throw new wr(g,F,">");if(g.length===1){var b=m.dimension(0);b.forEach(function(M,N){Br(M),h.set([M,0],d[N[0]],w)})}else{var A=m.dimension(0),S=m.dimension(1);A.forEach(function(M,N){Br(M),S.forEach(function(O,T){Br(O),h.set([M,O],d[N[0]][T[0]],w)})})}}return h}t.prototype.get=function(h){if(!Mr(h))throw new TypeError("Array expected");if(h.length!==this._size.length)throw new wr(h.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var m=h[0],d=h[1];Br(m,this._size[0]),Br(d,this._size[1]);var w=l(m,this._ptr[d],this._ptr[d+1],this._index);return w<this._ptr[d+1]&&this._index[w]===m?this._values[w]:0},t.prototype.set=function(h,m,d){if(!Mr(h))throw new TypeError("Array expected");if(h.length!==this._size.length)throw new wr(h.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var w=h[0],g=h[1],E=this._size[0],F=this._size[1],y=n,C=0;ne(this._datatype)&&(y=e.find(n,[this._datatype,this._datatype])||n,C=e.convert(0,this._datatype)),(w>E-1||g>F-1)&&(f(this,Math.max(w+1,E),Math.max(g+1,F),d),E=this._size[0],F=this._size[1]),Br(w,E),Br(g,F);var b=l(w,this._ptr[g],this._ptr[g+1],this._index);return b<this._ptr[g+1]&&this._index[b]===w?y(m,C)?s(b,g,this._values,this._index,this._ptr):this._values[b]=m:y(m,C)||u(b,w,g,m,this._values,this._index,this._ptr),this};function l(h,m,d,w){if(d-m===0)return d;for(var g=m;g<d;g++)if(w[g]===h)return g;return m}function s(h,m,d,w,g){d.splice(h,1),w.splice(h,1);for(var E=m+1;E<g.length;E++)g[E]--}function u(h,m,d,w,g,E,F){g.splice(h,0,w),E.splice(h,0,m);for(var y=d+1;y<F.length;y++)F[y]++}t.prototype.resize=function(h,m,d){if(!at(h))throw new TypeError("Array or Matrix expected");var w=h.valueOf().map(E=>Array.isArray(E)&&E.length===1?E[0]:E);if(w.length!==2)throw new Error("Only two dimensions matrix are supported");w.forEach(function(E){if(!$r(E)||!zr(E)||E<0)throw new TypeError("Invalid size, must contain positive integers (size: "+qr(w)+")")});var g=d?this.clone():this;return f(g,w[0],w[1],m)};function f(h,m,d,w){var g=w||0,E=n,F=0;ne(h._datatype)&&(E=e.find(n,[h._datatype,h._datatype])||n,F=e.convert(0,h._datatype),g=e.convert(g,h._datatype));var y=!E(g,F),C=h._size[0],b=h._size[1],A,S,M;if(d>b){for(S=b;S<d;S++)if(h._ptr[S]=h._values.length,y)for(A=0;A<C;A++)h._values.push(g),h._index.push(A);h._ptr[d]=h._values.length}else d<b&&(h._ptr.splice(d+1,b-d),h._values.splice(h._ptr[d],h._values.length),h._index.splice(h._ptr[d],h._index.length));if(b=d,m>C){if(y){var N=0;for(S=0;S<b;S++){h._ptr[S]=h._ptr[S]+N,M=h._ptr[S+1]+N;var O=0;for(A=C;A<m;A++,O++)h._values.splice(M+O,0,g),h._index.splice(M+O,0,A),N++}h._ptr[b]=h._values.length}}else if(m<C){var T=0;for(S=0;S<b;S++){h._ptr[S]=h._ptr[S]-T;var I=h._ptr[S],B=h._ptr[S+1]-T;for(M=I;M<B;M++)A=h._index[M],A>m-1&&(h._values.splice(M,1),h._index.splice(M,1),T++)}h._ptr[S]=h._values.length}return h._size[0]=m,h._size[1]=d,h}t.prototype.reshape=function(h,m){if(!Mr(h))throw new TypeError("Array expected");if(h.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");h.forEach(function(z){if(!$r(z)||!zr(z)||z<=-2||z===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+qr(h)+")")});var d=this._size[0]*this._size[1];h=Pt(h,d);var w=h[0]*h[1];if(d!==w)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var g=m?this.clone():this;if(this._size[0]===h[0]&&this._size[1]===h[1])return g;for(var E=[],F=0;F<g._ptr.length;F++)for(var y=0;y<g._ptr[F+1]-g._ptr[F];y++)E.push(F);for(var C=g._values.slice(),b=g._index.slice(),A=0;A<g._index.length;A++){var S=b[A],M=E[A],N=S*g._size[1]+M;E[A]=N%h[1],b[A]=Math.floor(N/h[1])}g._values.length=0,g._index.length=0,g._ptr.length=h[1]+1,g._size=h.slice();for(var O=0;O<g._ptr.length;O++)g._ptr[O]=0;for(var T=0;T<C.length;T++){var I=b[T],B=E[T],G=C[T],q=l(I,g._ptr[B],g._ptr[B+1],g._index);u(q,I,B,G,g._values,g._index,g._ptr)}return g},t.prototype.clone=function(){var h=new t({values:this._values?Fr(this._values):void 0,index:Fr(this._index),ptr:Fr(this._ptr),size:Fr(this._size),datatype:this._datatype});return h},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(h,m){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var d=this,w=this._size[0],g=this._size[1],E=kn(h),F=function(C,b,A){return E===1?h(C):E===2?h(C,[b,A]):h(C,[b,A],d)};return p(this,0,w-1,0,g-1,F,m)};function p(h,m,d,w,g,E,F){var y=[],C=[],b=[],A=n,S=0;ne(h._datatype)&&(A=e.find(n,[h._datatype,h._datatype])||n,S=e.convert(0,h._datatype));for(var M=function(L,Z,nr){L=E(L,Z,nr),A(L,S)||(y.push(L),C.push(Z))},N=w;N<=g;N++){b.push(y.length);var O=h._ptr[N],T=h._ptr[N+1];if(F)for(var I=O;I<T;I++){var B=h._index[I];B>=m&&B<=d&&M(h._values[I],B-m,N-w)}else{for(var G={},q=O;q<T;q++){var z=h._index[q];G[z]=h._values[q]}for(var V=m;V<=d;V++){var W=V in G?G[V]:0;M(W,V-m,N-w)}}}return b.push(y.length),new t({values:y,index:C,ptr:b,size:[d-m+1,g-w+1]})}t.prototype.forEach=function(h,m){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var d=this,w=this._size[0],g=this._size[1],E=0;E<g;E++){var F=this._ptr[E],y=this._ptr[E+1];if(m)for(var C=F;C<y;C++){var b=this._index[C];h(this._values[C],[b,E],d)}else{for(var A={},S=F;S<y;S++){var M=this._index[S];A[M]=this._values[S]}for(var N=0;N<w;N++){var O=N in A?A[N]:0;h(O,[N,E],d)}}}},t.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var h=this._size[1],m=0;m<h;m++)for(var d=this._ptr[m],w=this._ptr[m+1],g=d;g<w;g++){var E=this._index[g];yield{value:this._values[g],index:[E,m]}}},t.prototype.toArray=function(){return D(this._values,this._index,this._ptr,this._size,!0)},t.prototype.valueOf=function(){return D(this._values,this._index,this._ptr,this._size,!1)};function D(h,m,d,w,g){var E=w[0],F=w[1],y=[],C,b;for(C=0;C<E;C++)for(y[C]=[],b=0;b<F;b++)y[C][b]=0;for(b=0;b<F;b++)for(var A=d[b],S=d[b+1],M=A;M<S;M++)C=m[M],y[C][b]=h?g?Fr(h[M]):h[M]:1;return y}return t.prototype.format=function(h){for(var m=this._size[0],d=this._size[1],w=this.density(),g="Sparse Matrix ["+qr(m,h)+" x "+qr(d,h)+"] density: "+qr(w,h)+`
`,E=0;E<d;E++)for(var F=this._ptr[E],y=this._ptr[E+1],C=F;C<y;C++){var b=this._index[C];g+=`
    (`+qr(b,h)+", "+qr(E,h)+") ==> "+(this._values?qr(this._values[C],h):"X")}return g},t.prototype.toString=function(){return qr(this.toArray())},t.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(h){if(h){if(Rr(h)&&(h=h.toNumber()),!$r(h)||!zr(h))throw new TypeError("The parameter k must be an integer number")}else h=0;var m=h>0?h:0,d=h<0?-h:0,w=this._size[0],g=this._size[1],E=Math.min(w-d,g-m),F=[],y=[],C=[];C[0]=0;for(var b=m;b<g&&F.length<E;b++)for(var A=this._ptr[b],S=this._ptr[b+1],M=A;M<S;M++){var N=this._index[M];if(N===b-m+d){F.push(this._values[M]),y[F.length-1]=N-d;break}}return C.push(F.length),new t({values:F,index:y,ptr:C,size:[E,1]})},t.fromJSON=function(h){return new t(h)},t.diagonal=function(h,m,d,w,g){if(!Mr(h))throw new TypeError("Array expected, size parameter");if(h.length!==2)throw new Error("Only two dimensions matrix are supported");if(h=h.map(function(z){if(Rr(z)&&(z=z.toNumber()),!$r(z)||!zr(z)||z<1)throw new Error("Size values must be positive integers");return z}),d){if(Rr(d)&&(d=d.toNumber()),!$r(d)||!zr(d))throw new TypeError("The parameter k must be an integer number")}else d=0;var E=n,F=0;ne(g)&&(E=e.find(n,[g,g])||n,F=e.convert(0,g));var y=d>0?d:0,C=d<0?-d:0,b=h[0],A=h[1],S=Math.min(b-C,A-y),M;if(Mr(m)){if(m.length!==S)throw new Error("Invalid value array length");M=function(V){return m[V]}}else if(xr(m)){var N=m.size();if(N.length!==1||N[0]!==S)throw new Error("Invalid matrix length");M=function(V){return m.get([V])}}else M=function(){return m};for(var O=[],T=[],I=[],B=0;B<A;B++){I.push(O.length);var G=B-y;if(G>=0&&G<S){var q=M(G);E(q,F)||(T.push(G+C),O.push(q))}}return I.push(O.length),new t({values:O,index:T,ptr:I,size:[b,A]})},t.prototype.swapRows=function(h,m){if(!$r(h)||!zr(h)||!$r(m)||!zr(m))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return Br(h,this._size[0]),Br(m,this._size[0]),t._swapRows(h,m,this._size[1],this._values,this._index,this._ptr),this},t._forEachRow=function(h,m,d,w,g){for(var E=w[h],F=w[h+1],y=E;y<F;y++)g(d[y],m[y])},t._swapRows=function(h,m,d,w,g,E){for(var F=0;F<d;F++){var y=E[F],C=E[F+1],b=l(h,y,C,g),A=l(m,y,C,g);if(b<C&&A<C&&g[b]===h&&g[A]===m){if(w){var S=w[b];w[b]=w[A],w[A]=S}continue}if(b<C&&g[b]===h&&(A>=C||g[A]!==m)){var M=w?w[b]:void 0;g.splice(A,0,m),w&&w.splice(A,0,M),g.splice(A<=b?b+1:b,1),w&&w.splice(A<=b?b+1:b,1);continue}if(A<C&&g[A]===m&&(b>=C||g[b]!==h)){var N=w?w[A]:void 0;g.splice(b,0,h),w&&w.splice(b,0,N),g.splice(b<=A?A+1:A,1),w&&w.splice(b<=A?A+1:A,1)}}},t},{isClass:!0}),fs="number",cs=["typed"];function ls(r){var e=r.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(e){var n={"0b":2,"0o":8,"0x":16}[e[1]],i=e[2],t=e[3];return{input:r,radix:n,integerPart:i,fractionalPart:t}}else return null}function vs(r){for(var e=parseInt(r.integerPart,r.radix),n=0,i=0;i<r.fractionalPart.length;i++){var t=parseInt(r.fractionalPart[i],r.radix);n+=t/Math.pow(r.radix,i+1)}var a=e+n;if(isNaN(a))throw new SyntaxError('String "'+r.input+'" is not a valid number');return a}var hs=j(fs,cs,r=>{var{typed:e}=r,n=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if(t==="NaN")return NaN;var a=ls(t);if(a)return vs(a);var o=0,v=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);v&&(o=Number(v[2]),t=v[1]);var c=Number(t);if(isNaN(c))throw new SyntaxError('String "'+t+'" is not a valid number');if(v){if(c>2**o-1)throw new SyntaxError('String "'.concat(t,'" is out of range'));c>=2**(o-1)&&(c=c-2**o)}return c},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:e.referToSelf(i=>t=>{var a=t.clone();return a.value=i(t.value),a}),null:function(t){return 0},"Unit, string | Unit":function(t,a){return t.toNumber(a)},"Array | Matrix":e.referToSelf(i=>t=>jr(t,i))});return n.fromJSON=function(i){return parseFloat(i.value)},n}),ps="bignumber",ds=["typed","BigNumber"],ms=j(ps,ds,r=>{var{typed:e,BigNumber:n}=r;return e("bignumber",{"":function(){return new n(0)},number:function(t){return new n(t+"")},string:function(t){var a=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(a){var o=a[2],v=n(a[1]),c=new n(2).pow(Number(o));if(v.gt(c.sub(1)))throw new SyntaxError('String "'.concat(t,'" is out of range'));var l=new n(2).pow(Number(o)-1);return v.gte(l)?v.sub(c):v}return new n(t)},BigNumber:function(t){return t},Unit:e.referToSelf(i=>t=>{var a=t.clone();return a.value=i(t.value),a}),Fraction:function(t){return new n(t.n).div(t.d).times(t.s)},null:function(t){return new n(0)},"Array | Matrix":e.referToSelf(i=>t=>jr(t,i))})}),gs="complex",Ds=["typed","Complex"],ys=j(gs,Ds,r=>{var{typed:e,Complex:n}=r;return e("complex",{"":function(){return n.ZERO},number:function(t){return new n(t,0)},"number, number":function(t,a){return new n(t,a)},"BigNumber, BigNumber":function(t,a){return new n(t.toNumber(),a.toNumber())},Fraction:function(t){return new n(t.valueOf(),0)},Complex:function(t){return t.clone()},string:function(t){return n(t)},null:function(t){return n(0)},Object:function(t){if("re"in t&&"im"in t)return new n(t.re,t.im);if("r"in t&&"phi"in t||"abs"in t&&"arg"in t)return new n(t);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(i=>t=>jr(t,i))})}),ws="fraction",As=["typed","Fraction"],Es=j(ws,As,r=>{var{typed:e,Fraction:n}=r;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new n(t)},string:function(t){return new n(t)},"number, number":function(t,a){return new n(t,a)},null:function(t){return new n(0)},BigNumber:function(t){return new n(t.toString())},Fraction:function(t){return t},Unit:e.referToSelf(i=>t=>{var a=t.clone();return a.value=i(t.value),a}),Object:function(t){return new n(t)},"Array | Matrix":e.referToSelf(i=>t=>jr(t,i))})}),vi="matrix",Fs=["typed","Matrix","DenseMatrix","SparseMatrix"],Cs=j(vi,Fs,r=>{var{typed:e,Matrix:n,DenseMatrix:i,SparseMatrix:t}=r;return e(vi,{"":function(){return a([])},string:function(v){return a([],v)},"string, string":function(v,c){return a([],v,c)},Array:function(v){return a(v)},Matrix:function(v){return a(v,v.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(o,v,c){if(v==="dense"||v==="default"||v===void 0)return new i(o,c);if(v==="sparse")return new t(o,c);throw new TypeError("Unknown matrix type "+JSON.stringify(v)+".")}}),hi="matrixFromColumns",bs=["typed","matrix","flatten","size"],Ms=j(hi,bs,r=>{var{typed:e,matrix:n,flatten:i,size:t}=r;return e(hi,{"...Array":function(c){return a(c)},"...Matrix":function(c){return n(a(c.map(l=>l.toArray())))}});function a(v){if(v.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var c=o(v[0]),l=[],s=0;s<c;s++)l[s]=[];for(var u of v){var f=o(u);if(f!==c)throw new TypeError("The vectors had different length: "+(c|0)+" ≠ "+(f|0));for(var p=i(u),D=0;D<c;D++)l[D].push(p[D])}return l}function o(v){var c=t(v);if(c.length===1)return c[0];if(c.length===2){if(c[0]===1)return c[1];if(c[1]===1)return c[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),pi="unaryMinus",Ss=["typed"],Ns=j(pi,Ss,r=>{var{typed:e}=r;return e(pi,{number:ii,"Complex | BigNumber | Fraction":n=>n.neg(),Unit:e.referToSelf(n=>i=>{var t=i.clone();return t.value=e.find(n,t.valueType())(i.value),t}),"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),di="abs",xs=["typed"],Bs=j(di,xs,r=>{var{typed:e}=r;return e(di,{number:ri,"Complex | BigNumber | Fraction | Unit":n=>n.abs(),"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),mi="addScalar",_s=["typed"],zs=j(mi,_s,r=>{var{typed:e}=r;return e(mi,{"number, number":ei,"Complex, Complex":function(i,t){return i.add(t)},"BigNumber, BigNumber":function(i,t){return i.plus(t)},"Fraction, Fraction":function(i,t){return i.add(t)},"Unit, Unit":e.referToSelf(n=>(i,t)=>{if(i.value===null||i.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(t.value===null||t.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!i.equalBase(t))throw new Error("Units do not match");var a=i.clone();return a.value=e.find(n,[a.valueType(),t.valueType()])(a.value,t.value),a.fixPrefix=!1,a})})}),gi="subtractScalar",Ts=["typed"],Os=j(gi,Ts,r=>{var{typed:e}=r;return e(gi,{"number, number":ti,"Complex, Complex":function(i,t){return i.sub(t)},"BigNumber, BigNumber":function(i,t){return i.minus(t)},"Fraction, Fraction":function(i,t){return i.sub(t)},"Unit, Unit":e.referToSelf(n=>(i,t)=>{if(i.value===null||i.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(t.value===null||t.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!i.equalBase(t))throw new Error("Units do not match");var a=i.clone();return a.value=e.find(n,[a.valueType(),t.valueType()])(a.value,t.value),a.fixPrefix=!1,a})})}),Is="matAlgo11xS0s",$s=["typed","equalScalar"],qs=j(Is,$s,r=>{var{typed:e,equalScalar:n}=r;return function(t,a,o,v){var c=t._values,l=t._index,s=t._ptr,u=t._size,f=t._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=u[0],D=u[1],h,m=n,d=0,w=o;typeof f=="string"&&(h=f,m=e.find(n,[h,h]),d=e.convert(0,h),a=e.convert(a,h),w=e.find(o,[h,h]));for(var g=[],E=[],F=[],y=0;y<D;y++){F[y]=E.length;for(var C=s[y],b=s[y+1],A=C;A<b;A++){var S=l[A],M=v?w(a,c[A]):w(c[A],a);m(M,d)||(E.push(S),g.push(M))}}return F[D]=E.length,t.createSparseMatrix({values:g,index:E,ptr:F,size:[p,D],datatype:h})}}),Ls="matAlgo12xSfs",Ps=["typed","DenseMatrix"],Pe=j(Ls,Ps,r=>{var{typed:e,DenseMatrix:n}=r;return function(t,a,o,v){var c=t._values,l=t._index,s=t._ptr,u=t._size,f=t._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=u[0],D=u[1],h,m=o;typeof f=="string"&&(h=f,a=e.convert(a,h),m=e.find(o,[h,h]));for(var d=[],w=[],g=[],E=0;E<D;E++){for(var F=E+1,y=s[E],C=s[E+1],b=y;b<C;b++){var A=l[b];w[A]=c[b],g[A]=F}for(var S=0;S<p;S++)E===0&&(d[S]=[]),g[S]===F?d[S][E]=v?m(a,w[S]):m(w[S],a):d[S][E]=v?m(a,0):m(0,a)}return new n({data:d,size:[p,D],datatype:h})}}),Rs="matAlgo14xDs",Us=["typed"],Di=j(Rs,Us,r=>{var{typed:e}=r;return function(t,a,o,v){var c=t._data,l=t._size,s=t._datatype,u,f=o;typeof s=="string"&&(u=s,a=e.convert(a,u),f=e.find(o,[u,u]));var p=l.length>0?n(f,0,l,l[0],c,a,v):[];return t.createDenseMatrix({data:p,size:Fr(l),datatype:u})};function n(i,t,a,o,v,c,l){var s=[];if(t===a.length-1)for(var u=0;u<o;u++)s[u]=l?i(c,v[u]):i(v[u],c);else for(var f=0;f<o;f++)s[f]=n(i,t+1,a,a[t+1],v[f],c,l);return s}}),Vs="matAlgo03xDSf",Zs=["typed"],Re=j(Vs,Zs,r=>{var{typed:e}=r;return function(i,t,a,o){var v=i._data,c=i._size,l=i._datatype,s=t._values,u=t._index,f=t._ptr,p=t._size,D=t._datatype;if(c.length!==p.length)throw new wr(c.length,p.length);if(c[0]!==p[0]||c[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+p+")");if(!s)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var h=c[0],m=c[1],d,w=0,g=a;typeof l=="string"&&l===D&&(d=l,w=e.convert(0,d),g=e.find(a,[d,d]));for(var E=[],F=0;F<h;F++)E[F]=[];for(var y=[],C=[],b=0;b<m;b++){for(var A=b+1,S=f[b],M=f[b+1],N=S;N<M;N++){var O=u[N];y[O]=o?g(s[N],v[O][b]):g(v[O][b],s[N]),C[O]=A}for(var T=0;T<h;T++)C[T]===A?E[T][b]=y[T]:E[T][b]=o?g(w,v[T][b]):g(v[T][b],w)}return i.createDenseMatrix({data:E,size:[h,m],datatype:d})}}),Gs="matAlgo05xSfSf",Ys=["typed","equalScalar"],Js=j(Gs,Ys,r=>{var{typed:e,equalScalar:n}=r;return function(t,a,o){var v=t._values,c=t._index,l=t._ptr,s=t._size,u=t._datatype,f=a._values,p=a._index,D=a._ptr,h=a._size,m=a._datatype;if(s.length!==h.length)throw new wr(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");var d=s[0],w=s[1],g,E=n,F=0,y=o;typeof u=="string"&&u===m&&(g=u,E=e.find(n,[g,g]),F=e.convert(0,g),y=e.find(o,[g,g]));var C=v&&f?[]:void 0,b=[],A=[],S=C?[]:void 0,M=C?[]:void 0,N=[],O=[],T,I,B,G;for(I=0;I<w;I++){A[I]=b.length;var q=I+1;for(B=l[I],G=l[I+1];B<G;B++)T=c[B],b.push(T),N[T]=q,S&&(S[T]=v[B]);for(B=D[I],G=D[I+1];B<G;B++)T=p[B],N[T]!==q&&b.push(T),O[T]=q,M&&(M[T]=f[B]);if(C)for(B=A[I];B<b.length;){T=b[B];var z=N[T],V=O[T];if(z===q||V===q){var W=z===q?S[T]:F,P=V===q?M[T]:F,L=y(W,P);E(L,F)?b.splice(B,1):(C.push(L),B++)}}}return A[w]=b.length,t.createSparseMatrix({values:C,index:b,ptr:A,size:[d,w],datatype:g})}}),Qs="matAlgo13xDD",Xs=["typed"],Ks=j(Qs,Xs,r=>{var{typed:e}=r;return function(t,a,o){var v=t._data,c=t._size,l=t._datatype,s=a._data,u=a._size,f=a._datatype,p=[];if(c.length!==u.length)throw new wr(c.length,u.length);for(var D=0;D<c.length;D++){if(c[D]!==u[D])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+u+")");p[D]=c[D]}var h,m=o;typeof l=="string"&&l===f&&(h=l,m=e.find(o,[h,h]));var d=p.length>0?n(m,0,p,p[0],v,s):[];return t.createDenseMatrix({data:d,size:p,datatype:h})};function n(i,t,a,o,v,c){var l=[];if(t===a.length-1)for(var s=0;s<o;s++)l[s]=i(v[s],c[s]);else for(var u=0;u<o;u++)l[u]=n(i,t+1,a,a[t+1],v[u],c[u]);return l}}),Hs="broadcast",Ws=["concat"],ks=j(Hs,Ws,r=>{var{concat:e}=r;return function(t,a){var o=Math.max(t._size.length,a._size.length);if(t._size.length===a._size.length&&t._size.every((D,h)=>D===a._size[h]))return[t,a];for(var v=n(t._size,o,0),c=n(a._size,o,0),l=[],s=0;s<o;s++)l[s]=Math.max(v[s],c[s]);lt(v,l),lt(c,l);var u=t.clone(),f=a.clone();u._size.length<o?u.reshape(n(u._size,o,1)):f._size.length<o&&f.reshape(n(f._size,o,1));for(var p=0;p<o;p++)u._size[p]<l[p]&&(u=i(u,l[p],p)),f._size[p]<l[p]&&(f=i(f,l[p],p));return[u,f]};function n(t,a,o){return[...Array(a-t.length).fill(o),...t]}function i(t,a,o){return e(...Array(a).fill(t),o)}}),js="matrixAlgorithmSuite",rf=["typed","matrix","concat"],xe=j(js,rf,r=>{var{typed:e,matrix:n,concat:i}=r,t=Ks({typed:e}),a=Di({typed:e}),o=ks({concat:i});return function(c){var l=c.elop,s=c.SD||c.DS,u;l?(u={"DenseMatrix, DenseMatrix":(h,m)=>t(...o(h,m),l),"Array, Array":(h,m)=>t(...o(n(h),n(m)),l).valueOf(),"Array, DenseMatrix":(h,m)=>t(...o(n(h),m),l),"DenseMatrix, Array":(h,m)=>t(...o(h,n(m)),l)},c.SS&&(u["SparseMatrix, SparseMatrix"]=(h,m)=>c.SS(...o(h,m),l,!1)),c.DS&&(u["DenseMatrix, SparseMatrix"]=(h,m)=>c.DS(...o(h,m),l,!1),u["Array, SparseMatrix"]=(h,m)=>c.DS(...o(n(h),m),l,!1)),s&&(u["SparseMatrix, DenseMatrix"]=(h,m)=>s(...o(m,h),l,!0),u["SparseMatrix, Array"]=(h,m)=>s(...o(n(m),h),l,!0))):(u={"DenseMatrix, DenseMatrix":e.referToSelf(h=>(m,d)=>t(...o(m,d),h)),"Array, Array":e.referToSelf(h=>(m,d)=>t(...o(n(m),n(d)),h).valueOf()),"Array, DenseMatrix":e.referToSelf(h=>(m,d)=>t(...o(n(m),d),h)),"DenseMatrix, Array":e.referToSelf(h=>(m,d)=>t(...o(m,n(d)),h))},c.SS&&(u["SparseMatrix, SparseMatrix"]=e.referToSelf(h=>(m,d)=>c.SS(...o(m,d),h,!1))),c.DS&&(u["DenseMatrix, SparseMatrix"]=e.referToSelf(h=>(m,d)=>c.DS(...o(m,d),h,!1)),u["Array, SparseMatrix"]=e.referToSelf(h=>(m,d)=>c.DS(...o(n(m),d),h,!1))),s&&(u["SparseMatrix, DenseMatrix"]=e.referToSelf(h=>(m,d)=>s(...o(d,m),h,!0)),u["SparseMatrix, Array"]=e.referToSelf(h=>(m,d)=>s(...o(n(d),m),h,!0))));var f=c.scalar||"any",p=c.Ds||c.Ss;p&&(l?(u["DenseMatrix,"+f]=(h,m)=>a(h,m,l,!1),u[f+", DenseMatrix"]=(h,m)=>a(m,h,l,!0),u["Array,"+f]=(h,m)=>a(n(h),m,l,!1).valueOf(),u[f+", Array"]=(h,m)=>a(n(m),h,l,!0).valueOf()):(u["DenseMatrix,"+f]=e.referToSelf(h=>(m,d)=>a(m,d,h,!1)),u[f+", DenseMatrix"]=e.referToSelf(h=>(m,d)=>a(d,m,h,!0)),u["Array,"+f]=e.referToSelf(h=>(m,d)=>a(n(m),d,h,!1).valueOf()),u[f+", Array"]=e.referToSelf(h=>(m,d)=>a(n(d),m,h,!0).valueOf())));var D=c.sS!==void 0?c.sS:c.Ss;return l?(c.Ss&&(u["SparseMatrix,"+f]=(h,m)=>c.Ss(h,m,l,!1)),D&&(u[f+", SparseMatrix"]=(h,m)=>D(m,h,l,!0))):(c.Ss&&(u["SparseMatrix,"+f]=e.referToSelf(h=>(m,d)=>c.Ss(m,d,h,!1))),D&&(u[f+", SparseMatrix"]=e.referToSelf(h=>(m,d)=>D(d,m,h,!0)))),l&&l.signatures&&ou(u,l.signatures),u}}),ef="matAlgo01xDSid",tf=["typed"],yi=j(ef,tf,r=>{var{typed:e}=r;return function(i,t,a,o){var v=i._data,c=i._size,l=i._datatype,s=t._values,u=t._index,f=t._ptr,p=t._size,D=t._datatype;if(c.length!==p.length)throw new wr(c.length,p.length);if(c[0]!==p[0]||c[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+p+")");if(!s)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var h=c[0],m=c[1],d=typeof l=="string"&&l===D?l:void 0,w=d?e.find(a,[d,d]):a,g,E,F=[];for(g=0;g<h;g++)F[g]=[];var y=[],C=[];for(E=0;E<m;E++){for(var b=E+1,A=f[E],S=f[E+1],M=A;M<S;M++)g=u[M],y[g]=o?w(s[M],v[g][E]):w(v[g][E],s[M]),C[g]=b;for(g=0;g<h;g++)C[g]===b?F[g][E]=y[g]:F[g][E]=v[g][E]}return i.createDenseMatrix({data:F,size:[h,m],datatype:d})}}),nf="matAlgo04xSidSid",af=["typed","equalScalar"],uf=j(nf,af,r=>{var{typed:e,equalScalar:n}=r;return function(t,a,o){var v=t._values,c=t._index,l=t._ptr,s=t._size,u=t._datatype,f=a._values,p=a._index,D=a._ptr,h=a._size,m=a._datatype;if(s.length!==h.length)throw new wr(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");var d=s[0],w=s[1],g,E=n,F=0,y=o;typeof u=="string"&&u===m&&(g=u,E=e.find(n,[g,g]),F=e.convert(0,g),y=e.find(o,[g,g]));var C=v&&f?[]:void 0,b=[],A=[],S=v&&f?[]:void 0,M=v&&f?[]:void 0,N=[],O=[],T,I,B,G,q;for(I=0;I<w;I++){A[I]=b.length;var z=I+1;for(G=l[I],q=l[I+1],B=G;B<q;B++)T=c[B],b.push(T),N[T]=z,S&&(S[T]=v[B]);for(G=D[I],q=D[I+1],B=G;B<q;B++)if(T=p[B],N[T]===z){if(S){var V=y(S[T],f[B]);E(V,F)?N[T]=null:S[T]=V}}else b.push(T),O[T]=z,M&&(M[T]=f[B]);if(S&&M)for(B=A[I];B<b.length;)T=b[B],N[T]===z?(C[B]=S[T],B++):O[T]===z?(C[B]=M[T],B++):b.splice(B,1)}return A[w]=b.length,t.createSparseMatrix({values:C,index:b,ptr:A,size:[d,w],datatype:g})}}),of="matAlgo10xSids",sf=["typed","DenseMatrix"],wi=j(of,sf,r=>{var{typed:e,DenseMatrix:n}=r;return function(t,a,o,v){var c=t._values,l=t._index,s=t._ptr,u=t._size,f=t._datatype;if(!c)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p=u[0],D=u[1],h,m=o;typeof f=="string"&&(h=f,a=e.convert(a,h),m=e.find(o,[h,h]));for(var d=[],w=[],g=[],E=0;E<D;E++){for(var F=E+1,y=s[E],C=s[E+1],b=y;b<C;b++){var A=l[b];w[A]=c[b],g[A]=F}for(var S=0;S<p;S++)E===0&&(d[S]=[]),g[S]===F?d[S][E]=v?m(a,w[S]):m(w[S],a):d[S][E]=a}return new n({data:d,size:[p,D],datatype:h})}}),ff="multiplyScalar",cf=["typed"],lf=j(ff,cf,r=>{var{typed:e}=r;return e("multiplyScalar",{"number, number":ni,"Complex, Complex":function(i,t){return i.mul(t)},"BigNumber, BigNumber":function(i,t){return i.times(t)},"Fraction, Fraction":function(i,t){return i.mul(t)},"number | Fraction | BigNumber | Complex, Unit":(n,i)=>i.multiply(n),"Unit, number | Fraction | BigNumber | Complex | Unit":(n,i)=>n.multiply(i)})}),Ai="multiply",vf=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],hf=j(Ai,vf,r=>{var{typed:e,matrix:n,addScalar:i,multiplyScalar:t,equalScalar:a,dot:o}=r,v=qs({typed:e,equalScalar:a}),c=Di({typed:e});function l(F,y){switch(F.length){case 1:switch(y.length){case 1:if(F[0]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(F[0]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+F[0]+") must match Matrix rows ("+y[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+y.length+" dimensions)")}break;case 2:switch(y.length){case 1:if(F[1]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+F[1]+") must match Vector length ("+y[0]+")");break;case 2:if(F[1]!==y[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+F[1]+") must match Matrix B rows ("+y[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+y.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+F.length+" dimensions)")}}function s(F,y,C){if(C===0)throw new Error("Cannot multiply two empty vectors");return o(F,y)}function u(F,y){if(y.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return f(F,y)}function f(F,y){var C=F._data,b=F._size,A=F._datatype,S=y._data,M=y._size,N=y._datatype,O=b[0],T=M[1],I,B=i,G=t;A&&N&&A===N&&typeof A=="string"&&(I=A,B=e.find(i,[I,I]),G=e.find(t,[I,I]));for(var q=[],z=0;z<T;z++){for(var V=G(C[0],S[0][z]),W=1;W<O;W++)V=B(V,G(C[W],S[W][z]));q[z]=V}return F.createDenseMatrix({data:q,size:[T],datatype:I})}var p=e("_multiplyMatrixVector",{"DenseMatrix, any":h,"SparseMatrix, any":w}),D=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":m,"DenseMatrix, SparseMatrix":d,"SparseMatrix, DenseMatrix":g,"SparseMatrix, SparseMatrix":E});function h(F,y){var C=F._data,b=F._size,A=F._datatype,S=y._data,M=y._datatype,N=b[0],O=b[1],T,I=i,B=t;A&&M&&A===M&&typeof A=="string"&&(T=A,I=e.find(i,[T,T]),B=e.find(t,[T,T]));for(var G=[],q=0;q<N;q++){for(var z=C[q],V=B(z[0],S[0]),W=1;W<O;W++)V=I(V,B(z[W],S[W]));G[q]=V}return F.createDenseMatrix({data:G,size:[N],datatype:T})}function m(F,y){var C=F._data,b=F._size,A=F._datatype,S=y._data,M=y._size,N=y._datatype,O=b[0],T=b[1],I=M[1],B,G=i,q=t;A&&N&&A===N&&typeof A=="string"&&(B=A,G=e.find(i,[B,B]),q=e.find(t,[B,B]));for(var z=[],V=0;V<O;V++){var W=C[V];z[V]=[];for(var P=0;P<I;P++){for(var L=q(W[0],S[0][P]),Z=1;Z<T;Z++)L=G(L,q(W[Z],S[Z][P]));z[V][P]=L}}return F.createDenseMatrix({data:z,size:[O,I],datatype:B})}function d(F,y){var C=F._data,b=F._size,A=F._datatype,S=y._values,M=y._index,N=y._ptr,O=y._size,T=y._datatype;if(!S)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var I=b[0],B=O[1],G,q=i,z=t,V=a,W=0;A&&T&&A===T&&typeof A=="string"&&(G=A,q=e.find(i,[G,G]),z=e.find(t,[G,G]),V=e.find(a,[G,G]),W=e.convert(0,G));for(var P=[],L=[],Z=[],nr=y.createSparseMatrix({values:P,index:L,ptr:Z,size:[I,B],datatype:G}),k=0;k<B;k++){Z[k]=L.length;var U=N[k],Q=N[k+1];if(Q>U)for(var X=0,J=0;J<I;J++){for(var ur=J+1,rr=void 0,or=U;or<Q;or++){var fr=M[or];X!==ur?(rr=z(C[J][fr],S[or]),X=ur):rr=q(rr,z(C[J][fr],S[or]))}X===ur&&!V(rr,W)&&(L.push(J),P.push(rr))}}return Z[B]=L.length,nr}function w(F,y){var C=F._values,b=F._index,A=F._ptr,S=F._datatype;if(!C)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var M=y._data,N=y._datatype,O=F._size[0],T=y._size[0],I=[],B=[],G=[],q,z=i,V=t,W=a,P=0;S&&N&&S===N&&typeof S=="string"&&(q=S,z=e.find(i,[q,q]),V=e.find(t,[q,q]),W=e.find(a,[q,q]),P=e.convert(0,q));var L=[],Z=[];G[0]=0;for(var nr=0;nr<T;nr++){var k=M[nr];if(!W(k,P))for(var U=A[nr],Q=A[nr+1],X=U;X<Q;X++){var J=b[X];Z[J]?L[J]=z(L[J],V(k,C[X])):(Z[J]=!0,B.push(J),L[J]=V(k,C[X]))}}for(var ur=B.length,rr=0;rr<ur;rr++){var or=B[rr];I[rr]=L[or]}return G[1]=B.length,F.createSparseMatrix({values:I,index:B,ptr:G,size:[O,1],datatype:q})}function g(F,y){var C=F._values,b=F._index,A=F._ptr,S=F._datatype;if(!C)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var M=y._data,N=y._datatype,O=F._size[0],T=y._size[0],I=y._size[1],B,G=i,q=t,z=a,V=0;S&&N&&S===N&&typeof S=="string"&&(B=S,G=e.find(i,[B,B]),q=e.find(t,[B,B]),z=e.find(a,[B,B]),V=e.convert(0,B));for(var W=[],P=[],L=[],Z=F.createSparseMatrix({values:W,index:P,ptr:L,size:[O,I],datatype:B}),nr=[],k=[],U=0;U<I;U++){L[U]=P.length;for(var Q=U+1,X=0;X<T;X++){var J=M[X][U];if(!z(J,V))for(var ur=A[X],rr=A[X+1],or=ur;or<rr;or++){var fr=b[or];k[fr]!==Q?(k[fr]=Q,P.push(fr),nr[fr]=q(J,C[or])):nr[fr]=G(nr[fr],q(J,C[or]))}}for(var pr=L[U],gr=P.length,yr=pr;yr<gr;yr++){var cr=P[yr];W[yr]=nr[cr]}}return L[I]=P.length,Z}function E(F,y){var C=F._values,b=F._index,A=F._ptr,S=F._datatype,M=y._values,N=y._index,O=y._ptr,T=y._datatype,I=F._size[0],B=y._size[1],G=C&&M,q,z=i,V=t;S&&T&&S===T&&typeof S=="string"&&(q=S,z=e.find(i,[q,q]),V=e.find(t,[q,q]));for(var W=G?[]:void 0,P=[],L=[],Z=F.createSparseMatrix({values:W,index:P,ptr:L,size:[I,B],datatype:q}),nr=G?[]:void 0,k=[],U,Q,X,J,ur,rr,or,fr,pr=0;pr<B;pr++){L[pr]=P.length;var gr=pr+1;for(ur=O[pr],rr=O[pr+1],J=ur;J<rr;J++)if(fr=N[J],G)for(Q=A[fr],X=A[fr+1],U=Q;U<X;U++)or=b[U],k[or]!==gr?(k[or]=gr,P.push(or),nr[or]=V(M[J],C[U])):nr[or]=z(nr[or],V(M[J],C[U]));else for(Q=A[fr],X=A[fr+1],U=Q;U<X;U++)or=b[U],k[or]!==gr&&(k[or]=gr,P.push(or));if(G)for(var yr=L[pr],cr=P.length,Cr=yr;Cr<cr;Cr++){var Er=P[Cr];W[Cr]=nr[Er]}}return L[B]=P.length,Z}return e(Ai,t,{"Array, Array":e.referTo("Matrix, Matrix",F=>(y,C)=>{l(Lr(y),Lr(C));var b=F(n(y),n(C));return xr(b)?b.valueOf():b}),"Matrix, Matrix":function(y,C){var b=y.size(),A=C.size();return l(b,A),b.length===1?A.length===1?s(y,C,b[0]):u(y,C):A.length===1?p(y,C):D(y,C)},"Matrix, Array":e.referTo("Matrix,Matrix",F=>(y,C)=>F(y,n(C))),"Array, Matrix":e.referToSelf(F=>(y,C)=>F(n(y,C.storage()),C)),"SparseMatrix, any":function(y,C){return v(y,C,t,!1)},"DenseMatrix, any":function(y,C){return c(y,C,t,!1)},"any, SparseMatrix":function(y,C){return v(C,y,t,!0)},"any, DenseMatrix":function(y,C){return c(C,y,t,!0)},"Array, any":function(y,C){return c(n(y),C,t,!1).valueOf()},"any, Array":function(y,C){return c(n(C),y,t,!0).valueOf()},"any, any":t,"any, any, ...any":e.referToSelf(F=>(y,C,b)=>{for(var A=F(y,C),S=0;S<b.length;S++)A=F(A,b[S]);return A})})}),Ei="sign",pf=["typed","BigNumber","Fraction","complex"],df=j(Ei,pf,r=>{var{typed:e,BigNumber:n,complex:i,Fraction:t}=r;return e(Ei,{number:Ht,Complex:function(o){return o.im===0?i(Ht(o.re)):o.sign()},BigNumber:function(o){return new n(o.cmp(0))},Fraction:function(o){return new t(o.s,1)},"Array | Matrix":e.referToSelf(a=>o=>jr(o,a)),Unit:e.referToSelf(a=>o=>{if(!o._isDerived()&&o.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return e.find(a,o.valueType())(o.value)})})}),mf="sqrt",gf=["config","typed","Complex"],Df=j(mf,gf,r=>{var{config:e,typed:n,Complex:i}=r;return n("sqrt",{number:t,Complex:function(o){return o.sqrt()},BigNumber:function(o){return!o.isNegative()||e.predictable?o.sqrt():t(o.toNumber())},Unit:function(o){return o.pow(.5)}});function t(a){return isNaN(a)?NaN:a>=0||e.predictable?Math.sqrt(a):new i(a,0).sqrt()}}),Fi="subtract",yf=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],wf=j(Fi,yf,r=>{var{typed:e,matrix:n,equalScalar:i,subtractScalar:t,unaryMinus:a,DenseMatrix:o,concat:v}=r,c=yi({typed:e}),l=Re({typed:e}),s=Js({typed:e,equalScalar:i}),u=wi({typed:e,DenseMatrix:o}),f=Pe({typed:e,DenseMatrix:o}),p=xe({typed:e,matrix:n,concat:v});return e(Fi,{"any, any":t},p({elop:t,SS:s,DS:c,SD:l,Ss:f,sS:u}))}),Af="matAlgo07xSSf",Ef=["typed","DenseMatrix"],He=j(Af,Ef,r=>{var{typed:e,DenseMatrix:n}=r;return function(a,o,v){var c=a._size,l=a._datatype,s=o._size,u=o._datatype;if(c.length!==s.length)throw new wr(c.length,s.length);if(c[0]!==s[0]||c[1]!==s[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+s+")");var f=c[0],p=c[1],D,h=0,m=v;typeof l=="string"&&l===u&&(D=l,h=e.convert(0,D),m=e.find(v,[D,D]));var d,w,g=[];for(d=0;d<f;d++)g[d]=[];var E=[],F=[],y=[],C=[];for(w=0;w<p;w++){var b=w+1;for(i(a,w,y,E,b),i(o,w,C,F,b),d=0;d<f;d++){var A=y[d]===b?E[d]:h,S=C[d]===b?F[d]:h;g[d][w]=m(A,S)}}return new n({data:g,size:[f,p],datatype:D})};function i(t,a,o,v,c){for(var l=t._values,s=t._index,u=t._ptr,f=u[a],p=u[a+1];f<p;f++){var D=s[f];o[D]=c,v[D]=l[f]}}}),Ci="conj",Ff=["typed"],Cf=j(Ci,Ff,r=>{var{typed:e}=r;return e(Ci,{"number | BigNumber | Fraction":n=>n,Complex:n=>n.conjugate(),"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),bi="im",bf=["typed"],Mf=j(bi,bf,r=>{var{typed:e}=r;return e(bi,{number:()=>0,"BigNumber | Fraction":n=>n.mul(0),Complex:n=>n.im,"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),Mi="re",Sf=["typed"],Nf=j(Mi,Sf,r=>{var{typed:e}=r;return e(Mi,{"number | BigNumber | Fraction":n=>n,Complex:n=>n.re,"Array | Matrix":e.referToSelf(n=>i=>jr(i,n))})}),Si="concat",xf=["typed","matrix","isInteger"],Bf=j(Si,xf,r=>{var{typed:e,matrix:n,isInteger:i}=r;return e(Si,{"...Array | Matrix | number | BigNumber":function(a){var o,v=a.length,c=-1,l,s=!1,u=[];for(o=0;o<v;o++){var f=a[o];if(xr(f)&&(s=!0),$r(f)||Rr(f)){if(o!==v-1)throw new Error("Dimension must be specified as last argument");if(l=c,c=f.valueOf(),!i(c))throw new TypeError("Integer number expected for dimension");if(c<0||o>0&&c>l)throw new Ne(c,l+1)}else{var p=Fr(f).valueOf(),D=Lr(p);if(u[o]=p,l=c,c=D.length-1,o>0&&c!==l)throw new wr(l+1,c+1)}}if(u.length===0)throw new SyntaxError("At least one matrix expected");for(var h=u.shift();u.length;)h=Nn(h,u.shift(),c);return s?n(h):h},"...string":function(a){return a.join("")}})}),Ni="column",_f=["typed","Index","matrix","range"],zf=j(Ni,_f,r=>{var{typed:e,Index:n,matrix:i,range:t}=r;return e(Ni,{"Matrix, number":a,"Array, number":function(v,c){return a(i(Fr(v)),c).valueOf()}});function a(o,v){if(o.size().length!==2)throw new Error("Only two dimensional matrix is supported");Br(v,o.size()[1]);var c=t(0,o.size()[0]),l=new n(c,v),s=o.subset(l);return xr(s)?s:i([[s]])}}),xi="diag",Tf=["typed","matrix","DenseMatrix","SparseMatrix"],Of=j(xi,Tf,r=>{var{typed:e,matrix:n,DenseMatrix:i,SparseMatrix:t}=r;return e(xi,{Array:function(l){return a(l,0,Lr(l),null)},"Array, number":function(l,s){return a(l,s,Lr(l),null)},"Array, BigNumber":function(l,s){return a(l,s.toNumber(),Lr(l),null)},"Array, string":function(l,s){return a(l,0,Lr(l),s)},"Array, number, string":function(l,s,u){return a(l,s,Lr(l),u)},"Array, BigNumber, string":function(l,s,u){return a(l,s.toNumber(),Lr(l),u)},Matrix:function(l){return a(l,0,l.size(),l.storage())},"Matrix, number":function(l,s){return a(l,s,l.size(),l.storage())},"Matrix, BigNumber":function(l,s){return a(l,s.toNumber(),l.size(),l.storage())},"Matrix, string":function(l,s){return a(l,0,l.size(),s)},"Matrix, number, string":function(l,s,u){return a(l,s,l.size(),u)},"Matrix, BigNumber, string":function(l,s,u){return a(l,s.toNumber(),l.size(),u)}});function a(c,l,s,u){if(!zr(l))throw new TypeError("Second parameter in function diag must be an integer");var f=l>0?l:0,p=l<0?-l:0;switch(s.length){case 1:return o(c,l,u,s[0],p,f);case 2:return v(c,l,u,s,p,f)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function o(c,l,s,u,f,p){var D=[u+f,u+p];if(s&&s!=="sparse"&&s!=="dense")throw new TypeError("Unknown matrix type ".concat(s,'"'));var h=s==="sparse"?t.diagonal(D,c,l):i.diagonal(D,c,l);return s!==null?h:h.valueOf()}function v(c,l,s,u,f,p){if(xr(c)){var D=c.diagonal(l);return s!==null?s!==D.storage()?n(D,s):D:D.valueOf()}for(var h=Math.min(u[0]-f,u[1]-p),m=[],d=0;d<h;d++)m[d]=c[d+f][d+p];return s!==null?n(m):m}}),Bi="flatten",If=["typed","matrix"],$f=j(Bi,If,r=>{var{typed:e,matrix:n}=r;return e(Bi,{Array:function(t){return Rt(t)},Matrix:function(t){var a=Rt(t.toArray());return n(a)}})}),_i="getMatrixDataType",qf=["typed"],Lf=j(_i,qf,r=>{var{typed:e}=r;return e(_i,{Array:function(i){return Je(i,ce)},Matrix:function(i){return i.getDataType()}})}),zi="identity",Pf=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],Rf=j(zi,Pf,r=>{var{typed:e,config:n,matrix:i,BigNumber:t,DenseMatrix:a,SparseMatrix:o}=r;return e(zi,{"":function(){return n.matrix==="Matrix"?i([]):[]},string:function(s){return i(s)},"number | BigNumber":function(s){return c(s,s,n.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(s,u){return c(s,s,u)},"number | BigNumber, number | BigNumber":function(s,u){return c(s,u,n.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(s,u,f){return c(s,u,f)},Array:function(s){return v(s)},"Array, string":function(s,u){return v(s,u)},Matrix:function(s){return v(s.valueOf(),s.storage())},"Matrix, string":function(s,u){return v(s.valueOf(),u)}});function v(l,s){switch(l.length){case 0:return s?i(s):[];case 1:return c(l[0],l[0],s);case 2:return c(l[0],l[1],s);default:throw new Error("Vector containing two values expected")}}function c(l,s,u){var f=Rr(l)||Rr(s)?t:null;if(Rr(l)&&(l=l.toNumber()),Rr(s)&&(s=s.toNumber()),!zr(l)||l<1)throw new Error("Parameters in function identity must be positive integers");if(!zr(s)||s<1)throw new Error("Parameters in function identity must be positive integers");var p=f?new t(1):1,D=f?new f(0):0,h=[l,s];if(u){if(u==="sparse")return o.diagonal(h,p,0,D);if(u==="dense")return a.diagonal(h,p,0,D);throw new TypeError('Unknown matrix type "'.concat(u,'"'))}for(var m=ct([],h,D),d=l<s?l:s,w=0;w<d;w++)m[w][w]=p;return m}});function Ti(){throw new Error('No "bignumber" implementation available')}function Uf(){throw new Error('No "fraction" implementation available')}function Oi(){throw new Error('No "matrix" implementation available')}var Ii="range",Vf=["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],Zf=j(Ii,Vf,r=>{var{typed:e,config:n,matrix:i,bignumber:t,smaller:a,smallerEq:o,larger:v,largerEq:c,add:l,isPositive:s}=r;return e(Ii,{string:f,"string, boolean":f,"number, number":function(m,d){return u(p(m,d,1,!1))},"number, number, number":function(m,d,w){return u(p(m,d,w,!1))},"number, number, boolean":function(m,d,w){return u(p(m,d,1,w))},"number, number, number, boolean":function(m,d,w,g){return u(p(m,d,w,g))},"BigNumber, BigNumber":function(m,d){var w=m.constructor;return u(p(m,d,new w(1),!1))},"BigNumber, BigNumber, BigNumber":function(m,d,w){return u(p(m,d,w,!1))},"BigNumber, BigNumber, boolean":function(m,d,w){var g=m.constructor;return u(p(m,d,new g(1),w))},"BigNumber, BigNumber, BigNumber, boolean":function(m,d,w,g){return u(p(m,d,w,g))},"Unit, Unit, Unit":function(m,d,w){return u(p(m,d,w,!1))},"Unit, Unit, Unit, boolean":function(m,d,w,g){return u(p(m,d,w,g))}});function u(h){return n.matrix==="Matrix"?i?i(h):Oi():h}function f(h,m){var d=D(h);if(!d)throw new SyntaxError('String "'+h+'" is no valid range');return n.number==="BigNumber"?(t===void 0&&Ti(),u(p(t(d.start),t(d.end),t(d.step)))):u(p(d.start,d.end,d.step,m))}function p(h,m,d,w){for(var g=[],E=s(d)?w?o:a:w?c:v,F=h;E(F,m);)g.push(F),F=l(F,d);return g}function D(h){var m=h.split(":"),d=m.map(function(g){return Number(g)}),w=d.some(function(g){return isNaN(g)});if(w)return null;switch(d.length){case 2:return{start:d[0],end:d[1],step:1};case 3:return{start:d[0],end:d[2],step:d[1]};default:return null}}}),$i="reshape",Gf=["typed","isInteger","matrix"],Yf=j($i,Gf,r=>{var{typed:e,isInteger:n}=r;return e($i,{"Matrix, Array":function(t,a){return t.reshape(a,!0)},"Array, Array":function(t,a){return a.forEach(function(o){if(!n(o))throw new TypeError("Invalid size for dimension: "+o)}),Lt(t,a)}})}),qi="size",Jf=["typed","config","?matrix"],Qf=j(qi,Jf,r=>{var{typed:e,config:n,matrix:i}=r;return e(qi,{Matrix:function(a){return a.create(a.size())},Array:Lr,string:function(a){return n.matrix==="Array"?[a.length]:i([a.length])},"number | Complex | BigNumber | Unit | boolean | null":function(a){return n.matrix==="Array"?[]:i?i([]):Oi()}})}),Li="squeeze",Xf=["typed","matrix"],Kf=j(Li,Xf,r=>{var{typed:e,matrix:n}=r;return e(Li,{Array:function(t){return Fn(Fr(t))},Matrix:function(t){var a=Fn(t.toArray());return Array.isArray(a)?n(a):a},any:function(t){return Fr(t)}})}),Pi="subset",Hf=["typed","matrix","zeros","add"],Wf=j(Pi,Hf,r=>{var{typed:e,matrix:n,zeros:i,add:t}=r;return e(Pi,{"Matrix, Index":function(v,c){return Ie(c)?n():(ft(v,c),v.subset(c))},"Array, Index":e.referTo("Matrix, Index",function(o){return function(v,c){var l=o(n(v),c);return c.isScalar()?l:l.valueOf()}}),"Object, Index":jf,"string, Index":kf,"Matrix, Index, any, any":function(v,c,l,s){return Ie(c)?v:(ft(v,c),v.clone().subset(c,a(l,c),s))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(o){return function(v,c,l,s){var u=o(n(v),c,l,s);return u.isMatrix?u.valueOf():u}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(o){return function(v,c,l){return o(n(v),c,l,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(o){return function(v,c,l){return o(v,c,l,void 0)}}),"string, Index, string":Ri,"string, Index, string, string":Ri,"Object, Index, any":rc});function a(o,v){if(typeof o=="string")throw new Error("can't boradcast a string");if(v._isScalar)return o;var c=v.size();if(c.every(l=>l>0))try{return t(o,i(c))}catch{return o}else return o}});function kf(r,e){if(!ut(e))throw new TypeError("Index expected");if(Ie(e))return"";if(ft(Array.from(r),e),e.size().length!==1)throw new wr(e.size().length,1);var n=r.length;Br(e.min()[0],n),Br(e.max()[0],n);var i=e.dimension(0),t="";return i.forEach(function(a){t+=r.charAt(a)}),t}function Ri(r,e,n,i){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(Ie(e))return r;if(ft(Array.from(r),e),e.size().length!==1)throw new wr(e.size().length,1);if(i!==void 0){if(typeof i!="string"||i.length!==1)throw new TypeError("Single character expected as defaultValue")}else i=" ";var t=e.dimension(0),a=t.size()[0];if(a!==n.length)throw new wr(t.size()[0],n.length);var o=r.length;Br(e.min()[0]),Br(e.max()[0]);for(var v=[],c=0;c<o;c++)v[c]=r.charAt(c);if(t.forEach(function(u,f){v[u]=n.charAt(f[0])}),v.length>o)for(var l=o-1,s=v.length;l<s;l++)v[l]||(v[l]=i);return v.join("")}function jf(r,e){if(!Ie(e)){if(e.size().length!==1)throw new wr(e.size(),1);var n=e.dimension(0);if(typeof n!="string")throw new TypeError("String expected as index to retrieve an object property");return Bn(r,n)}}function rc(r,e,n){if(Ie(e))return r;if(e.size().length!==1)throw new wr(e.size(),1);var i=e.dimension(0);if(typeof i!="string")throw new TypeError("String expected as index to retrieve an object property");var t=Fr(r);return _n(t,i,n),t}var Ui="transpose",ec=["typed","matrix"],tc=j(Ui,ec,r=>{var{typed:e,matrix:n}=r;return e(Ui,{Array:o=>i(n(o)).valueOf(),Matrix:i,any:Fr});function i(o){var v=o.size(),c;switch(v.length){case 1:c=o.clone();break;case 2:{var l=v[0],s=v[1];if(s===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+qr(v)+")");switch(o.storage()){case"dense":c=t(o,l,s);break;case"sparse":c=a(o,l,s);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+qr(v)+")")}return c}function t(o,v,c){for(var l=o._data,s=[],u,f=0;f<c;f++){u=s[f]=[];for(var p=0;p<v;p++)u[p]=Fr(l[p][f])}return o.createDenseMatrix({data:s,size:[c,v],datatype:o._datatype})}function a(o,v,c){for(var l=o._values,s=o._index,u=o._ptr,f=l?[]:void 0,p=[],D=[],h=[],m=0;m<v;m++)h[m]=0;var d,w,g;for(d=0,w=s.length;d<w;d++)h[s[d]]++;for(var E=0,F=0;F<v;F++)D.push(E),E+=h[F],h[F]=D[F];for(D.push(E),g=0;g<c;g++)for(var y=u[g],C=u[g+1],b=y;b<C;b++){var A=h[s[b]]++;p[A]=g,l&&(f[A]=Fr(l[b]))}return o.createSparseMatrix({values:f,index:p,ptr:D,size:[c,v],datatype:o._datatype})}}),Vi="ctranspose",nc=["typed","transpose","conj"],ic=j(Vi,nc,r=>{var{typed:e,transpose:n,conj:i}=r;return e(Vi,{any:function(a){return i(n(a))}})}),Zi="zeros",ac=["typed","config","matrix","BigNumber"],uc=j(Zi,ac,r=>{var{typed:e,config:n,matrix:i,BigNumber:t}=r;return e(Zi,{"":function(){return n.matrix==="Array"?a([]):a([],"default")},"...number | BigNumber | string":function(l){var s=l[l.length-1];if(typeof s=="string"){var u=l.pop();return a(l,u)}else return n.matrix==="Array"?a(l):a(l,"default")},Array:a,Matrix:function(l){var s=l.storage();return a(l.valueOf(),s)},"Array | Matrix, string":function(l,s){return a(l.valueOf(),s)}});function a(c,l){var s=o(c),u=s?new t(0):0;if(v(c),l){var f=i(l);return c.length>0?f.resize(c,u):f}else{var p=[];return c.length>0?ct(p,c,u):p}}function o(c){var l=!1;return c.forEach(function(s,u,f){Rr(s)&&(l=!0,f[u]=s.toNumber())}),l}function v(c){c.forEach(function(l){if(typeof l!="number"||!zr(l)||l<0)throw new Error("Parameters in function zeros must be positive integers")})}}),oc="numeric",sc=["number","?bignumber","?fraction"],fc=j(oc,sc,r=>{var{number:e,bignumber:n,fraction:i}=r,t={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:o=>e(o),BigNumber:n?o=>n(o):Ti,Fraction:i?o=>i(o):Uf};return function(v){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",l=arguments.length>2?arguments[2]:void 0;if(l!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var s=ce(v);if(!(s in t))throw new TypeError("Cannot convert "+v+' of type "'+s+'"; valid input types are '+Object.keys(t).join(", "));if(!(c in a))throw new TypeError("Cannot convert "+v+' to type "'+c+'"; valid output types are '+Object.keys(a).join(", "));return c===s?v:a[c](v)}}),Gi="divideScalar",cc=["typed","numeric"],lc=j(Gi,cc,r=>{var{typed:e,numeric:n}=r;return e(Gi,{"number, number":function(t,a){return t/a},"Complex, Complex":function(t,a){return t.div(a)},"BigNumber, BigNumber":function(t,a){return t.div(a)},"Fraction, Fraction":function(t,a){return t.div(a)},"Unit, number | Complex | Fraction | BigNumber | Unit":(i,t)=>i.divide(t),"number | Fraction | Complex | BigNumber, Unit":(i,t)=>t.divideInto(i)})}),Yi="pow",vc=["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],hc=j(Yi,vc,r=>{var{typed:e,config:n,identity:i,multiply:t,matrix:a,inv:o,number:v,fraction:c,Complex:l}=r;return e(Yi,{"number, number":s,"Complex, Complex":function(D,h){return D.pow(h)},"BigNumber, BigNumber":function(D,h){return h.isInteger()||D>=0||n.predictable?D.pow(h):new l(D.toNumber(),0).pow(h.toNumber(),0)},"Fraction, Fraction":function(D,h){var m=D.pow(h);if(m!=null)return m;if(n.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return s(D.valueOf(),h.valueOf())},"Array, number":u,"Array, BigNumber":function(D,h){return u(D,h.toNumber())},"Matrix, number":f,"Matrix, BigNumber":function(D,h){return f(D,h.toNumber())},"Unit, number | BigNumber":function(D,h){return D.pow(h)}});function s(p,D){if(n.predictable&&!zr(D)&&p<0)try{var h=c(D),m=v(h);if((D===m||Math.abs((D-m)/D)<1e-14)&&h.d%2===1)return(h.n%2===0?1:-1)*Math.pow(-p,D)}catch{}return n.predictable&&(p<-1&&D===1/0||p>-1&&p<0&&D===-1/0)?NaN:zr(D)||p>=0||n.predictable?ai(p,D):p*p<1&&D===1/0||p*p>1&&D===-1/0?0:new l(p,0).pow(D,0)}function u(p,D){if(!zr(D))throw new TypeError("For A^b, b must be an integer (value is "+D+")");var h=Lr(p);if(h.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+h.length+" dimensions)");if(h[0]!==h[1])throw new Error("For A^b, A must be square (size is "+h[0]+"x"+h[1]+")");if(D<0)try{return u(o(p),-D)}catch(w){throw w.message==="Cannot calculate inverse, determinant is zero"?new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+D+")"):w}for(var m=i(h[0]).valueOf(),d=p;D>=1;)(D&1)===1&&(m=t(d,m)),D>>=1,d=t(d,d);return m}function f(p,D){return a(u(p.valueOf(),D))}});function Et(r){var{DenseMatrix:e}=r;return function(i,t,a){var o=i.size();if(o.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+qr(o)+")");var v=o[0],c=o[1];if(v!==c)throw new RangeError("Matrix must be square (size: "+qr(o)+")");var l=[];if(xr(t)){var s=t.size(),u=t._data;if(s.length===1){if(s[0]!==v)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var f=0;f<v;f++)l[f]=[u[f]];return new e({data:l,size:[v,1],datatype:t._datatype})}if(s.length===2){if(s[0]!==v||s[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(on(t)){if(a){l=[];for(var p=0;p<v;p++)l[p]=[u[p][0]];return new e({data:l,size:[v,1],datatype:t._datatype})}return t}if(sn(t)){for(var D=0;D<v;D++)l[D]=[0];for(var h=t._values,m=t._index,d=t._ptr,w=d[1],g=d[0];g<w;g++){var E=m[g];l[E][0]=h[g]}return new e({data:l,size:[v,1],datatype:t._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Mr(t)){var F=Lr(t);if(F.length===1){if(F[0]!==v)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<v;y++)l[y]=[t[y]];return new e({data:l,size:[v,1]})}if(F.length===2){if(F[0]!==v||F[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var C=0;C<v;C++)l[C]=[t[C][0]];return new e({data:l,size:[v,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var Ji="lsolve",pc=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],dc=j(Ji,pc,r=>{var{typed:e,matrix:n,divideScalar:i,multiplyScalar:t,subtractScalar:a,equalScalar:o,DenseMatrix:v}=r,c=Et({DenseMatrix:v});return e(Ji,{"SparseMatrix, Array | Matrix":function(f,p){return s(f,p)},"DenseMatrix, Array | Matrix":function(f,p){return l(f,p)},"Array, Array | Matrix":function(f,p){var D=n(f),h=l(D,p);return h.valueOf()}});function l(u,f){f=c(u,f,!0);for(var p=f._data,D=u._size[0],h=u._size[1],m=[],d=u._data,w=0;w<h;w++){var g=p[w][0]||0,E=void 0;if(o(g,0))E=0;else{var F=d[w][w];if(o(F,0))throw new Error("Linear system cannot be solved since matrix is singular");E=i(g,F);for(var y=w+1;y<D;y++)p[y]=[a(p[y][0]||0,t(E,d[y][w]))]}m[w]=[E]}return new v({data:m,size:[D,1]})}function s(u,f){f=c(u,f,!0);for(var p=f._data,D=u._size[0],h=u._size[1],m=u._values,d=u._index,w=u._ptr,g=[],E=0;E<h;E++){var F=p[E][0]||0;if(o(F,0))g[E]=[0];else{for(var y=0,C=[],b=[],A=w[E],S=w[E+1],M=A;M<S;M++){var N=d[M];N===E?y=m[M]:N>E&&(C.push(m[M]),b.push(N))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var O=i(F,y),T=0,I=b.length;T<I;T++){var B=b[T];p[B]=[a(p[B][0]||0,t(O,C[T]))]}g[E]=[O]}}return new v({data:g,size:[D,1]})}}),Qi="usolve",mc=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],gc=j(Qi,mc,r=>{var{typed:e,matrix:n,divideScalar:i,multiplyScalar:t,subtractScalar:a,equalScalar:o,DenseMatrix:v}=r,c=Et({DenseMatrix:v});return e(Qi,{"SparseMatrix, Array | Matrix":function(f,p){return s(f,p)},"DenseMatrix, Array | Matrix":function(f,p){return l(f,p)},"Array, Array | Matrix":function(f,p){var D=n(f),h=l(D,p);return h.valueOf()}});function l(u,f){f=c(u,f,!0);for(var p=f._data,D=u._size[0],h=u._size[1],m=[],d=u._data,w=h-1;w>=0;w--){var g=p[w][0]||0,E=void 0;if(o(g,0))E=0;else{var F=d[w][w];if(o(F,0))throw new Error("Linear system cannot be solved since matrix is singular");E=i(g,F);for(var y=w-1;y>=0;y--)p[y]=[a(p[y][0]||0,t(E,d[y][w]))]}m[w]=[E]}return new v({data:m,size:[D,1]})}function s(u,f){f=c(u,f,!0);for(var p=f._data,D=u._size[0],h=u._size[1],m=u._values,d=u._index,w=u._ptr,g=[],E=h-1;E>=0;E--){var F=p[E][0]||0;if(o(F,0))g[E]=[0];else{for(var y=0,C=[],b=[],A=w[E],S=w[E+1],M=S-1;M>=A;M--){var N=d[M];N===E?y=m[M]:N<E&&(C.push(m[M]),b.push(N))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var O=i(F,y),T=0,I=b.length;T<I;T++){var B=b[T];p[B]=[a(p[B][0],t(O,C[T]))]}g[E]=[O]}}return new v({data:g,size:[D,1]})}}),Xi="usolveAll",Dc=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],yc=j(Xi,Dc,r=>{var{typed:e,matrix:n,divideScalar:i,multiplyScalar:t,subtractScalar:a,equalScalar:o,DenseMatrix:v}=r,c=Et({DenseMatrix:v});return e(Xi,{"SparseMatrix, Array | Matrix":function(f,p){return s(f,p)},"DenseMatrix, Array | Matrix":function(f,p){return l(f,p)},"Array, Array | Matrix":function(f,p){var D=n(f),h=l(D,p);return h.map(m=>m.valueOf())}});function l(u,f){for(var p=[c(u,f,!0)._data.map(b=>b[0])],D=u._data,h=u._size[0],m=u._size[1],d=m-1;d>=0;d--)for(var w=p.length,g=0;g<w;g++){var E=p[g];if(o(D[d][d],0))if(o(E[d],0)){if(g===0){var y=[...E];y[d]=1;for(var C=d-1;C>=0;C--)y[C]=a(y[C],D[C][d]);p.push(y)}}else{if(g===0)return[];p.splice(g,1),g-=1,w-=1}else{E[d]=i(E[d],D[d][d]);for(var F=d-1;F>=0;F--)E[F]=a(E[F],t(E[d],D[F][d]))}}return p.map(b=>new v({data:b.map(A=>[A]),size:[h,1]}))}function s(u,f){for(var p=[c(u,f,!0)._data.map(W=>W[0])],D=u._size[0],h=u._size[1],m=u._values,d=u._index,w=u._ptr,g=h-1;g>=0;g--)for(var E=p.length,F=0;F<E;F++){for(var y=p[F],C=[],b=[],A=w[g],S=w[g+1],M=0,N=S-1;N>=A;N--){var O=d[N];O===g?M=m[N]:O<g&&(C.push(m[N]),b.push(O))}if(o(M,0))if(o(y[g],0)){if(F===0){var G=[...y];G[g]=1;for(var q=0,z=b.length;q<z;q++){var V=b[q];G[V]=a(G[V],C[q])}p.push(G)}}else{if(F===0)return[];p.splice(F,1),F-=1,E-=1}else{y[g]=i(y[g],M);for(var T=0,I=b.length;T<I;T++){var B=b[T];y[B]=a(y[B],t(y[g],C[T]))}}}return p.map(W=>new v({data:W.map(P=>[P]),size:[D,1]}))}}),Ft="equal",wc=["typed","matrix","equalScalar","DenseMatrix","concat"],Ac=j(Ft,wc,r=>{var{typed:e,matrix:n,equalScalar:i,DenseMatrix:t,concat:a}=r,o=Re({typed:e}),v=He({typed:e,DenseMatrix:t}),c=Pe({typed:e,DenseMatrix:t}),l=xe({typed:e,matrix:n,concat:a});return e(Ft,Ec({typed:e,equalScalar:i}),l({elop:i,SS:v,DS:o,Ss:c}))}),Ec=j(Ft,["typed","equalScalar"],r=>{var{typed:e,equalScalar:n}=r;return e(Ft,{"any, any":function(t,a){return t===null?a===null:a===null?t===null:t===void 0?a===void 0:a===void 0?t===void 0:n(t,a)}})}),Ct="smaller",Fc=["typed","config","matrix","DenseMatrix","concat"],Cc=j(Ct,Fc,r=>{var{typed:e,config:n,matrix:i,DenseMatrix:t,concat:a}=r,o=Re({typed:e}),v=He({typed:e,DenseMatrix:t}),c=Pe({typed:e,DenseMatrix:t}),l=xe({typed:e,matrix:i,concat:a}),s=Ke({typed:e});return e(Ct,bc({typed:e,config:n}),{"boolean, boolean":(u,f)=>u<f,"BigNumber, BigNumber":function(f,p){return f.lt(p)&&!Xe(f,p,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)===-1,"Complex, Complex":function(f,p){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:v,DS:o,Ss:c}))}),bc=j(Ct,["typed","config"],r=>{var{typed:e,config:n}=r;return e(Ct,{"number, number":function(t,a){return t<a&&!De(t,a,n.epsilon)}})}),bt="smallerEq",Mc=["typed","config","matrix","DenseMatrix","concat"],Sc=j(bt,Mc,r=>{var{typed:e,config:n,matrix:i,DenseMatrix:t,concat:a}=r,o=Re({typed:e}),v=He({typed:e,DenseMatrix:t}),c=Pe({typed:e,DenseMatrix:t}),l=xe({typed:e,matrix:i,concat:a}),s=Ke({typed:e});return e(bt,Nc({typed:e,config:n}),{"boolean, boolean":(u,f)=>u<=f,"BigNumber, BigNumber":function(f,p){return f.lte(p)||Xe(f,p,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:v,DS:o,Ss:c}))}),Nc=j(bt,["typed","config"],r=>{var{typed:e,config:n}=r;return e(bt,{"number, number":function(t,a){return t<=a||De(t,a,n.epsilon)}})}),Mt="larger",xc=["typed","config","matrix","DenseMatrix","concat"],Bc=j(Mt,xc,r=>{var{typed:e,config:n,matrix:i,DenseMatrix:t,concat:a}=r,o=Re({typed:e}),v=He({typed:e,DenseMatrix:t}),c=Pe({typed:e,DenseMatrix:t}),l=xe({typed:e,matrix:i,concat:a}),s=Ke({typed:e});return e(Mt,_c({typed:e,config:n}),{"boolean, boolean":(u,f)=>u>f,"BigNumber, BigNumber":function(f,p){return f.gt(p)&&!Xe(f,p,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)===1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:v,DS:o,Ss:c}))}),_c=j(Mt,["typed","config"],r=>{var{typed:e,config:n}=r;return e(Mt,{"number, number":function(t,a){return t>a&&!De(t,a,n.epsilon)}})}),St="largerEq",zc=["typed","config","matrix","DenseMatrix","concat"],Tc=j(St,zc,r=>{var{typed:e,config:n,matrix:i,DenseMatrix:t,concat:a}=r,o=Re({typed:e}),v=He({typed:e,DenseMatrix:t}),c=Pe({typed:e,DenseMatrix:t}),l=xe({typed:e,matrix:i,concat:a}),s=Ke({typed:e});return e(St,Oc({typed:e,config:n}),{"boolean, boolean":(u,f)=>u>=f,"BigNumber, BigNumber":function(f,p){return f.gte(p)||Xe(f,p,n.epsilon)},"Fraction, Fraction":(u,f)=>u.compare(f)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},s,l({SS:v,DS:o,Ss:c}))}),Oc=j(St,["typed","config"],r=>{var{typed:e,config:n}=r;return e(St,{"number, number":function(t,a){return t>=a||De(t,a,n.epsilon)}})}),Ic="ImmutableDenseMatrix",$c=["smaller","DenseMatrix"],qc=j(Ic,$c,r=>{var{smaller:e,DenseMatrix:n}=r;function i(t,a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!ne(a))throw new Error("Invalid datatype: "+a);if(xr(t)||Mr(t)){var o=new n(t,a);this._data=o._data,this._size=o._size,this._datatype=o._datatype,this._min=null,this._max=null}else if(t&&Mr(t.data)&&Mr(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min=typeof t.min<"u"?t.min:null,this._max=typeof t.max<"u"?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+ce(t)+")");this._data=[],this._size=[0],this._datatype=a,this._min=null,this._max=null}}return i.prototype=new n,i.prototype.type="ImmutableDenseMatrix",i.prototype.isImmutableDenseMatrix=!0,i.prototype.subset=function(t){switch(arguments.length){case 1:{var a=n.prototype.subset.call(this,t);return xr(a)?new i({data:a._data,size:a._size,datatype:a._datatype}):a}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},i.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},i.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},i.prototype.clone=function(){return new i({data:Fr(this._data),size:Fr(this._size),datatype:this._datatype})},i.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},i.fromJSON=function(t){return new i(t)},i.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},i.prototype.min=function(){if(this._min===null){var t=null;this.forEach(function(a){(t===null||e(a,t))&&(t=a)}),this._min=t!==null?t:void 0}return this._min},i.prototype.max=function(){if(this._max===null){var t=null;this.forEach(function(a){(t===null||e(t,a))&&(t=a)}),this._max=t!==null?t:void 0}return this._max},i},{isClass:!0}),Lc="Index",Pc=["ImmutableDenseMatrix","getMatrixDataType"],Rc=j(Lc,Pc,r=>{var{ImmutableDenseMatrix:e,getMatrixDataType:n}=r;function i(a){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var o=0,v=arguments.length;o<v;o++){var c=arguments[o],l=Mr(c),s=xr(c),u=null;if(fn(c))this._dimensions.push(c),this._isScalar=!1;else if(l||s){var f=void 0;n(c)==="boolean"?(l&&(f=t(Ki(c).valueOf())),s&&(f=t(Ki(c._data).valueOf())),u=c.valueOf().length):f=t(c.valueOf()),this._dimensions.push(f);var p=f.size();(p.length!==1||p[0]!==1||u!==null)&&(this._isScalar=!1)}else if(typeof c=="number")this._dimensions.push(t([c]));else if(typeof c=="string")this._dimensions.push(c);else throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(u)}}i.prototype.type="Index",i.prototype.isIndex=!0;function t(a){for(var o=0,v=a.length;o<v;o++)if(typeof a[o]!="number"||!zr(a[o]))throw new TypeError("Index parameters must be positive integer numbers");return new e(a)}return i.prototype.clone=function(){var a=new i;return a._dimensions=Fr(this._dimensions),a._isScalar=this._isScalar,a._sourceSize=this._sourceSize,a},i.create=function(a){var o=new i;return i.apply(o,a),o},i.prototype.size=function(){for(var a=[],o=0,v=this._dimensions.length;o<v;o++){var c=this._dimensions[o];a[o]=typeof c=="string"?1:c.size()[0]}return a},i.prototype.max=function(){for(var a=[],o=0,v=this._dimensions.length;o<v;o++){var c=this._dimensions[o];a[o]=typeof c=="string"?c:c.max()}return a},i.prototype.min=function(){for(var a=[],o=0,v=this._dimensions.length;o<v;o++){var c=this._dimensions[o];a[o]=typeof c=="string"?c:c.min()}return a},i.prototype.forEach=function(a){for(var o=0,v=this._dimensions.length;o<v;o++)a(this._dimensions[o],o,this)},i.prototype.dimension=function(a){return this._dimensions[a]||null},i.prototype.isObjectProperty=function(){return this._dimensions.length===1&&typeof this._dimensions[0]=="string"},i.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},i.prototype.isScalar=function(){return this._isScalar},i.prototype.toArray=function(){for(var a=[],o=0,v=this._dimensions.length;o<v;o++){var c=this._dimensions[o];a.push(typeof c=="string"?c:c.toArray())}return a},i.prototype.valueOf=i.prototype.toArray,i.prototype.toString=function(){for(var a=[],o=0,v=this._dimensions.length;o<v;o++){var c=this._dimensions[o];typeof c=="string"?a.push(JSON.stringify(c)):a.push(c.toString())}return"["+a.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},i.fromJSON=function(a){return i.create(a.dimensions)},i},{isClass:!0});function Ki(r){var e=[];return r.forEach((n,i)=>{n&&e.push(i)}),e}var Uc="FibonacciHeap",Vc=["smaller","larger"],Zc=j(Uc,Vc,r=>{var{smaller:e,larger:n}=r,i=1/Math.log((1+Math.sqrt(5))/2);function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}t.prototype.type="FibonacciHeap",t.prototype.isFibonacciHeap=!0,t.prototype.insert=function(s,u){var f={key:s,value:u,degree:0};if(this._minimum){var p=this._minimum;f.left=p,f.right=p.right,p.right=f,f.right.left=f,e(s,p.key)&&(this._minimum=f)}else f.left=f,f.right=f,this._minimum=f;return this._size++,f},t.prototype.size=function(){return this._size},t.prototype.clear=function(){this._minimum=null,this._size=0},t.prototype.isEmpty=function(){return this._size===0},t.prototype.extractMinimum=function(){var s=this._minimum;if(s===null)return s;for(var u=this._minimum,f=s.degree,p=s.child;f>0;){var D=p.right;p.left.right=p.right,p.right.left=p.left,p.left=u,p.right=u.right,u.right=p,p.right.left=p,p.parent=null,p=D,f--}return s.left.right=s.right,s.right.left=s.left,s===s.right?u=null:(u=s.right,u=l(u,this._size)),this._size--,this._minimum=u,s},t.prototype.remove=function(s){this._minimum=a(this._minimum,s,-1),this.extractMinimum()};function a(s,u,f){u.key=f;var p=u.parent;return p&&e(u.key,p.key)&&(o(s,u,p),v(s,p)),e(u.key,s.key)&&(s=u),s}function o(s,u,f){u.left.right=u.right,u.right.left=u.left,f.degree--,f.child===u&&(f.child=u.right),f.degree===0&&(f.child=null),u.left=s,u.right=s.right,s.right=u,u.right.left=u,u.parent=null,u.mark=!1}function v(s,u){var f=u.parent;f&&(u.mark?(o(s,u,f),v(f)):u.mark=!0)}var c=function(u,f){u.left.right=u.right,u.right.left=u.left,u.parent=f,f.child?(u.left=f.child,u.right=f.child.right,f.child.right=u,u.right.left=u):(f.child=u,u.right=u,u.left=u),f.degree++,u.mark=!1};function l(s,u){var f=Math.floor(Math.log(u)*i)+1,p=new Array(f),D=0,h=s;if(h)for(D++,h=h.right;h!==s;)D++,h=h.right;for(var m;D>0;){for(var d=h.degree,w=h.right;m=p[d],!!m;){if(n(h.key,m.key)){var g=m;m=h,h=g}c(m,h),p[d]=null,d++}p[d]=h,h=w,D--}s=null;for(var E=0;E<f;E++)m=p[E],m&&(s?(m.left.right=m.right,m.right.left=m.left,m.left=s,m.right=s.right,s.right=m,m.right.left=m,e(m.key,s.key)&&(s=m)):s=m);return s}return t},{isClass:!0}),Gc="Spa",Yc=["addScalar","equalScalar","FibonacciHeap"],Jc=j(Gc,Yc,r=>{var{addScalar:e,equalScalar:n,FibonacciHeap:i}=r;function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new i}return t.prototype.type="Spa",t.prototype.isSpa=!0,t.prototype.set=function(a,o){if(this._values[a])this._values[a].value=o;else{var v=this._heap.insert(a,o);this._values[a]=v}},t.prototype.get=function(a){var o=this._values[a];return o?o.value:0},t.prototype.accumulate=function(a,o){var v=this._values[a];v?v.value=e(v.value,o):(v=this._heap.insert(a,o),this._values[a]=v)},t.prototype.forEach=function(a,o,v){var c=this._heap,l=this._values,s=[],u=c.extractMinimum();for(u&&s.push(u);u&&u.key<=o;)u.key>=a&&(n(u.value,0)||v(u.key,u.value,this)),u=c.extractMinimum(),u&&s.push(u);for(var f=0;f<s.length;f++){var p=s[f];u=c.insert(p.key,p.value),l[u.key]=u}},t.prototype.swap=function(a,o){var v=this._values[a],c=this._values[o];if(!v&&c)v=this._heap.insert(a,c.value),this._heap.remove(c),this._values[a]=v,this._values[o]=void 0;else if(v&&!c)c=this._heap.insert(o,v.value),this._heap.remove(v),this._values[o]=c,this._values[a]=void 0;else if(v&&c){var l=v.value;v.value=c.value,c.value=l}},t},{isClass:!0}),Qc="atan",Xc=["typed"],Kc=j(Qc,Xc,r=>{var{typed:e}=r;return e("atan",{number:function(i){return Math.atan(i)},Complex:function(i){return i.atan()},BigNumber:function(i){return i.atan()}})}),Hi=j("trigUnit",["typed"],r=>{var{typed:e}=r;return{Unit:e.referToSelf(n=>i=>{if(!i.hasBase(i.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return e.find(n,i.valueType())(i.value)})}}),Wi="cos",Hc=["typed"],Wc=j(Wi,Hc,r=>{var{typed:e}=r,n=Hi({typed:e});return e(Wi,{number:Math.cos,"Complex | BigNumber":i=>i.cos()},n)}),ki="sin",kc=["typed"],jc=j(ki,kc,r=>{var{typed:e}=r,n=Hi({typed:e});return e(ki,{number:Math.sin,"Complex | BigNumber":i=>i.sin()},n)}),ji="add",rl=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],el=j(ji,rl,r=>{var{typed:e,matrix:n,addScalar:i,equalScalar:t,DenseMatrix:a,SparseMatrix:o,concat:v}=r,c=yi({typed:e}),l=uf({typed:e,equalScalar:t}),s=wi({typed:e,DenseMatrix:a}),u=xe({typed:e,matrix:n,concat:v});return e(ji,{"any, any":i,"any, any, ...any":e.referToSelf(f=>(p,D,h)=>{for(var m=f(p,D),d=0;d<h.length;d++)m=f(m,h[d]);return m})},u({elop:i,DS:c,SS:l,Ss:s}))}),ra="norm",tl=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],nl=j(ra,tl,r=>{var{typed:e,abs:n,add:i,pow:t,conj:a,sqrt:o,multiply:v,equalScalar:c,larger:l,smaller:s,matrix:u,ctranspose:f,eigs:p}=r;return e(ra,{number:Math.abs,Complex:function(b){return b.abs()},BigNumber:function(b){return b.abs()},boolean:function(b){return Math.abs(b)},Array:function(b){return y(u(b),2)},Matrix:function(b){return y(b,2)},"Array, number | BigNumber | string":function(b,A){return y(u(b),A)},"Matrix, number | BigNumber | string":function(b,A){return y(b,A)}});function D(C){var b=0;return C.forEach(function(A){var S=n(A);l(S,b)&&(b=S)},!0),b}function h(C){var b;return C.forEach(function(A){var S=n(A);(!b||s(S,b))&&(b=S)},!0),b||0}function m(C,b){if(b===Number.POSITIVE_INFINITY||b==="inf")return D(C);if(b===Number.NEGATIVE_INFINITY||b==="-inf")return h(C);if(b==="fro")return y(C,2);if(typeof b=="number"&&!isNaN(b)){if(!c(b,0)){var A=0;return C.forEach(function(S){A=i(t(n(S),b),A)},!0),t(A,1/b)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function d(C){var b=0;return C.forEach(function(A,S){b=i(b,v(A,a(A)))}),n(o(b))}function w(C){var b=[],A=0;return C.forEach(function(S,M){var N=M[1],O=i(b[N]||0,n(S));l(O,A)&&(A=O),b[N]=O},!0),A}function g(C){var b=C.size();if(b[0]!==b[1])throw new RangeError("Invalid matrix dimensions");var A=f(C),S=v(A,C),M=p(S).values.toArray(),N=M[M.length-1];return n(o(N))}function E(C){var b=[],A=0;return C.forEach(function(S,M){var N=M[0],O=i(b[N]||0,n(S));l(O,A)&&(A=O),b[N]=O},!0),A}function F(C,b){if(b===1)return w(C);if(b===Number.POSITIVE_INFINITY||b==="inf")return E(C);if(b==="fro")return d(C);if(b===2)return g(C);throw new Error("Unsupported parameter value "+b)}function y(C,b){var A=C.size();if(A.length===1)return m(C,b);if(A.length===2){if(A[0]&&A[1])return F(C,b);throw new RangeError("Invalid matrix dimensions")}}}),ea="dot",il=["typed","addScalar","multiplyScalar","conj","size"],al=j(ea,il,r=>{var{typed:e,addScalar:n,multiplyScalar:i,conj:t,size:a}=r;return e(ea,{"Array | DenseMatrix, Array | DenseMatrix":v,"SparseMatrix, SparseMatrix":c});function o(s,u){var f=l(s),p=l(u),D,h;if(f.length===1)D=f[0];else if(f.length===2&&f[1]===1)D=f[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+f.join(", ")+")");if(p.length===1)h=p[0];else if(p.length===2&&p[1]===1)h=p[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+p.join(", ")+")");if(D!==h)throw new RangeError("Vectors must have equal length ("+D+" != "+h+")");if(D===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return D}function v(s,u){var f=o(s,u),p=xr(s)?s._data:s,D=xr(s)?s._datatype:void 0,h=xr(u)?u._data:u,m=xr(u)?u._datatype:void 0,d=l(s).length===2,w=l(u).length===2,g=n,E=i;if(D&&m&&D===m&&typeof D=="string"){var F=D;g=e.find(n,[F,F]),E=e.find(i,[F,F])}if(!d&&!w){for(var y=E(t(p[0]),h[0]),C=1;C<f;C++)y=g(y,E(t(p[C]),h[C]));return y}if(!d&&w){for(var b=E(t(p[0]),h[0][0]),A=1;A<f;A++)b=g(b,E(t(p[A]),h[A][0]));return b}if(d&&!w){for(var S=E(t(p[0][0]),h[0]),M=1;M<f;M++)S=g(S,E(t(p[M][0]),h[M]));return S}if(d&&w){for(var N=E(t(p[0][0]),h[0][0]),O=1;O<f;O++)N=g(N,E(t(p[O][0]),h[O][0]));return N}}function c(s,u){o(s,u);for(var f=s._index,p=s._values,D=u._index,h=u._values,m=0,d=n,w=i,g=0,E=0;g<f.length&&E<D.length;){var F=f[g],y=D[E];if(F<y){g++;continue}if(F>y){E++;continue}F===y&&(m=d(m,w(p[g],h[E])),g++,E++)}return m}function l(s){return xr(s)?s.size():a(s)}}),ta="index",ul=["typed","Index"],ol=j(ta,ul,r=>{var{typed:e,Index:n}=r;return e(ta,{"...number | string | BigNumber | Range | Array | Matrix":function(t){var a=t.map(function(v){return Rr(v)?v.toNumber():Mr(v)||xr(v)?v.map(function(c){return Rr(c)?c.toNumber():c}):v}),o=new n;return n.apply(o,a),o}})}),na="lup",sl=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],fl=j(na,sl,r=>{var{typed:e,matrix:n,abs:i,addScalar:t,divideScalar:a,multiplyScalar:o,subtractScalar:v,larger:c,equalScalar:l,unaryMinus:s,DenseMatrix:u,SparseMatrix:f,Spa:p}=r;return e(na,{DenseMatrix:function(d){return D(d)},SparseMatrix:function(d){return h(d)},Array:function(d){var w=n(d),g=D(w);return{L:g.L.valueOf(),U:g.U.valueOf(),p:g.p}}});function D(m){var d=m._size[0],w=m._size[1],g=Math.min(d,w),E=Fr(m._data),F=[],y=[d,g],C=[],b=[g,w],A,S,M,N=[];for(A=0;A<d;A++)N[A]=A;for(S=0;S<w;S++){if(S>0)for(A=0;A<d;A++){var O=Math.min(A,S),T=0;for(M=0;M<O;M++)T=t(T,o(E[A][M],E[M][S]));E[A][S]=v(E[A][S],T)}var I=S,B=0,G=0;for(A=S;A<d;A++){var q=E[A][S],z=i(q);c(z,B)&&(I=A,B=z,G=q)}if(S!==I&&(N[S]=[N[I],N[I]=N[S]][0],u._swapRows(S,I,E)),S<d)for(A=S+1;A<d;A++){var V=E[A][S];l(V,0)||(E[A][S]=a(E[A][S],G))}}for(S=0;S<w;S++)for(A=0;A<d;A++){if(S===0&&(A<w&&(C[A]=[]),F[A]=[]),A<S){A<w&&(C[A][S]=E[A][S]),S<d&&(F[A][S]=0);continue}if(A===S){A<w&&(C[A][S]=E[A][S]),S<d&&(F[A][S]=1);continue}A<w&&(C[A][S]=0),S<d&&(F[A][S]=E[A][S])}var W=new u({data:F,size:y}),P=new u({data:C,size:b}),L=[];for(A=0,g=N.length;A<g;A++)L[N[A]]=A;return{L:W,U:P,p:L,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function h(m){var d=m._size[0],w=m._size[1],g=Math.min(d,w),E=m._values,F=m._index,y=m._ptr,C=[],b=[],A=[],S=[d,g],M=[],N=[],O=[],T=[g,w],I,B,G,q=[],z=[];for(I=0;I<d;I++)q[I]=I,z[I]=I;var V=function(L,Z){var nr=z[L],k=z[Z];q[nr]=Z,q[k]=L,z[L]=k,z[Z]=nr},W=function(){var L=new p;B<d&&(A.push(C.length),C.push(1),b.push(B)),O.push(M.length);var Z=y[B],nr=y[B+1];for(G=Z;G<nr;G++)I=F[G],L.set(q[I],E[G]);B>0&&L.forEach(0,B-1,function(X,J){f._forEachRow(X,C,b,A,function(ur,rr){ur>X&&L.accumulate(ur,s(o(rr,J)))})});var k=B,U=L.get(B),Q=i(U);L.forEach(B+1,d-1,function(X,J){var ur=i(J);c(ur,Q)&&(k=X,Q=ur,U=J)}),B!==k&&(f._swapRows(B,k,S[1],C,b,A),f._swapRows(B,k,T[1],M,N,O),L.swap(B,k),V(B,k)),L.forEach(0,d-1,function(X,J){X<=B?(M.push(J),N.push(X)):(J=a(J,U),l(J,0)||(C.push(J),b.push(X)))})};for(B=0;B<w;B++)W();return O.push(M.length),A.push(C.length),{L:new f({values:C,index:b,ptr:A,size:S}),U:new f({values:M,index:N,ptr:O,size:T}),p:q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),ia="qr",cl=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],ll=j(ia,cl,r=>{var{typed:e,matrix:n,zeros:i,identity:t,isZero:a,equal:o,sign:v,sqrt:c,conj:l,unaryMinus:s,addScalar:u,divideScalar:f,multiplyScalar:p,subtractScalar:D,complex:h}=r;return Gr(e(ia,{DenseMatrix:function(E){return d(E)},SparseMatrix:function(E){return w()},Array:function(E){var F=n(E),y=d(F);return{Q:y.Q.valueOf(),R:y.R.valueOf()}}}),{_denseQRimpl:m});function m(g){var E=g._size[0],F=g._size[1],y=t([E],"dense"),C=y._data,b=g.clone(),A=b._data,S,M,N,O=i([E],"");for(N=0;N<Math.min(F,E);++N){var T=A[N][N],I=s(o(T,0)?1:v(T)),B=l(I),G=0;for(S=N;S<E;S++)G=u(G,p(A[S][N],l(A[S][N])));var q=p(I,c(G));if(!a(q)){var z=D(T,q);for(O[N]=1,S=N+1;S<E;S++)O[S]=f(A[S][N],z);var V=s(l(f(z,q))),W=void 0;for(M=N;M<F;M++){for(W=0,S=N;S<E;S++)W=u(W,p(l(O[S]),A[S][M]));for(W=p(W,V),S=N;S<E;S++)A[S][M]=p(D(A[S][M],p(O[S],W)),B)}for(S=0;S<E;S++){for(W=0,M=N;M<E;M++)W=u(W,p(C[S][M],O[M]));for(W=p(W,V),M=N;M<E;++M)C[S][M]=f(D(C[S][M],p(W,l(O[M]))),B)}}}return{Q:y,R:b,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function d(g){var E=m(g),F=E.R._data;if(g._data.length>0)for(var y=F[0][0].type==="Complex"?h(0):0,C=0;C<F.length;++C)for(var b=0;b<C&&b<(F[0]||[]).length;++b)F[C][b]=y;return E}function w(g){throw new Error("qr not implemented for sparse matrices yet")}});function vl(r,e,n,i){for(var t=r._values,a=r._index,o=r._ptr,v=r._size,c=r._datatype,l=v[0],s=v[1],u=i&&r._values?[]:null,f=[],p=[],D=0,h=0;h<s;h++){p[h]=D;for(var m=n?n[h]:h,d=o[m],w=o[m+1],g=d;g<w;g++){var E=e?e[a[g]]:a[g];f[D]=E,u&&(u[D]=t[g]),D++}}return p[s]=D,r.createSparseMatrix({values:u,index:f,ptr:p,size:[l,s],datatype:c})}function aa(r,e,n,i,t,a,o){var v=0;for(n[o]=r;v>=0;){var c=n[o+v],l=n[i+c];l===-1?(v--,a[e++]=c):(n[i+c]=n[t+l],++v,n[o+v]=l)}return e}function hl(r,e){if(!r)return null;var n=0,i,t=[],a=[],o=0,v=e,c=2*e;for(i=0;i<e;i++)a[o+i]=-1;for(i=e-1;i>=0;i--)r[i]!==-1&&(a[v+i]=a[o+r[i]],a[o+r[i]]=i);for(i=0;i<e;i++)r[i]===-1&&(n=aa(i,n,a,o,v,t,c));return t}function pl(r,e){if(!r)return null;var n=r._index,i=r._ptr,t=r._size,a=t[0],o=t[1],v=[],c=[],l=0,s=o,u,f;if(e)for(u=0;u<a;u++)c[s+u]=-1;for(var p=0;p<o;p++){v[p]=-1,c[l+p]=-1;for(var D=i[p],h=i[p+1],m=D;m<h;m++){var d=n[m];for(u=e?c[s+d]:d;u!==-1&&u<p;u=f)f=c[l+u],c[l+u]=p,f===-1&&(v[u]=p);e&&(c[s+d]=p)}}return v}function dl(r,e,n){for(var i=r._values,t=r._index,a=r._ptr,o=r._size,v=o[1],c=0,l=0;l<v;l++){var s=a[l];for(a[l]=c;s<a[l+1];s++)e(t[s],l,i?i[s]:1,n)&&(t[c]=t[s],i&&(i[c]=i[s]),c++)}return a[v]=c,t.splice(c,t.length-c),i&&i.splice(c,i.length-c),c}function Fe(r){return-r-2}var ml="csAmd",gl=["add","multiply","transpose"],Dl=j(ml,gl,r=>{var{add:e,multiply:n,transpose:i}=r;return function(s,u){if(!u||s<=0||s>3)return null;var f=u._size,p=f[0],D=f[1],h=0,m=Math.max(16,10*Math.sqrt(D));m=Math.min(D-2,m);var d=t(s,u,p,D,m);dl(d,c,null);for(var w=d._index,g=d._ptr,E=g[D],F=[],y=[],C=0,b=D+1,A=2*(D+1),S=3*(D+1),M=4*(D+1),N=5*(D+1),O=6*(D+1),T=7*(D+1),I=F,B=a(D,g,y,C,S,I,A,T,b,O,M,N),G=o(D,g,y,N,M,O,m,b,S,I,A),q=0,z,V,W,P,L,Z,nr,k,U,Q,X,J,ur,rr,or,fr;G<D;){for(W=-1;q<D&&(W=y[S+q])===-1;q++);y[A+W]!==-1&&(I[y[A+W]]=-1),y[S+q]=y[A+W];var pr=y[M+W],gr=y[b+W];G+=gr;var yr=0;y[b+W]=-gr;var cr=g[W],Cr=pr===0?cr:E,Er=Cr;for(P=1;P<=pr+1;P++){for(P>pr?(Z=W,nr=cr,k=y[C+W]-pr):(Z=w[cr++],nr=g[Z],k=y[C+Z]),L=1;L<=k;L++)z=w[nr++],!((U=y[b+z])<=0)&&(yr+=U,y[b+z]=-U,w[Er++]=z,y[A+z]!==-1&&(I[y[A+z]]=I[z]),I[z]!==-1?y[A+I[z]]=y[A+z]:y[S+y[N+z]]=y[A+z]);Z!==W&&(g[Z]=Fe(W),y[O+Z]=0)}for(pr!==0&&(E=Er),y[N+W]=yr,g[W]=Cr,y[C+W]=Er-Cr,y[M+W]=-2,B=v(B,h,y,O,D),Q=Cr;Q<Er;Q++)if(z=w[Q],!((X=y[M+z])<=0)){U=-y[b+z];var Sr=B-U;for(cr=g[z],J=g[z]+X-1;cr<=J;cr++)Z=w[cr],y[O+Z]>=B?y[O+Z]-=U:y[O+Z]!==0&&(y[O+Z]=y[N+Z]+Sr)}for(Q=Cr;Q<Er;Q++){for(z=w[Q],J=g[z],ur=J+y[M+z]-1,rr=J,or=0,fr=0,cr=J;cr<=ur;cr++)if(Z=w[cr],y[O+Z]!==0){var Zr=y[O+Z]-B;Zr>0?(fr+=Zr,w[rr++]=Z,or+=Z):(g[Z]=Fe(W),y[O+Z]=0)}y[M+z]=rr-J+1;var x=rr,_=J+y[C+z];for(cr=ur+1;cr<_;cr++){V=w[cr];var $=y[b+V];$<=0||(fr+=$,w[rr++]=V,or+=V)}fr===0?(g[z]=Fe(W),U=-y[b+z],yr-=U,gr+=U,G+=U,y[b+z]=0,y[M+z]=-1):(y[N+z]=Math.min(y[N+z],fr),w[rr]=w[x],w[x]=w[J],w[J]=W,y[C+z]=rr-J+1,or=(or<0?-or:or)%D,y[A+z]=y[T+or],y[T+or]=z,I[z]=or)}for(y[N+W]=yr,h=Math.max(h,yr),B=v(B+h,h,y,O,D),Q=Cr;Q<Er;Q++)if(z=w[Q],!(y[b+z]>=0))for(or=I[z],z=y[T+or],y[T+or]=-1;z!==-1&&y[A+z]!==-1;z=y[A+z],B++){for(k=y[C+z],X=y[M+z],cr=g[z]+1;cr<=g[z]+k-1;cr++)y[O+w[cr]]=B;var R=z;for(V=y[A+z];V!==-1;){var K=y[C+V]===k&&y[M+V]===X;for(cr=g[V]+1;K&&cr<=g[V]+k-1;cr++)y[O+w[cr]]!==B&&(K=0);K?(g[V]=Fe(z),y[b+z]+=y[b+V],y[b+V]=0,y[M+V]=-1,V=y[A+V],y[A+R]=V):(R=V,V=y[A+V])}}for(cr=Cr,Q=Cr;Q<Er;Q++)z=w[Q],!((U=-y[b+z])<=0)&&(y[b+z]=U,fr=y[N+z]+yr-U,fr=Math.min(fr,D-G-U),y[S+fr]!==-1&&(I[y[S+fr]]=z),y[A+z]=y[S+fr],I[z]=-1,y[S+fr]=z,q=Math.min(q,fr),y[N+z]=fr,w[cr++]=z);y[b+W]=gr,(y[C+W]=cr-Cr)===0&&(g[W]=-1,y[O+W]=0),pr!==0&&(E=cr)}for(z=0;z<D;z++)g[z]=Fe(g[z]);for(V=0;V<=D;V++)y[S+V]=-1;for(V=D;V>=0;V--)y[b+V]>0||(y[A+V]=y[S+g[V]],y[S+g[V]]=V);for(Z=D;Z>=0;Z--)y[b+Z]<=0||g[Z]!==-1&&(y[A+Z]=y[S+g[Z]],y[S+g[Z]]=Z);for(W=0,z=0;z<=D;z++)g[z]===-1&&(W=aa(z,W,y,S,A,F,O));return F.splice(F.length-1,1),F};function t(l,s,u,f,p){var D=i(s);if(l===1&&f===u)return e(s,D);if(l===2){for(var h=D._index,m=D._ptr,d=0,w=0;w<u;w++){var g=m[w];if(m[w]=d,!(m[w+1]-g>p))for(var E=m[w+1];g<E;g++)h[d++]=h[g]}return m[u]=d,s=i(D),n(D,s)}return n(D,s)}function a(l,s,u,f,p,D,h,m,d,w,g,E){for(var F=0;F<l;F++)u[f+F]=s[F+1]-s[F];u[f+l]=0;for(var y=0;y<=l;y++)u[p+y]=-1,D[y]=-1,u[h+y]=-1,u[m+y]=-1,u[d+y]=1,u[w+y]=1,u[g+y]=0,u[E+y]=u[f+y];var C=v(0,0,u,w,l);return u[g+l]=-2,s[l]=-1,u[w+l]=0,C}function o(l,s,u,f,p,D,h,m,d,w,g){for(var E=0,F=0;F<l;F++){var y=u[f+F];if(y===0)u[p+F]=-2,E++,s[F]=-1,u[D+F]=0;else if(y>h)u[m+F]=0,u[p+F]=-1,E++,s[F]=Fe(l),u[m+l]++;else{var C=u[d+y];C!==-1&&(w[C]=F),u[g+F]=u[d+y],u[d+y]=F}}return E}function v(l,s,u,f,p){if(l<2||l+s<0){for(var D=0;D<p;D++)u[f+D]!==0&&(u[f+D]=1);l=2}return l}function c(l,s){return l!==s}});function yl(r,e,n,i,t,a,o){var v,c,l=0,s;if(r<=e||n[i+e]<=n[t+r])return-1;n[t+r]=n[i+e];var u=n[a+r];if(n[a+r]=e,u===-1)l=1,s=r;else{for(l=2,s=u;s!==n[o+s];s=n[o+s]);for(v=u;v!==s;v=c)c=n[o+v],n[o+v]=s}return{jleaf:l,q:s}}var wl="csCounts",Al=["transpose"],El=j(wl,Al,r=>{var{transpose:e}=r;return function(n,i,t,a){if(!n||!i||!t)return null;var o=n._size,v=o[0],c=o[1],l,s,u,f,p,D,h,m=4*c+(a?c+v+1:0),d=[],w=0,g=c,E=2*c,F=3*c,y=4*c,C=5*c+1;for(u=0;u<m;u++)d[u]=-1;var b=[],A=e(n),S=A._index,M=A._ptr;for(u=0;u<c;u++)for(s=t[u],b[s]=d[F+s]===-1?1:0;s!==-1&&d[F+s]===-1;s=i[s])d[F+s]=u;if(a){for(u=0;u<c;u++)d[t[u]]=u;for(l=0;l<v;l++){for(u=c,D=M[l],h=M[l+1],p=D;p<h;p++)u=Math.min(u,d[S[p]]);d[C+l]=d[y+u],d[y+u]=l}}for(l=0;l<c;l++)d[w+l]=l;for(u=0;u<c;u++){for(s=t[u],i[s]!==-1&&b[i[s]]--,f=a?d[y+u]:s;f!==-1;f=a?d[C+f]:-1)for(p=M[f];p<M[f+1];p++){l=S[p];var N=yl(l,s,d,F,g,E,w);N.jleaf>=1&&b[s]++,N.jleaf===2&&b[N.q]--}i[s]!==-1&&(d[w+s]=i[s])}for(s=0;s<c;s++)i[s]!==-1&&(b[i[s]]+=b[s]);return b}}),Fl="csSqr",Cl=["add","multiply","transpose"],bl=j(Fl,Cl,r=>{var{add:e,multiply:n,transpose:i}=r,t=Dl({add:e,multiply:n,transpose:i}),a=El({transpose:i});return function(c,l,s){var u=l._ptr,f=l._size,p=f[1],D,h={};if(h.q=t(c,l),c&&!h.q)return null;if(s){var m=c?vl(l,null,h.q,0):l;h.parent=pl(m,1);var d=hl(h.parent,p);if(h.cp=a(m,h.parent,d,1),m&&h.parent&&h.cp&&o(m,h))for(h.unz=0,D=0;D<p;D++)h.unz+=h.cp[D]}else h.unz=4*u[p]+p,h.lnz=h.unz;return h};function o(v,c){var l=v._ptr,s=v._index,u=v._size,f=u[0],p=u[1];c.pinv=[],c.leftmost=[];var D=c.parent,h=c.pinv,m=c.leftmost,d=[],w=0,g=f,E=f+p,F=f+2*p,y,C,b,A,S;for(C=0;C<p;C++)d[g+C]=-1,d[E+C]=-1,d[F+C]=0;for(y=0;y<f;y++)m[y]=-1;for(C=p-1;C>=0;C--)for(A=l[C],S=l[C+1],b=A;b<S;b++)m[s[b]]=C;for(y=f-1;y>=0;y--)h[y]=-1,C=m[y],C!==-1&&(d[F+C]++===0&&(d[E+C]=y),d[w+y]=d[g+C],d[g+C]=y);for(c.lnz=0,c.m2=f,C=0;C<p;C++)if(y=d[g+C],c.lnz++,y<0&&(y=c.m2++),h[y]=C,!(--F[C]<=0)){c.lnz+=d[F+C];var M=D[C];M!==-1&&(d[F+M]===0&&(d[E+M]=d[E+C]),d[w+d[E+C]]=d[g+M],d[g+M]=d[w+y],d[F+M]+=d[F+C])}for(y=0;y<f;y++)h[y]<0&&(h[y]=C++);return!0}});function Wt(r,e){return r[e]<0}function ua(r,e){r[e]=Fe(r[e])}function oa(r){return r<0?Fe(r):r}function Ml(r,e,n,i,t){var a=e._index,o=e._ptr,v=e._size,c=v[1],l,s,u,f=0;for(i[0]=r;f>=0;){r=i[f];var p=t?t[r]:r;Wt(o,r)||(ua(o,r),i[c+f]=p<0?0:oa(o[p]));var D=1;for(s=i[c+f],u=p<0?0:oa(o[p+1]);s<u;s++)if(l=a[s],!Wt(o,l)){i[c+f]=s,i[++f]=l,D=0;break}D&&(f--,i[--n]=r)}return n}function Sl(r,e,n,i,t){var a=r._ptr,o=r._size,v=e._index,c=e._ptr,l=o[1],s,u,f,p=l;for(u=c[n],f=c[n+1],s=u;s<f;s++){var D=v[s];Wt(a,D)||(p=Ml(D,r,p,i,t))}for(s=p;s<l;s++)ua(a,i[s]);return p}var Nl="csSpsolve",xl=["divideScalar","multiply","subtract"],Bl=j(Nl,xl,r=>{var{divideScalar:e,multiply:n,subtract:i}=r;return function(a,o,v,c,l,s,u){var f=a._values,p=a._index,D=a._ptr,h=a._size,m=h[1],d=o._values,w=o._index,g=o._ptr,E,F,y,C,b=Sl(a,o,v,c,s);for(E=b;E<m;E++)l[c[E]]=0;for(F=g[v],y=g[v+1],E=F;E<y;E++)l[w[E]]=d[E];for(var A=b;A<m;A++){var S=c[A],M=s?s[S]:S;if(!(M<0))for(F=D[M],y=D[M+1],l[S]=e(l[S],f[u?F:y-1]),E=u?F+1:F,C=u?y:y-1;E<C;E++){var N=p[E];l[N]=i(l[N],n(f[E],l[S]))}}return b}}),_l="csLu",zl=["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],Tl=j(_l,zl,r=>{var{abs:e,divideScalar:n,multiply:i,subtract:t,larger:a,largerEq:o,SparseMatrix:v}=r,c=Bl({divideScalar:n,multiply:i,subtract:t});return function(s,u,f){if(!s)return null;var p=s._size,D=p[1],h,m=100,d=100;u&&(h=u.q,m=u.lnz||m,d=u.unz||d);var w=[],g=[],E=[],F=new v({values:w,index:g,ptr:E,size:[D,D]}),y=[],C=[],b=[],A=new v({values:y,index:C,ptr:b,size:[D,D]}),S=[],M,N,O=[],T=[];for(M=0;M<D;M++)O[M]=0,S[M]=-1,E[M+1]=0;m=0,d=0;for(var I=0;I<D;I++){E[I]=m,b[I]=d;var B=h?h[I]:I,G=c(F,s,B,T,O,S,1),q=-1,z=-1;for(N=G;N<D;N++)if(M=T[N],S[M]<0){var V=e(O[M]);a(V,z)&&(z=V,q=M)}else C[d]=S[M],y[d++]=O[M];if(q===-1||z<=0)return null;S[B]<0&&o(e(O[B]),i(z,f))&&(q=B);var W=O[q];for(C[d]=I,y[d++]=W,S[q]=I,g[m]=q,w[m++]=1,N=G;N<D;N++)M=T[N],S[M]<0&&(g[m]=M,w[m++]=n(O[M],W)),O[M]=0}for(E[D]=m,b[D]=d,N=0;N<m;N++)g[N]=S[g[N]];return w.splice(m,w.length-m),g.splice(m,g.length-m),y.splice(d,y.length-d),C.splice(d,C.length-d),{L:F,U:A,pinv:S}}}),sa="slu",Ol=["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],Il=j(sa,Ol,r=>{var{typed:e,abs:n,add:i,multiply:t,transpose:a,divideScalar:o,subtract:v,larger:c,largerEq:l,SparseMatrix:s}=r,u=bl({add:i,multiply:t,transpose:a}),f=Tl({abs:n,divideScalar:o,multiply:t,subtract:v,larger:c,largerEq:l,SparseMatrix:s});return e(sa,{"SparseMatrix, number, number":function(D,h,m){if(!zr(h)||h<0||h>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(m<0||m>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var d=u(h,D,!1),w=f(D,d,m);return{L:w.L,U:w.U,p:w.pinv,q:d.q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
p: `+this.p.toString()+(this.q?`
q: `+this.q.toString():"")+`
`}}}})});function fa(r,e){var n,i=e.length,t=[];if(r)for(n=0;n<i;n++)t[r[n]]=e[n];else for(n=0;n<i;n++)t[n]=e[n];return t}var ca="lusolve",$l=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],ql=j(ca,$l,r=>{var{typed:e,matrix:n,lup:i,slu:t,usolve:a,lsolve:o,DenseMatrix:v}=r,c=Et({DenseMatrix:v});return e(ca,{"Array, Array | Matrix":function(f,p){f=n(f);var D=i(f),h=s(D.L,D.U,D.p,null,p);return h.valueOf()},"DenseMatrix, Array | Matrix":function(f,p){var D=i(f);return s(D.L,D.U,D.p,null,p)},"SparseMatrix, Array | Matrix":function(f,p){var D=i(f);return s(D.L,D.U,D.p,null,p)},"SparseMatrix, Array | Matrix, number, number":function(f,p,D,h){var m=t(f,D,h);return s(m.L,m.U,m.p,m.q,p)},"Object, Array | Matrix":function(f,p){return s(f.L,f.U,f.p,f.q,p)}});function l(u){if(xr(u))return u;if(Mr(u))return n(u);throw new TypeError("Invalid Matrix LU decomposition")}function s(u,f,p,D,h){u=l(u),f=l(f),p&&(h=c(u,h,!0),h._data=fa(p,h._data));var m=o(u,h),d=a(f,m);return D&&(d._data=fa(D,d._data)),d}}),la="det",Ll=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],Pl=j(la,Ll,r=>{var{typed:e,matrix:n,subtractScalar:i,multiply:t,divideScalar:a,isZero:o,unaryMinus:v}=r;return e(la,{any:function(s){return Fr(s)},"Array | Matrix":function(s){var u;switch(xr(s)?u=s.size():Array.isArray(s)?(s=n(s),u=s.size()):u=[],u.length){case 0:return Fr(s);case 1:if(u[0]===1)return Fr(s.valueOf()[0]);if(u[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+qr(u)+")");case 2:{var f=u[0],p=u[1];if(f===p)return c(s.clone().valueOf(),f);if(p===0)return 1;throw new RangeError("Matrix must be square (size: "+qr(u)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+qr(u)+")")}}});function c(l,s,u){if(s===1)return Fr(l[0][0]);if(s===2)return i(t(l[0][0],l[1][1]),t(l[1][0],l[0][1]));for(var f=!1,p=new Array(s).fill(0).map((C,b)=>b),D=0;D<s;D++){var h=p[D];if(o(l[h][D])){var m=void 0;for(m=D+1;m<s;m++)if(!o(l[p[m]][D])){h=p[m],p[m]=p[D],p[D]=h,f=!f;break}if(m===s)return l[h][D]}for(var d=l[h][D],w=D===0?1:l[p[D-1]][D-1],g=D+1;g<s;g++)for(var E=p[g],F=D+1;F<s;F++)l[E][F]=a(i(t(l[E][F],d),t(l[E][D],l[h][F])),w)}var y=l[p[s-1]][s-1];return f?v(y):y}}),va="inv",Rl=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],Ul=j(va,Rl,r=>{var{typed:e,matrix:n,divideScalar:i,addScalar:t,multiply:a,unaryMinus:o,det:v,identity:c,abs:l}=r;return e(va,{"Array | Matrix":function(f){var p=xr(f)?f.size():Lr(f);switch(p.length){case 1:if(p[0]===1)return xr(f)?n([i(1,f.valueOf()[0])]):[i(1,f[0])];throw new RangeError("Matrix must be square (size: "+qr(p)+")");case 2:{var D=p[0],h=p[1];if(D===h)return xr(f)?n(s(f.valueOf(),D,h),f.storage()):s(f,D,h);throw new RangeError("Matrix must be square (size: "+qr(p)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+qr(p)+")")}},any:function(f){return i(1,f)}});function s(u,f,p){var D,h,m,d,w;if(f===1){if(d=u[0][0],d===0)throw Error("Cannot calculate inverse, determinant is zero");return[[i(1,d)]]}else if(f===2){var g=v(u);if(g===0)throw Error("Cannot calculate inverse, determinant is zero");return[[i(u[1][1],g),i(o(u[0][1]),g)],[i(o(u[1][0]),g),i(u[0][0],g)]]}else{var E=u.concat();for(D=0;D<f;D++)E[D]=E[D].concat();for(var F=c(f).valueOf(),y=0;y<p;y++){var C=l(E[y][y]),b=y;for(D=y+1;D<f;)l(E[D][y])>C&&(C=l(E[D][y]),b=D),D++;if(C===0)throw Error("Cannot calculate inverse, determinant is zero");D=b,D!==y&&(w=E[y],E[y]=E[D],E[D]=w,w=F[y],F[y]=F[D],F[D]=w);var A=E[y],S=F[y];for(D=0;D<f;D++){var M=E[D],N=F[D];if(D!==y){if(M[y]!==0){for(m=i(o(M[y]),A[y]),h=y;h<p;h++)M[h]=t(M[h],a(m,A[h]));for(h=0;h<p;h++)N[h]=t(N[h],a(m,S[h]))}}else{for(m=A[y],h=y;h<p;h++)M[h]=i(M[h],m);for(h=0;h<p;h++)N[h]=i(N[h],m)}}}return F}}});function Vl(r){var{addScalar:e,subtract:n,flatten:i,multiply:t,multiplyScalar:a,divideScalar:o,sqrt:v,abs:c,bignumber:l,diag:s,size:u,reshape:f,inv:p,qr:D,usolve:h,usolveAll:m,equal:d,complex:w,larger:g,smaller:E,matrixFromColumns:F,dot:y}=r;function C(P,L,Z,nr){var k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=b(P,L,Z,nr,k);A(P,L,Z,nr,k,U);var{values:Q,C:X}=S(P,L,Z,nr,k);if(k){var J=M(P,L,X,U,Q,Z,nr);return{values:Q,eigenvectors:J}}return{values:Q}}function b(P,L,Z,nr,k){var U=nr==="BigNumber",Q=nr==="Complex",X=U?l(0):0,J=U?l(1):Q?w(1):1,ur=U?l(1):1,rr=U?l(10):2,or=a(rr,rr),fr;k&&(fr=Array(L).fill(J));for(var pr=!1;!pr;){pr=!0;for(var gr=0;gr<L;gr++){for(var yr=X,cr=X,Cr=0;Cr<L;Cr++)gr!==Cr&&(yr=e(yr,c(P[Cr][gr])),cr=e(cr,c(P[gr][Cr])));if(!d(yr,0)&&!d(cr,0)){for(var Er=ur,Sr=yr,Zr=o(cr,rr),x=a(cr,rr);E(Sr,Zr);)Sr=a(Sr,or),Er=a(Er,rr);for(;g(Sr,x);)Sr=o(Sr,or),Er=o(Er,rr);var _=E(o(e(Sr,cr),Er),a(e(yr,cr),.95));if(_){pr=!1;for(var $=o(1,Er),R=0;R<L;R++)gr!==R&&(P[gr][R]=a(P[gr][R],$),P[R][gr]=a(P[R][gr],Er));k&&(fr[gr]=a(fr[gr],$))}}}}return k?s(fr):null}function A(P,L,Z,nr,k,U){var Q=nr==="BigNumber",X=nr==="Complex",J=Q?l(0):X?w(0):0;Q&&(Z=l(Z));for(var ur=0;ur<L-2;ur++){for(var rr=0,or=J,fr=ur+1;fr<L;fr++){var pr=P[fr][ur];E(c(or),c(pr))&&(or=pr,rr=fr)}if(!E(c(or),Z)){if(rr!==ur+1){var gr=P[rr];P[rr]=P[ur+1],P[ur+1]=gr;for(var yr=0;yr<L;yr++){var cr=P[yr][rr];P[yr][rr]=P[yr][ur+1],P[yr][ur+1]=cr}if(k){var Cr=U[rr];U[rr]=U[ur+1],U[ur+1]=Cr}}for(var Er=ur+2;Er<L;Er++){var Sr=o(P[Er][ur],or);if(Sr!==0){for(var Zr=0;Zr<L;Zr++)P[Er][Zr]=n(P[Er][Zr],a(Sr,P[ur+1][Zr]));for(var x=0;x<L;x++)P[x][ur+1]=e(P[x][ur+1],a(Sr,P[x][Er]));if(k)for(var _=0;_<L;_++)U[Er][_]=n(U[Er][_],a(Sr,U[ur+1][_]))}}}}return U}function S(P,L,Z,nr,k){var U=nr==="BigNumber",Q=nr==="Complex",X=U?l(1):Q?w(1):1;U&&(Z=l(Z));for(var J=Fr(P),ur=[],rr=L,or=[],fr=k?s(Array(L).fill(X)):void 0,pr=k?s(Array(rr).fill(X)):void 0,gr=0;gr<=100;){gr+=1;for(var yr=J[rr-1][rr-1],cr=0;cr<rr;cr++)J[cr][cr]=n(J[cr][cr],yr);var{Q:Cr,R:Er}=D(J);J=t(Er,Cr);for(var Sr=0;Sr<rr;Sr++)J[Sr][Sr]=e(J[Sr][Sr],yr);if(k&&(pr=t(pr,Cr)),rr===1||E(c(J[rr-1][rr-2]),Z)){gr=0,ur.push(J[rr-1][rr-1]),k&&(or.unshift([[1]]),T(pr,L),fr=t(fr,pr),rr>1&&(pr=s(Array(rr-1).fill(X)))),rr-=1,J.pop();for(var Zr=0;Zr<rr;Zr++)J[Zr].pop()}else if(rr===2||E(c(J[rr-2][rr-3]),Z)){gr=0;var x=N(J[rr-2][rr-2],J[rr-2][rr-1],J[rr-1][rr-2],J[rr-1][rr-1]);ur.push(...x),k&&(or.unshift(O(J[rr-2][rr-2],J[rr-2][rr-1],J[rr-1][rr-2],J[rr-1][rr-1],x[0],x[1],Z,nr)),T(pr,L),fr=t(fr,pr),rr>2&&(pr=s(Array(rr-2).fill(X)))),rr-=2,J.pop(),J.pop();for(var _=0;_<rr;_++)J[_].pop(),J[_].pop()}if(rr===0)break}if(ur.sort((K,Y)=>+n(c(K),c(Y))),gr>100){var $=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+ur.join(", "));throw $.values=ur,$.vectors=[],$}var R=k?t(fr,I(or,L)):void 0;return{values:ur,C:R}}function M(P,L,Z,nr,k,U,Q){var X=p(Z),J=t(X,P,Z),ur=Q==="BigNumber",rr=Q==="Complex",or=ur?l(0):rr?w(0):0,fr=ur?l(1):rr?w(1):1,pr=[],gr=[];for(var yr of k){var cr=B(pr,yr,d);cr===-1?(pr.push(yr),gr.push(1)):gr[cr]+=1}for(var Cr=[],Er=pr.length,Sr=Array(L).fill(or),Zr=s(Array(L).fill(fr)),x=function(){var R=pr[_],K=n(J,t(R,Zr)),Y=m(K,Sr);for(Y.shift();Y.length<gr[_];){var ar=G(K,L,Y,U,Q);if(ar===null)break;Y.push(ar)}var tr=t(p(nr),Z);Y=Y.map(ir=>t(tr,ir)),Cr.push(...Y.map(ir=>({value:R,vector:i(ir)})))},_=0;_<Er;_++)x();return Cr}function N(P,L,Z,nr){var k=e(P,nr),U=n(a(P,nr),a(L,Z)),Q=a(k,.5),X=a(v(n(a(k,k),a(4,U))),.5);return[e(Q,X),n(Q,X)]}function O(P,L,Z,nr,k,U,Q,X){var J=X==="BigNumber",ur=X==="Complex",rr=J?l(0):ur?w(0):0,or=J?l(1):ur?w(1):1;if(E(c(Z),Q))return[[or,rr],[rr,or]];if(g(c(n(k,U)),Q))return[[n(k,nr),n(U,nr)],[Z,Z]];var fr=n(P,k),pr=n(nr,k);return E(c(L),Q)&&E(c(pr),Q)?[[fr,or],[Z,rr]]:[[L,rr],[pr,or]]}function T(P,L){for(var Z=0;Z<P.length;Z++)P[Z].push(...Array(L-P[Z].length).fill(0));for(var nr=P.length;nr<L;nr++)P.push(Array(L).fill(0)),P[nr][nr]=1;return P}function I(P,L){for(var Z=[],nr=0;nr<L;nr++)Z[nr]=Array(L).fill(0);var k=0;for(var U of P){for(var Q=U.length,X=0;X<Q;X++)for(var J=0;J<Q;J++)Z[k+X][k+J]=U[X][J];k+=Q}return Z}function B(P,L,Z){for(var nr=0;nr<P.length;nr++)if(Z(P[nr],L))return nr;return-1}function G(P,L,Z,nr,k){for(var U=k==="BigNumber"?l(1e3):1e3,Q,X=0;X<5;++X){Q=q(L,Z,k);try{Q=h(P,Q)}catch{continue}if(g(V(Q),U))break}if(X>=5)return null;for(X=0;;){var J=h(P,Q);if(E(V(z(Q,[J])),nr))break;if(++X>=10)return null;Q=W(J)}return Q}function q(P,L,Z){var nr=Z==="BigNumber",k=Z==="Complex",U=Array(P).fill(0).map(Q=>2*Math.random()-1);return nr&&(U=U.map(Q=>l(Q))),k&&(U=U.map(Q=>w(Q))),U=z(U,L),W(U,Z)}function z(P,L){var Z=u(P);for(var nr of L)nr=f(nr,Z),P=n(P,t(o(y(nr,P),y(nr,nr)),nr));return P}function V(P){return c(v(y(P,P)))}function W(P,L){var Z=L==="BigNumber",nr=L==="Complex",k=Z?l(1):nr?w(1):1;return t(o(k,V(P)),P)}return C}function Zl(r){var{config:e,addScalar:n,subtract:i,abs:t,atan:a,cos:o,sin:v,multiplyScalar:c,inv:l,bignumber:s,multiply:u,add:f}=r;function p(A,S){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.epsilon,N=arguments.length>3?arguments[3]:void 0,O=arguments.length>4?arguments[4]:void 0;if(N==="number")return D(A,M,O);if(N==="BigNumber")return h(A,M,O);throw TypeError("Unsupported data type: "+N)}function D(A,S,M){var N=A.length,O=Math.abs(S/N),T,I;if(M){I=new Array(N);for(var B=0;B<N;B++)I[B]=Array(N).fill(0),I[B][B]=1}for(var G=y(A);Math.abs(G[1])>=Math.abs(O);){var q=G[0][0],z=G[0][1];T=m(A[q][q],A[z][z],A[q][z]),A=F(A,T,q,z),M&&(I=w(I,T,q,z)),G=y(A)}for(var V=Array(N).fill(0),W=0;W<N;W++)V[W]=A[W][W];return b(Fr(V),I,M)}function h(A,S,M){var N=A.length,O=t(S/N),T,I;if(M){I=new Array(N);for(var B=0;B<N;B++)I[B]=Array(N).fill(0),I[B][B]=1}for(var G=C(A);t(G[1])>=t(O);){var q=G[0][0],z=G[0][1];T=d(A[q][q],A[z][z],A[q][z]),A=E(A,T,q,z),M&&(I=g(I,T,q,z)),G=C(A)}for(var V=Array(N).fill(0),W=0;W<N;W++)V[W]=A[W][W];return b(Fr(V),I,M)}function m(A,S,M){var N=S-A;return Math.abs(N)<=e.epsilon?Math.PI/4:.5*Math.atan(2*M/(S-A))}function d(A,S,M){var N=i(S,A);return t(N)<=e.epsilon?s(-1).acos().div(4):c(.5,a(u(2,M,l(N))))}function w(A,S,M,N){for(var O=A.length,T=Math.cos(S),I=Math.sin(S),B=Array(O).fill(0),G=Array(O).fill(0),q=0;q<O;q++)B[q]=T*A[q][M]-I*A[q][N],G[q]=I*A[q][M]+T*A[q][N];for(var z=0;z<O;z++)A[z][M]=B[z],A[z][N]=G[z];return A}function g(A,S,M,N){for(var O=A.length,T=o(S),I=v(S),B=Array(O).fill(s(0)),G=Array(O).fill(s(0)),q=0;q<O;q++)B[q]=i(c(T,A[q][M]),c(I,A[q][N])),G[q]=n(c(I,A[q][M]),c(T,A[q][N]));for(var z=0;z<O;z++)A[z][M]=B[z],A[z][N]=G[z];return A}function E(A,S,M,N){for(var O=A.length,T=s(o(S)),I=s(v(S)),B=c(T,T),G=c(I,I),q=Array(O).fill(s(0)),z=Array(O).fill(s(0)),V=u(s(2),T,I,A[M][N]),W=n(i(c(B,A[M][M]),V),c(G,A[N][N])),P=f(c(G,A[M][M]),V,c(B,A[N][N])),L=0;L<O;L++)q[L]=i(c(T,A[M][L]),c(I,A[N][L])),z[L]=n(c(I,A[M][L]),c(T,A[N][L]));A[M][M]=W,A[N][N]=P,A[M][N]=s(0),A[N][M]=s(0);for(var Z=0;Z<O;Z++)Z!==M&&Z!==N&&(A[M][Z]=q[Z],A[Z][M]=q[Z],A[N][Z]=z[Z],A[Z][N]=z[Z]);return A}function F(A,S,M,N){for(var O=A.length,T=Math.cos(S),I=Math.sin(S),B=T*T,G=I*I,q=Array(O).fill(0),z=Array(O).fill(0),V=B*A[M][M]-2*T*I*A[M][N]+G*A[N][N],W=G*A[M][M]+2*T*I*A[M][N]+B*A[N][N],P=0;P<O;P++)q[P]=T*A[M][P]-I*A[N][P],z[P]=I*A[M][P]+T*A[N][P];A[M][M]=V,A[N][N]=W,A[M][N]=0,A[N][M]=0;for(var L=0;L<O;L++)L!==M&&L!==N&&(A[M][L]=q[L],A[L][M]=q[L],A[N][L]=z[L],A[L][N]=z[L]);return A}function y(A){for(var S=A.length,M=0,N=[0,1],O=0;O<S;O++)for(var T=O+1;T<S;T++)Math.abs(M)<Math.abs(A[O][T])&&(M=Math.abs(A[O][T]),N=[O,T]);return[N,M]}function C(A){for(var S=A.length,M=0,N=[0,1],O=0;O<S;O++)for(var T=O+1;T<S;T++)t(M)<t(A[O][T])&&(M=t(A[O][T]),N=[O,T]);return[N,M]}function b(A,S,M){var N=A.length,O=Array(N),T;if(M){T=Array(N);for(var I=0;I<N;I++)T[I]=Array(N)}for(var B=0;B<N;B++){for(var G=0,q=A[0],z=0;z<A.length;z++)t(A[z])<t(q)&&(G=z,q=A[G]);if(O[B]=A.splice(G,1)[0],M)for(var V=0;V<N;V++)T[B][V]=S[V][G],S[V].splice(G,1)}if(!M)return{values:O};var W=T.map((P,L)=>({value:O[L],vector:P}));return{values:O,eigenvectors:W}}return p}var Gl="eigs",Yl=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],Jl=j(Gl,Yl,r=>{var{config:e,typed:n,matrix:i,addScalar:t,subtract:a,equal:o,abs:v,atan:c,cos:l,sin:s,multiplyScalar:u,divideScalar:f,inv:p,bignumber:D,multiply:h,add:m,larger:d,column:w,flatten:g,number:E,complex:F,sqrt:y,diag:C,size:b,reshape:A,qr:S,usolve:M,usolveAll:N,im:O,re:T,smaller:I,matrixFromColumns:B,dot:G}=r,q=Zl({config:e,addScalar:t,subtract:a,column:w,flatten:g,equal:o,abs:v,atan:c,cos:l,sin:s,multiplyScalar:u,inv:p,bignumber:D,complex:F,multiply:h,add:m}),z=Vl({config:e,addScalar:t,subtract:a,multiply:h,multiplyScalar:u,flatten:g,divideScalar:f,sqrt:y,abs:v,bignumber:D,diag:C,size:b,reshape:A,qr:S,inv:p,usolve:M,usolveAll:N,equal:o,complex:F,larger:d,smaller:I,matrixFromColumns:B,dot:G});return n("eigs",{Array:function(U){return V(i(U))},"Array, number|BigNumber":function(U,Q){return V(i(U),{precision:Q})},"Array, Object"(k,U){return V(i(k),U)},Matrix:function(U){return V(U,{matricize:!0})},"Matrix, number|BigNumber":function(U,Q){return V(U,{precision:Q,matricize:!0})},"Matrix, Object":function(U,Q){var X={matricize:!0};return Gr(X,Q),V(U,X)}});function V(k){var U,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X="eigenvectors"in Q?Q.eigenvectors:!0,J=(U=Q.precision)!==null&&U!==void 0?U:e.epsilon,ur=W(k,J,X);return Q.matricize&&(ur.values=i(ur.values),X&&(ur.eigenvectors=ur.eigenvectors.map(rr=>{var{value:or,vector:fr}=rr;return{value:or,vector:i(fr)}}))),X&&Object.defineProperty(ur,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),ur}function W(k,U,Q){var X=k.toArray(),J=k.size();if(J.length!==2||J[0]!==J[1])throw new RangeError("Matrix must be square (size: ".concat(qr(J),")"));var ur=J[0];if(L(X,ur,U)&&(Z(X,ur),P(X,ur,U))){var rr=nr(k,X,ur);return q(X,ur,U,rr,Q)}var or=nr(k,X,ur);return z(X,ur,U,or,Q)}function P(k,U,Q){for(var X=0;X<U;X++)for(var J=X;J<U;J++)if(d(D(v(a(k[X][J],k[J][X]))),Q))return!1;return!0}function L(k,U,Q){for(var X=0;X<U;X++)for(var J=0;J<U;J++)if(d(D(v(O(k[X][J]))),Q))return!1;return!0}function Z(k,U){for(var Q=0;Q<U;Q++)for(var X=0;X<U;X++)k[Q][X]=T(k[Q][X])}function nr(k,U,Q){var X=k.datatype();if(X==="number"||X==="BigNumber"||X==="Complex")return X;for(var J=!1,ur=!1,rr=!1,or=0;or<Q;or++)for(var fr=0;fr<Q;fr++){var pr=U[or][fr];if($r(pr)||Tt(pr))J=!0;else if(Rr(pr))ur=!0;else if(zt(pr))rr=!0;else throw TypeError("Unsupported type in Matrix: "+ce(pr))}if(ur&&rr&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),rr){for(var gr=0;gr<Q;gr++)for(var yr=0;yr<Q;yr++)U[gr][yr]=F(U[gr][yr]);return"Complex"}if(ur){for(var cr=0;cr<Q;cr++)for(var Cr=0;Cr<Q;Cr++)U[cr][Cr]=D(U[cr][Cr]);return"BigNumber"}if(J){for(var Er=0;Er<Q;Er++)for(var Sr=0;Sr<Q;Sr++)U[Er][Sr]=E(U[Er][Sr]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}}),We=Oo({config:Wr}),Nt=Lo({}),kt=Vo({}),jt=Yo({}),Qr=Xo({Matrix:jt}),sr=$u({BigNumber:We,Complex:Nt,DenseMatrix:Qr,Fraction:kt}),ke=Bs({typed:sr}),Ce=zs({typed:sr}),Ql=Kc({typed:sr}),rn=ms({BigNumber:We,typed:sr}),en=ys({Complex:Nt,typed:sr}),xt=Cf({typed:sr}),Xl=Wc({typed:sr}),oe=as({config:Wr,typed:sr}),Kl=Lf({typed:sr}),Hl=Mf({typed:sr}),ha=Ho({typed:sr}),Wl=ko({typed:sr}),pa=rs({typed:sr}),be=lf({typed:sr}),tn=hs({typed:sr}),kl=Nf({typed:sr}),jl=df({BigNumber:We,Fraction:kt,complex:en,typed:sr}),r0=jc({typed:sr}),Ue=ss({Matrix:jt,equalScalar:oe,typed:sr}),Be=Os({typed:sr}),e0=ts({typed:sr}),nn=Df({Complex:Nt,config:Wr,typed:sr}),je=Ns({typed:sr}),da=Es({Fraction:kt,typed:sr}),Dr=Cs({DenseMatrix:Qr,Matrix:jt,SparseMatrix:Ue,typed:sr}),t0=fc({bignumber:rn,fraction:da,number:tn}),n0=Yf({isInteger:ha,matrix:Dr,typed:sr}),rt=Qf({matrix:Dr,config:Wr,typed:sr}),Me=Kf({matrix:Dr,typed:sr}),te=tc({matrix:Dr,typed:sr}),Kr=uc({BigNumber:We,config:Wr,matrix:Dr,typed:sr}),_e=Bf({isInteger:ha,matrix:Dr,typed:sr}),i0=ic({conj:xt,transpose:te,typed:sr}),a0=Of({DenseMatrix:Qr,SparseMatrix:Ue,matrix:Dr,typed:sr}),me=lc({numeric:t0,typed:sr}),ma=Ac({DenseMatrix:Qr,concat:_e,equalScalar:oe,matrix:Dr,typed:sr}),ga=$f({matrix:Dr,typed:sr}),et=Rf({BigNumber:We,DenseMatrix:Qr,SparseMatrix:Ue,config:Wr,matrix:Dr,typed:sr}),Da=Tc({DenseMatrix:Qr,concat:_e,config:Wr,matrix:Dr,typed:sr}),u0=dc({DenseMatrix:Qr,divideScalar:me,equalScalar:oe,matrix:Dr,multiplyScalar:be,subtractScalar:Be,typed:sr}),o0=Ms({flatten:ga,matrix:Dr,size:rt,typed:sr}),s0=ll({addScalar:Ce,complex:en,conj:xt,divideScalar:me,equal:ma,identity:et,isZero:pa,matrix:Dr,multiplyScalar:be,sign:jl,sqrt:nn,subtractScalar:Be,typed:sr,unaryMinus:je,zeros:Kr}),tt=Cc({DenseMatrix:Qr,concat:_e,config:Wr,matrix:Dr,typed:sr}),ve=wf({DenseMatrix:Qr,concat:_e,equalScalar:oe,matrix:Dr,subtractScalar:Be,typed:sr,unaryMinus:je}),ya=gc({DenseMatrix:Qr,divideScalar:me,equalScalar:oe,matrix:Dr,multiplyScalar:be,subtractScalar:Be,typed:sr}),he=el({DenseMatrix:Qr,SparseMatrix:Ue,addScalar:Ce,concat:_e,equalScalar:oe,matrix:Dr,typed:sr}),wa=al({addScalar:Ce,conj:xt,multiplyScalar:be,size:rt,typed:sr}),f0=qc({DenseMatrix:Qr,smaller:tt}),Aa=Rc({ImmutableDenseMatrix:f0,getMatrixDataType:Kl}),Ve=Bc({DenseMatrix:Qr,concat:_e,config:Wr,matrix:Dr,typed:sr}),mr=hf({addScalar:Ce,dot:wa,equalScalar:oe,matrix:Dr,multiplyScalar:be,typed:sr}),c0=Il({SparseMatrix:Ue,abs:ke,add:he,divideScalar:me,larger:Ve,largerEq:Da,multiply:mr,subtract:ve,transpose:te,typed:sr}),br=Wf({add:he,matrix:Dr,typed:sr,zeros:Kr}),l0=yc({DenseMatrix:Qr,divideScalar:me,equalScalar:oe,matrix:Dr,multiplyScalar:be,subtractScalar:Be,typed:sr}),v0=Pl({divideScalar:me,isZero:pa,matrix:Dr,multiply:mr,subtractScalar:Be,typed:sr,unaryMinus:je}),h0=Zc({larger:Ve,smaller:tt}),Ar=ol({Index:Aa,typed:sr}),p0=Sc({DenseMatrix:Qr,concat:_e,config:Wr,matrix:Dr,typed:sr}),Ze=Zf({bignumber:rn,matrix:Dr,add:he,config:Wr,isPositive:Wl,larger:Ve,largerEq:Da,smaller:tt,smallerEq:p0,typed:sr}),d0=Jc({FibonacciHeap:h0,addScalar:Ce,equalScalar:oe}),m0=zf({Index:Aa,matrix:Dr,range:Ze,typed:sr}),Se=Ul({abs:ke,addScalar:Ce,det:v0,divideScalar:me,identity:et,matrix:Dr,multiply:mr,typed:sr,unaryMinus:je}),g0=fl({DenseMatrix:Qr,Spa:d0,SparseMatrix:Ue,abs:ke,addScalar:Ce,divideScalar:me,equalScalar:oe,larger:Ve,matrix:Dr,multiplyScalar:be,subtractScalar:Be,typed:sr,unaryMinus:je}),D0=hc({Complex:Nt,config:Wr,fraction:da,identity:et,inv:Se,matrix:Dr,multiply:mr,number:tn,typed:sr}),y0=ql({DenseMatrix:Qr,lsolve:u0,lup:g0,matrix:Dr,slu:c0,typed:sr,usolve:ya}),w0=Jl({abs:ke,add:he,addScalar:Ce,atan:Ql,bignumber:rn,column:m0,complex:en,config:Wr,cos:Xl,diag:a0,divideScalar:me,dot:wa,equal:ma,flatten:ga,im:Hl,inv:Se,larger:Ve,matrix:Dr,matrixFromColumns:o0,multiply:mr,multiplyScalar:be,number:tn,qr:s0,re:kl,reshape:n0,sin:r0,size:rt,smaller:tt,sqrt:nn,subtract:ve,typed:sr,usolve:ya,usolveAll:l0}),Ea=nl({abs:ke,add:he,conj:xt,ctranspose:i0,eigs:w0,equalScalar:oe,larger:Ve,matrix:Dr,multiply:mr,pow:D0,smaller:tt,sqrt:nn,typed:sr});class Fa{constructor(e,n,i=[0,0,0],t=[]){lr(this,"label");lr(this,"domain");lr(this,"coords");lr(this,"bcs");lr(this,"lcs");this.label=e.toString(),this.domain=n,this.coords=i,this.bcs=new Set(t),this.lcs=void 0}change(e,n,i=[]){e!=null&&(this.label=e.toString()),n!=null&&(this.coords=n),i!=null&&(this.bcs=new Set(i))}change2(e){e.label!=null&&(this.label=e.label.toString()),e.coords!=null&&(this.coords=e.coords),e.bcs!=null&&(this.bcs=new Set(e.bcs)),e.lcs!=null&&this.updateLcs(e.lcs)}getLocationArray(e){return this.domain.solver.getNodeLocationArray(this.label,e)}getUnknowns(e,n){const i=this.getLocationArray(n);return br(e.r,Ar(i))}getEigenValueUnknowns(e,n,i){const t=this.getLocationArray(n);return br(e.eigenVectors[i],Ar(t))}getTransformationMtrx(e){const n=e.length;if(this.lcs==null)return et(n);{const i=Kr([n,n]);for(let t=0;t<n;t++){const a=e[t];switch(a){case Pr.Dx:case Pr.Dy:case Pr.Dz:for(let o=0;o<n;o++){const v=e[o];(v==Pr.Dx||v==Pr.Dy||v==Pr.Dz)&&(i[t][o]=this.lcs[v][a])}break;case Pr.Rx:case Pr.Ry:case Pr.Rz:for(let o=0;o<n;o++){const v=e[o];(v==Pr.Rx||v==Pr.Ry||v==Pr.Rz)&&(i[t][o]=this.lcs[v-Pr.Rx][a-Pr.Rx])}break;default:throw new TypeError("Unknown DofID: "+a)}}return Dr(i)}}updateLcs(e){if(e==null)this.lcs=void 0;else{this.lcs=[[0,0,0],[0,0,0],[0,0,0]];const n=Ea(e.locx),i=Ea(e.locy);for(let t=0;t<3;t++)this.lcs[0][t]=e.locx[t]/n,this.lcs[1][t]=e.locy[t]/i;this.lcs[2][0]=this.lcs[0][1]*this.lcs[1][2]-this.lcs[0][2]*this.lcs[1][1],this.lcs[2][1]=this.lcs[0][2]*this.lcs[1][0]-this.lcs[0][0]*this.lcs[1][2],this.lcs[2][2]=this.lcs[0][0]*this.lcs[1][1]-this.lcs[0][1]*this.lcs[1][0]}}hasLcs(){return this.lcs!=null}getReactions(e,n=!1){if(n&&this.hasLcs()){const i=this.domain.solver.getNodeDofIDs(this.label),t=this.getLocationArray(i),a=[];for(let v=0;v<i.length;v++)this.bcs.has(i[v])?a.push(br(e.R,Ar([t[v]-this.domain.solver.neq]))):a.push(0);const o=this.getTransformationMtrx(i);return{dofs:i,values:mr(o,a).toArray()}}else if(this.bcs.size>0){const i=Array.from(this.bcs),t=this.getLocationArray(i),a=ve(t,this.domain.solver.neq),o=br(e.R,Ar(a));return e0(o)==="number"?{dofs:i,values:[o]}:{dofs:i,values:o}}else return{dofs:[],values:[]}}}class Ca{constructor(e,n,i,t,a){lr(this,"label");lr(this,"nodes");lr(this,"mat");lr(this,"cs");lr(this,"domain");this.label=e.toString(),this.nodes=i.map(o=>o.toString()),this.mat=t.toString(),this.cs=a.toString(),this.domain=n}change(e,n,i,t){e!=null&&(this.label=e.toString()),n!=null&&(this.nodes=n.map(a=>a.toString())),i!=null&&(this.mat=i.toString()),t!=null&&(this.cs=t.toString())}getMaterial(){return this.domain.getMaterial(this.mat)}getCS(){return this.domain.getCS(this.cs)}getNodeDofs(e){return[]}computeStiffness(){}computeMassMatrix(){}getLocationArray(){}computeGeo(){}computeT(){return Dr()}}class ba extends Ca{constructor(n,i,t,a,o,v=[!1,!1]){super(n,i,t,a,o);lr(this,"hinges");lr(this,"diagonalMassMatrix",!1);this.hinges=v}getNodeDofs(n){return[Pr.Dx,Pr.Dz,Pr.Ry]}getLocationArray(){let n=Array();for(const i of this.nodes)n=n.concat(this.domain.solver.getNodeLocationArray(i,[Pr.Dx,Pr.Dz,Pr.Ry]));return n}computeGeo(){const n=this.domain.getNode(this.nodes[0]).coords,i=this.domain.getNode(this.nodes[1]).coords,t=i[0]-n[0],a=i[2]-n[2];return{l:Math.sqrt(t*t+a*a),dx:t,dz:a}}hasHinges(){return this.hinges[0]||this.hinges[1]}computeT(){const n=this.computeGeo(),i=n.dx/n.l,t=n.dz/n.l;let a=Dr([[i,t,0,0,0,0],[-t,i,0,0,0,0],[0,0,1,0,0,0],[0,0,0,i,t,0],[0,0,0,-t,i,0],[0,0,0,0,0,1]]);if(this.domain.getNode(this.nodes[0]).hasLcs()||this.domain.getNode(this.nodes[1]).hasLcs()){let o=Kr(6);o=br(o,Ar([0,1,2],[0,1,2]),this.domain.getNode(this.nodes[0]).getTransformationMtrx(this.getNodeDofs(this.nodes[0]))),o=br(o,Ar([3,4,5],[3,4,5]),this.domain.getNode(this.nodes[1]).getTransformationMtrx(this.getNodeDofs(this.nodes[1]))),a=mr(a,o)}return a}computeLocalStiffnessMtrx(n=!1){const i=this.computeGeo(),t=this.getMaterial(),a=this.getCS(),o=t.e*a.a,v=t.e*a.iy,c=i.l,l=c*c,s=l*c,u=12*v/(a.k*t.g*a.a*c*c),f=1+u,p=Dr([[o/c,0,0,-o/c,0,0],[0,12*v/s/f,-6*v/l/f,0,-12*v/s/f,-6*v/l/f],[0,-6*v/l/f,(4+u)*v/c/f,0,6*v/l/f,(2-u)*v/c/f],[-o/c,0,0,o/c,0,0],[0,-12*v/s/f,6*v/l/f,0,12*v/s/f,6*v/l/f],[0,-6*v/l/f,(2-u)*v/c/f,0,6*v/l/f,(4+u)*v/c/f]]);if(this.hasHinges()){if(this.hinges[0]&&this.hinges[1])var D=[0,1,3,4],h=[2,5];else if(this.hinges[0])var D=[0,1,3,4,5],h=[2];else if(this.hinges[1])var D=[0,1,2,3,4],h=[5];const m=p.subset(Ar(D,D)),d=p.subset(Ar(D,h)),w=p.subset(Ar(h,h)),g=ve(m,mr(mr(d,Se(w)),te(d)));let E=Kr(6,6);return E=br(E,Ar(D,D),g),n?{answer:E,a:D,b:h,kaa:m,kab:d,kbb:w}:{answer:E}}return{answer:p}}computeLocalInitialStressMtrx(n){const i=this.computeGeo(),t=this.getMaterial(),a=this.getCS(),o=i.l,v=o*o,c=n/o,l=12*t.e*a.iy/(a.k*t.g*a.a*o*o),s=l*l,u=Dr([[0,0,0,0,0,0],[0,6/5+2*l+s,-o/10,0,-6/5-2*l-s,-o/10],[0,-o/10,2*v/15+v*l/6+v*s/12,0,o/10,-v/30-v*l/6-v*s/12],[0,0,0,0,0,0],[0,-6/5-2*l-s,o/10,0,6/5+2*l+s,o/10],[0,-o/10,-v/30-v*l/6-v*s/12,0,o/10,2*v/15+v*l/6+v*s/12]]);mr(u,c/(1+l)/(1+l));const f=Math.min(Math.abs(u[1][1]),Math.abs(u[2][2]))/1e3;if(u[0][0]=f,u[0][3]=-f,u[3][0]=-f,u[3][3]=f,this.hasHinges()){const p=this.computeLocalStiffnessMtrx(!0),D=rt(p.a)[0],h=Kr(6,D);br(h,Ar(p.a,Ze(0,D)),et(D)),br(h,Ar(p.b,Ze(0,D)),mr(mr(Se(p.kbb),te(p.kab)),-1));const m=mr(te(h),mr(u,h)),d=Kr(6,6);return br(p.a,Ar(p.a,p.a),m),d}return u}computeLocalMassMatrix(n=!1){const i=this.computeGeo(),t=this.getMaterial(),a=this.getCS(),o=i.l,v=o*o;if(!this.diagonalMassMatrix)return mr(t.d*a.a*o/420,Dr([[140,0,0,70,0,0],[0,156,-22*o,0,54,13*o],[0,-22*o,4*o*o,0,-13*o,-3*o*o],[70,0,0,140,0,0],[0,54,-13*o,0,156,22*o],[0,13*o,-3*o*o,0,22*o,4*o*o]]));const c=1/78;return mr(t.d*a.a*o,Dr([[1/2,0,0,0,0,0],[0,1/2,0,0,0,0],[0,0,c*v,0,0,0],[0,0,0,1/2,0,0],[0,0,0,0,1/2,0],[0,0,0,0,0,c*v]]))}computeStiffness(){this.computeGeo();const n=this.computeLocalStiffnessMtrx(),i=this.computeT();return mr(mr(te(i),n.answer),i)}computeMassMatrix(){this.computeGeo();const n=this.computeLocalMassMatrix(),i=this.computeT();return mr(mr(te(i),n),i)}computeInitialStressMatrix(n){const i=this.computeLocalInitialStressMtrx(n),t=this.computeT();return mr(mr(te(t),i),t)}computeEndDisplacement(n){const i=this.computeT(),t=this.getLocationArray();let a=mr(i,br(n.r,Ar(t)));if(this.hasHinges()){const o=this.computeLocalStiffnessMtrx(!0);let v=Kr(6);for(const c of n.getElementLoadsOnElement(this.label))v=he(v,c.getLoadVectorForClampedBeam());this.hasHinges()&&(a=br(a,Ar(o.b),mr(Se(o.kbb),mr(he(br(v,Ar(o.b)),Me(mr(te(o.kab),br(a,Ar(o.a))))),-1))))}return a}computeEndForces(n){const i=this.computeT(),t=this.getLocationArray(),a=mr(i,br(n.r,Ar(t))),o=this.computeLocalStiffnessMtrx(!0);let v=mr(o.answer,a),c=Kr(6);for(const l of n.getElementLoadsOnElement(this.label))c=he(c,l.getLoadVectorForClampedBeam());if(this.hasHinges()){const l=mr(o.kab,Se(o.kbb));if(o.b.length==1){const s=c.get(o.b);for(let u=0;u<o.a.length;u++)v.set([o.a[u]],v.get([o.a[u]])+c.get([o.a[u]])-l.get([u,0])*s)}else{const s=ve(br(c,Ar(o.a)),mr(l,Dr(br(c,Ar(o.b)))));v=br(v,Ar(o.a),ve(br(v,Ar(o.a)),s))}}else v=he(v,c);return v}computeLocalDefl(n,i){const t=this.computeEndDisplacement(n),a=[],o=[],c=this.computeGeo().l,l=n.getElementLoadsOnElement(this.label);for(let s=0;s<=i;s++){const u=s/i;let f=(1-3*u*u+2*u*u*u)*t.get([1])+c*(-u+2*u*u-u*u*u)*t.get([2])+(3*u*u-2*u*u*u)*t.get([4])+c*(u*u-u*u*u)*t.get([5]),p=(1-u)*t.get([0])+u*t.get([3]);for(const D of l){const h=D.computeBeamDeflectionContrib(u);f+=h.w,p+=h.u}a.push(p),o.push(f)}return{u:a,w:o}}computeGlobalDefl(n,i){const t=this.computeLocalDefl(n,i),a=this.computeGeo(),o=a.dx/a.l,v=a.dz/a.l,c=[],l=[];for(let s=0;s<=i;s++)c.push(t.u[s]*o-t.w[s]*v),l.push(t.w[s]*o+t.u[s]*v);return{u:c,w:l}}computeEndDisplacementEigenMode(n,i){const t=this.computeT(),a=this.getLocationArray();let o=mr(t,br(n.eigenVectors[i],Ar(a)));if(this.hasHinges()){const v=this.computeLocalStiffnessMtrx(!0),c=Kr(6);this.hasHinges()&&(o=br(o,Ar(v.b),mr(Se(v.kbb),mr(he(br(c,Ar(v.b)),Me(mr(te(v.kab),br(o,Ar(v.a))))),-1))))}return o}computeLocalEigenMode(n,i,t){const a=this.computeEndDisplacementEigenMode(n,i),o=[],v=[],l=this.computeGeo().l;for(let s=0;s<=t;s++){const u=s/t,f=(1-3*u*u+2*u*u*u)*a.get([1])+l*(-u+2*u*u-u*u*u)*a.get([2])+(3*u*u-2*u*u*u)*a.get([4])+l*(u*u-u*u*u)*a.get([5]),p=(1-u)*a.get([0])+u*a.get([3]);o.push(p),v.push(f)}return{u:o,w:v}}computeGlobalEigenMode(n,i,t){const a=this.computeLocalEigenMode(n,i,t),o=this.computeGeo(),v=o.dx/o.l,c=o.dz/o.l,l=[],s=[];for(let u=0;u<=t;u++)l.push(a.u[u]*v-a.w[u]*c),s.push(a.w[u]*v+a.u[u]*c);return{u:l,w:s}}computeNormalForce(n,i){const t=this.computeEndForces(n),a=this.computeGeo(),o=[],v=[],c=n.getElementLoadsOnElement(this.label);for(let l=0;l<=i;l++){const s=a.l*l/i;let u=-t.get([0]);for(const f of c)u+=f.computeBeamNContrib(s);o.push(s),v.push(u)}return{x:o,N:v}}computeShearForce(n,i){const t=this.computeEndForces(n),a=this.computeGeo(),o=[],v=[],c=n.getElementLoadsOnElement(this.label);for(let l=0;l<=i;l++){const s=a.l*l/i;let u=-t.get([1]);for(const f of c)u+=f.computeBeamVContrib(s);o.push(s),v.push(u)}return{x:o,V:v}}computeBendingMoment(n,i){const t=this.computeEndForces(n),a=this.computeGeo(),o=[],v=[],c=n.getElementLoadsOnElement(this.label);for(let l=0;l<=i;l++){const s=a.l*l/i;let u=-t.get([2])-t.get([1])*s;for(const f of c)u+=f.computeBeamMContrib(s);o.push(s),v.push(u)}return{x:o,M:v}}}class an{constructor(e,n){lr(this,"target");lr(this,"domain");this.target=e.toString(),this.domain=n}getLoadVector(){return[]}getLocationArray(){return[]}}class Ma extends an{constructor(n,i,t={}){super(n,i);lr(this,"values");this.values=t}change(n,i){this.target=n.toString(),this.values=i}getLoadVector(){const n=this.domain.solver.getNodeDofIDs(this.target),i=Array();for(const t of n)t in this.values?i.push(this.values[t]):i.push(0);return i}getLocationArray(){return this.domain.solver.getNodeLocationArray(this.target,this.domain.solver.getNodeDofIDs(this.target))}}class Sa extends an{getLoadVectorForClampedBeam(){return[]}computeBeamDeflectionContrib(e){return{u:0,w:0}}computeBeamNContrib(e){return 0}computeBeamVContrib(e){return 0}computeBeamMContrib(e){return 0}}class Na extends Sa{constructor(n,i,t,a){super(n,i);lr(this,"values");lr(this,"lcs");this.values=t,this.lcs=a}change(n,i,t){this.target=n.toString(),this.values=i,this.lcs=t}getGlobalIntensities(){const n=this.values[0],i=this.values[1];if(this.lcs){const t=this.domain.getElement(this.target).computeGeo(),a=t.dx/t.l,o=t.dz/t.l;return{fx:n*a-i*o,fz:n*o+i*a,my:0}}else return{fx:n,fz:i,my:0}}getLocalIntensities(){const n=this.values[0],i=this.values[1],t=this.domain.getElement(this.target).computeGeo(),a=t.l,o=t.dx,v=t.dz,c=o/a,l=v/a;return this.lcs?{fx:n,fz:i}:{fx:n*c+i*l,fz:-n*l+i*c}}getLoadVectorForClampedBeam(){const n=this.domain.getElement(this.target).computeGeo(),i=this.getLocalIntensities(),t=i.fx,a=i.fz,o=n.l;return[-.5*o*t,-.5*o*a,1/12*a*o*o,-.5*o*t,-.5*o*a,-1/12*a*o*o]}getLocationArray(){return this.domain.getElement(this.target).getLocationArray()}getLoadVector(){const n=this.domain.getElement(this.target),i=n.computeT(),t=this.getLoadVectorForClampedBeam();if(n.hasHinges()){const a=n.computeLocalStiffnessMtrx(!0);let o=[0,0,0,0,0,0];const v=mr(a.kab,Se(a.kbb));if(a.b.length==1){const c=t[a.b[0]];for(let l=0;l<a.a.length;l++)o[a.a[l]]=t[a.a[l]]-v.get([l,0])*c;return mr(mr(te(i),o),-1).toArray()}else{const c=ve(br(t,Ar(a.a)),mr(v,br(t,Ar(a.b))));return o=br(o,Ar(a.a),c),mr(mr(te(i),o),-1).toArray()}}else return mr(mr(te(i),t),-1).toArray()}computeBeamDeflectionContrib(n){const i=this.getLocalIntensities(),t=this.domain.elements.get(this.target),o=t.computeGeo().l;return{u:0,w:i.fz*o*o*o*o*(n*n*n*n/24-n*n*n/12+n*n/24)/(t.getMaterial().e*t.getCS().iy)}}computeBeamNContrib(n){return-this.getLocalIntensities().fx*n}computeBeamVContrib(n){return-this.getLocalIntensities().fz*n}computeBeamMContrib(n){return-this.getLocalIntensities().fz*n*n/2}}class xa{constructor(e,n,i){lr(this,"target");lr(this,"prescribedValues");lr(this,"domain");this.target=e.toString(),this.prescribedValues=i,this.domain=n}getNodePrescribedDisplacementVector(){const e=new Array,n=this.domain.solver.getNodeDofIDs(this.target);for(const i of n)i in this.prescribedValues?e.push(this.prescribedValues[i]):e.push(0);return e}getLocationArray(){return this.domain.solver.getNodeLocationArray(this.target,this.domain.solver.getNodeDofIDs(this.target))}}const A0={};class Ba{constructor(e,n={}){lr(this,"label");lr(this,"a");lr(this,"iy");lr(this,"iz");lr(this,"dyz");lr(this,"h");lr(this,"k");lr(this,"j");this.label=e.toString(),n={...A0,...n},this.a=n.a,this.iy=n.iy,this.iz=n.iz,this.dyz=n.dyz,this.h=n.h,this.k=n.k,this.j=n.j}change(e){e.a!=null&&(this.a=e.a),e.iy!=null&&(this.iy=e.iy),e.iz!=null&&(this.iz=e.iz),e.dyz!=null&&(this.dyz=e.dyz),e.h!=null&&(this.h=e.h),e.k!=null&&(this.k=e.k),e.j!=null&&(this.j=e.j)}}const E0={e:1,g:1,alpha:1,d:1};class _a{constructor(e,n={}){lr(this,"label");lr(this,"e");lr(this,"g");lr(this,"alpha");lr(this,"d");this.label=e.toString(),n={...E0,...n},this.e=n.e,this.g=n.g,this.alpha=n.alpha,this.d=n.d}change(e){e.e!==void 0&&(this.e=e.e),e.g!==void 0&&(this.g=e.g),e.alpha!==void 0&&(this.alpha=e.alpha),e.d!==void 0&&(this.d=e.d)}}class za{constructor(e){lr(this,"solver");lr(this,"nodes",new Map);lr(this,"elements",new Map);lr(this,"materials",new Map);lr(this,"crossSections",new Map);this.solver=e}getNode(e){const n=e.toString();if(this.nodes.has(n))return this.nodes.get(n);throw new RangeError("Node label "+e+" does not exists")}getElement(e){const n=e.toString();if(this.elements.has(n))return this.elements.get(n);throw new RangeError("Element label "+e+" does not exists")}getMaterial(e){const n=e.toString();if(this.materials.has(n))return this.materials.get(n);throw new RangeError("Material label "+e+" does not exists")}getCS(e){const n=e.toString();if(this.crossSections.has(n))return this.crossSections.get(n);throw new RangeError("CrossSection label "+e+" does not exists")}createNode(e,n=[0,0,0],i=[]){const t=new Fa(e,this,n,i);return this.nodes.set(e.toString(),t),t}createBeam2D(e,n,i,t,a=[!1,!1]){const o=new ba(e,this,n,i,t,a);return this.elements.set(e.toString(),o),o}createMaterial(e,n={}){const i=new _a(e,n);return this.materials.set(e.toString(),i),i}createCrossSection(e,n={}){const i=new Ba(e,n);return this.crossSections.set(e.toString(),i),i}}class Ta{constructor(){lr(this,"domain");lr(this,"neq");lr(this,"pneq");lr(this,"k");lr(this,"m");lr(this,"f");lr(this,"loadCases",new Array);lr(this,"codeNumberGenerated",!1);lr(this,"nodeCodeNumbers",new Map);this.domain=new za(this),this.loadCases.push(new Oa("DefaultLC",this.domain))}getNodeLocationArray(e,n){let i=[];for(const t of n)i=i.concat(this.nodeCodeNumbers.get(e)[t]);return i}getNodeDofIDs(e){const n=[];for(const i in this.nodeCodeNumbers.get(e))n.push(parseInt(i));return n}generateCodeNumbers(){const e=new Map;for(const[t,a]of this.domain.nodes)this.nodeCodeNumbers.set(t,{}),e.set(t,new Set);for(const[t,a]of this.domain.elements)for(const o of a.nodes){const v=a.getNodeDofs(o);for(const c of v)if(e.has(o))e.get(o).add(c);else throw console.log(o,o in e,e.get(o)),new RangeError("Node label "+o+" does not exists")}this.neq=0,this.pneq=0;for(const[t,a]of this.domain.nodes)for(const o of e.get(t))a.bcs.has(o)?this.pneq++:this.neq++;let n=0,i=this.neq;for(const[t,a]of this.domain.nodes)for(const o of e.get(t))a.bcs.has(o)?this.nodeCodeNumbers.get(t)[o]=i++:this.nodeCodeNumbers.get(t)[o]=n++;this.codeNumberGenerated=!0}assembleVecLC(e,n,i,t){for(let a=0;a<i.length;a++)e.set([i[a],t],e.get([i[a],t])+n[a])}assembleVec(e,n,i){for(let t=0;t<i.length;t++)e.set([i[t]],e.get([i[t]])+n[t])}}class F0 extends Ta{assemble(){this.k=Kr(this.neq+this.pneq,this.neq+this.pneq);for(const[e,n]of this.domain.elements){const i=n.computeStiffness(),t=n.getLocationArray(),a=rt(t)[0];for(let o=0;o<a;o++){const v=t[o];for(let c=0;c<a;c++){const l=t[c];this.k.set([v,l],this.k.get([v,l])+i.get([o,c]))}}}this.f=Kr(this.neq+this.pneq,this.loadCases.length);for(let e=0;e<this.loadCases.length;e++){this.loadCases[e].r=Kr(this.neq+this.pneq);const n=this.loadCases[e];for(const i of n.nodalLoadList)this.assembleVecLC(this.f,i.getLoadVector(),i.getLocationArray(),e);for(const i of n.elementLoadList)this.assembleVecLC(this.f,i.getLoadVector(),i.getLocationArray(),e);for(const i of n.prescribedBC)this.assembleVec(n.r,i.getNodePrescribedDisplacementVector(),i.getLocationArray())}}solve(){const e=new Date;this.codeNumberGenerated||this.generateCodeNumbers();const n=Ze(0,this.neq),i=Ze(this.neq,this.neq+this.pneq);if(this.assemble(),this.neq>0)for(let o=0;o<this.loadCases.length;o++){this.loadCases[o].solved=!1;const v=br(this.loadCases[o].r,Ar(i)),c=mr(br(this.k,Ar(n,i)),v);let l=br(this.k,Ar(n,n));typeof l=="number"&&(l=Dr([[l]]));let s=br(this.f,Ar(n,[o]));typeof s=="number"&&(s=Dr([s]));const u=ve(Me(s),c),f=Me(y0(l,u));this.loadCases[o].r=br(this.loadCases[o].r,Ar(Ze(0,this.neq)),f),this.loadCases[o].R=Me(mr(br(this.k,Ar(i,n)),f)),this.loadCases[o].R=ve(this.loadCases[o].R,Me(br(this.f,Ar(i,[o])))),this.loadCases[o].solved=!0}else for(let o=0;o<this.loadCases.length;o++)this.loadCases[o].R=Me(mr(this.k,this.loadCases[o].r)),this.loadCases[o].R=ve(this.loadCases[o].R,Me(br(this.f,Ar(i,[o])))),this.loadCases[o].solved=!0;const a=new Date().getTime()-e.getTime();console.log("Solution took ",Math.round(a*100)/100," [ms]")}}class Oa{constructor(e,n){lr(this,"label");lr(this,"domain");lr(this,"bcMap",{});lr(this,"nodalLoadList",new Array);lr(this,"elementLoadList",new Array);lr(this,"prescribedBC",new Array);lr(this,"r",Kr(0));lr(this,"R",Kr(0));lr(this,"eigenNumbers",[]);lr(this,"eigenVectors",[]);lr(this,"solved",!1);this.label=e,this.domain=n}getElementLoadsOnElement(e){const n=[];for(const i of this.elementLoadList)i.target==e&&n.push(i);return n}createNodalLoad(e,n={}){const i=new Ma(e,this.domain,n);return this.nodalLoadList.push(i),i}createBeamElementUniformEdgeLoad(e,n,i){const t=new Na(e,this.domain,n,i);return this.elementLoadList.push(t),t}createPrescribedDisplacement(e,n){const i=new xa(e,this.domain,n);return this.prescribedBC.push(i),i}}var Pr=(r=>(r[r.Dx=0]="Dx",r[r.Dy=1]="Dy",r[r.Dz=2]="Dz",r[r.Rx=3]="Rx",r[r.Ry=4]="Ry",r[r.Rz=5]="Rz",r))(Pr||{});Or.Beam2D=ba,Or.BeamElementLoad=Sa,Or.BeamElementUniformEdgeLoad=Na,Or.CrossSection=Ba,Or.DofID=Pr,Or.Domain=za,Or.Element=Ca,Or.LinearStaticSolver=F0,Or.Load=an,Or.LoadCase=Oa,Or.Material=_a,Or.NodalLoad=Ma,Or.Node=Fa,Or.PrescribedDisplacement=xa,Or.Solver=Ta,Object.defineProperty(Or,Symbol.toStringTag,{value:"Module"})});
